<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Thai Fortunate Innovation - Financial Strategy Simulator</title>
    <!-- Auto-sync: This file is synced from index789.html -->
    <script>
        // Force reload cache on page load
        if (performance.navigation.type === 1) {
            // Page was reloaded, clear cache
            if ('caches' in window) {
                caches.keys().then(names => names.forEach(name => caches.delete(name)));
            }
        }
    </script>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    <script src="https://unpkg.com/recharts@2.10.3/umd/Recharts.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0f172a',
                        secondary: '#334155',
                        accent: '#2563eb',
                        bg: '#f8fafc'
                    },
                    fontFamily: {
                        sans: ['Prompt', 'Noto Sans SC', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #f1f5f9; color: #1e293b; }
        .app-container { min-height: 100vh; padding-bottom: 40px; }
        .header-bar { background: #0f172a; color: white; padding: 16px 24px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        
        .card { background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; overflow: hidden; margin-bottom: 16px; transition: transform 0.2s; }
        .card:hover { border-color: #cbd5e1; }
        .card-header { background: #f8fafc; padding: 10px 16px; border-bottom: 1px solid #e2e8f0; display: flex; align-items: center; justify-content: space-between; }
        .card-title { font-weight: 600; color: #334155; font-size: 0.95rem; display: flex; align-items: center; gap: 8px; }
        .card-body { padding: 16px; }

        .input-group { margin-bottom: 8px; }
        .input-label { font-size: 0.85rem; color: #64748b; display: block; margin-bottom: 4px; }
        .input-field { width: 100%; border: 1px solid #cbd5e1; border-radius: 6px; padding: 4px 10px; font-size: 0.9rem; text-align: right; transition: all 0.2s; color: #0f172a; font-weight: 500; }
        .input-field:focus { border-color: #2563eb; outline: none; ring: 2px solid #bfdbfe; }
        .input-row { display: flex; justify-content: space-between; align-items: center; gap: 8px; padding: 4px 0; border-bottom: 1px dashed #f1f5f9; }
        
        .hr-table th { text-align: left; font-size: 0.7rem; color: #64748b; padding-bottom: 4px; }
        .hr-table td { padding: 2px 1px; vertical-align: middle; font-size: 0.7rem; }
        .hr-input { width: 100%; border: 1px solid #e2e8f0; border-radius: 4px; padding: 1px 2px; font-size: 0.7rem; text-align: right; height: 24px; }

        .flow-row { display: flex; justify-content: space-between; padding: 4px 0; font-size: 0.85rem; }
        .flow-row.total { font-weight: 700; border-top: 1px solid #e2e8f0; margin-top: 4px; padding-top: 8px; }
        .flow-sub { padding-left: 12px; color: #64748b; font-size: 0.8rem; }

        .scenario-btn { padding: 4px 12px; font-size: 0.75rem; border-radius: 20px; cursor: pointer; border: 1px solid transparent; transition: all 0.2s; }
        .scenario-btn.active { font-weight: bold; transform: scale(1.05); }

        .matrix-table th, .matrix-table td { border: 1px solid #e2e8f0; padding: 6px; text-align: center; font-size: 0.75rem; }
        .matrix-header { background: #f1f5f9; font-weight: 600; color: #475569; }

        .risk-btn {
            font-size: 0.7rem; padding: 6px 8px; border-radius: 6px; border: 1px solid #e2e8f0; background: white; 
            text-align: left; transition: all 0.2s; position: relative; overflow: hidden;
        }
        .risk-btn:hover { border-color: #94a3b8; transform: translateY(-1px); shadow: sm; }
        .risk-btn.active { border-color: #ef4444; background: #fef2f2; color: #991b1b; font-weight: 600; }
        .risk-btn::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; background: transparent; }
        .risk-btn.cat-1.active::before { background: #f97316; } /* Market - Orange */
        .risk-btn.cat-2.active::before { background: #3b82f6; } /* Supply - Blue */
        .risk-btn.cat-3.active::before { background: #a855f7; } /* Finance - Purple */
        .risk-btn.cat-4.active::before { background: #ef4444; } /* Ops - Red */

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { height: 8px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        @media print {
            body { background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .header-bar { padding: 10px; background: white !important; color: black !important; box-shadow: none; border-bottom: 2px solid #000; }
            .header-bar h1 { font-size: 1.5rem; color: #000; }
            .header-bar p { color: #666; }
            .header-controls, .scenario-btn, .print-btn-hide, .toggle-switch-container, .risk-sim-section { display: none !important; }
            .card { box-shadow: none; border: 1px solid #ccc; break-inside: avoid; margin-bottom: 10px; }
            .card-header { background: #eee !important; color: #000; border-bottom: 1px solid #aaa; }
            .input-field { border: none; background: transparent; padding: 0; text-align: right; font-weight: bold; }
            .input-group, .input-row { border-bottom: 1px solid #eee; }
            input[type=range] { display: none; }
            .app-container { padding-bottom: 0; }
            .lg\:col-span-3, .lg\:col-span-5, .lg\:col-span-4 { width: 100% !important; display: block; }
            .bg-slate-800 { background-color: #fff !important; color: #000 !important; border: 2px solid #000; }
            .bg-slate-800 .text-white { color: #000 !important; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, AreaChart, Area, CartesianGrid, PieChart, Pie, Cell, Legend, ComposedChart, Line, ReferenceLine } = Recharts;

        const fmt = (n) => new Intl.NumberFormat('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(n);
        const fmtDec = (n) => new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(n);
        const COLORS = ['#3b82f6', '#ef4444', '#f59e0b', '#10b981', '#6366f1', '#8b5cf6', '#ec4899', '#64748b'];

        // --- Helper for Base64 Unicode ---
        const toBase64 = (str) => {
            return window.btoa(unescape(encodeURIComponent(str)));
        };

        const fromBase64 = (str) => {
            return decodeURIComponent(escape(window.atob(str)));
        };

        // --- TRANSLATIONS ---
        const TRANS = {
            th: {
                title: "Thai Fortunate Innovation",
                subtitle: "Financial Strategy Simulator",
                scenario: "SCENARIO:",
                reset: "Reset",
                share: "Share",
                print: "Print",
                section1: "1. Production & Cost",
                capexTitle: "‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô & ‡πÅ‡∏´‡∏•‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô (CAPEX)",
                regCapital: "‡∏ó‡∏∏‡∏ô‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (Equity)",
                bankLoan: "üè¶ ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ (Bank Loan)",
                loanAmount: "‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ",
                interestRate: "‡∏î‡∏ö.%",
                loanTerm: "‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏õ‡∏µ)",
                interestPerYear: "‡∏î‡∏ö./‡∏õ‡∏µ (‡∏•‡∏î‡∏ï‡πâ‡∏ô)",
                factory: "‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô",
                machine: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£",
                license: "‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï",
                stockMoney: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Ñ‡∏Ç‡πâ‡∏≤‡∏ß‡∏•‡πá‡∏≠‡∏ï‡πÅ‡∏£‡∏Å",
                stockMoneyAuto: "‡πÄ‡∏á‡∏¥‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏ï‡πá‡∏≠‡∏Ñ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (Auto Calc)",
                stockPolicy: "‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏™‡∏ï‡πá‡∏≠‡∏Ñ (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)",
                workingCap: "Working Cap ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:",
                productionTitle: "‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï (Yield)",
                yieldRice: "Yield ‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£",
                paddyPrice: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å (‡∏ö‡∏≤‡∏ó/‡∏ï‡∏±‡∏ô)",
                paddyUsed: "‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å:",
                ton: "‡∏ï‡∏±‡∏ô",
                riceBudget: "‡πÉ‡∏ä‡πâ‡∏á‡∏ö‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡πâ‡∏≤‡∏ß:",
                unitCostTitle: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á",
                rice: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£",
                bag: "‡∏ñ‡∏∏‡∏á",
                sticker: "‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á",
                totalUnitCost: "‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:",
                hrTitle: "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô",
                role: "‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á",
                count: "‡∏Ñ‡∏ô",
                salary: "‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                sso: "‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏° (5%)",
                total: "‡∏£‡∏ß‡∏°",
                expenseTitle: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Expenses)",
                varParamTitle: "Variable Cost Parameters",
                elec: "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü",
                platform: "Platform",
                marketing: "Marketing",
                returnRate: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (%)",
                fixedParamTitle: "Fixed Cost (Other)",
                operationTitle: "Operation & Admin",
                maintenance: "‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á (%)",
                insurance: "‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏†‡∏±‡∏¢/‡∏õ‡∏µ",
                erp: "ERP Software",
                audit: "‡∏Ñ‡πà‡∏≤‡∏ó‡∏≥‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (Audit)",
                travel: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á/‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á",
                campaign: "‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á‡∏Ø",
                misc: "‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Misc)",
                campaignBreakdown: "üèÜ Campaign Gold Breakdown",
                reward: "‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•",
                qty: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô",
                costPerUnit: "‡∏ó‡∏∏‡∏ô/‡∏´‡∏ô‡πà‡∏ß‡∏¢",
                section2: "2. Strategy & Performance",
                execSummary: "Executive Summary",
                netProfitYear1: "Net Profit (Year 1)",
                payback: "‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏ô:",
                month: "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                year: "‡∏õ‡∏µ",
                day: "‡∏ß‡∏±‡∏ô",
                salesTargetTitle: "‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ & ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï",
                targetBags: "‡πÄ‡∏õ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢ (‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)",
                sellPrice: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó/‡∏ñ‡∏∏‡∏á)",
                creditTerm: "Credit Term (‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏ô‡∏µ‡πâ)",
                cash: "‡∏Ç‡∏≤‡∏¢‡∏™‡∏î (0 ‡∏ß‡∏±‡∏ô)",
                credit: "‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï",
                creditWarning: "*‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ô‡∏≤‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡πâ‡∏≤‡∏•‡∏á",
                totalSales: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°",
                targetPerDay: "‡πÄ‡∏õ‡πâ‡∏≤‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô",
                targetPerHour: "‡πÄ‡∏õ‡πâ‡∏≤‡∏ï‡πà‡∏≠ ‡∏ä‡∏°. (24h)",
                byProductTitle: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ (By-products)",
                item: "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",
                pricePerTon: "‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏ï‡∏±‡∏ô",
                totalIncome: "‡∏£‡∏ß‡∏° (‡∏ö.)",
                totalByProductIncome: "‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                prod_husk: "‡πÅ‡∏Å‡∏•‡∏ö",
                prod_fine: "‡∏£‡∏≥‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î",
                prod_rough: "‡∏£‡∏≥‡∏´‡∏¢‡∏≤‡∏ö",
                prod_broken: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏±‡∏Å",
                prod_waste: "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢",
                logisticsTitle: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ Drop-off (J&T Home)",
                ownDeliveryPercent: "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏á (%)",
                dropOffProfit: "‡∏Ñ‡πà‡∏≤ Drop-off/‡∏ä‡∏¥‡πâ‡∏ô",
                extraIncome: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°:",
                vatRefundTitle: "‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡∏ã‡∏∑‡πâ‡∏≠ (VAT Refund Est.)",
                vatableExp: "‡∏ê‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ (Vatable Expenses)",
                vatNote: "- ‡∏Ñ‡πà‡∏≤‡∏ñ‡∏∏‡∏á, ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á, ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü, Platform, Ads ‡πÅ‡∏•‡∏∞ Fixed (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ % ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î)",
                outputVat: "Output VAT (‡∏Ç‡∏≤‡∏¢)",
                inputVat: "Input VAT (‡∏ã‡∏∑‡πâ‡∏≠)",
                vatExplanationTitle: "üí° ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:",
                vatExplanation1: "‚Ä¢ Input VAT (‡∏†‡∏≤‡∏©‡∏µ‡∏ã‡∏∑‡πâ‡∏≠) = ‡∏†‡∏≤‡∏©‡∏µ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£",
                vatExplanation2: "‚Ä¢ Output VAT (‡∏†‡∏≤‡∏©‡∏µ‡∏Ç‡∏≤‡∏¢) = ‡∏†‡∏≤‡∏©‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",
                vatExplanation3: "‚Ä¢ Net VAT = Output VAT - Input VAT (‡∏ñ‡πâ‡∏≤‡∏ö‡∏ß‡∏Å = ‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢, ‡∏ñ‡πâ‡∏≤‡∏•‡∏ö = ‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ)",
                vatCashPaid: "VAT ‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á (Cash Paid)",
                vatCashPaidDesc: "VAT ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å VAT credit carry-forward)",
                vatCreditCarry: "‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏†‡∏≤‡∏©‡∏µ‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏∞‡∏™‡∏° (Carry)",
                vatCreditCarryDesc: "‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏†‡∏≤‡∏©‡∏µ‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏™‡∏°‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏±‡∏Å‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ",
                payMore: "‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° (Pay)",
                payMoreDesc: "Output VAT > Input VAT ‚Üí ‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏µ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ê",
                refund: "‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ (Refund)",
                refundDesc: "Input VAT > Output VAT ‚Üí ‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ",
                vatableFixedPercent: "% Fixed ‡∏ó‡∏µ‡πà‡∏°‡∏µ VAT",
                // Scaling features translations
                scalingTitle: "‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à (Scaling)",
                capexStepUpTitle: "CAPEX ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô (Step-up)",
                enableCapexStepUp: "‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ CAPEX ‡∏Ç‡∏¢‡∏≤‡∏¢",
                thresholdBags: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢ (‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)",
                factoryExpansion: "‡∏Ñ‡πà‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°",
                machineExpansion: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°",
                capacityIncrease: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏° (‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)",
                workingCapitalTitle: "‡∏ß‡∏á‡∏à‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô",
                arDays: "AR Days (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡πà‡∏≤‡∏¢)",
                apDays: "AP Days (‡πÄ‡∏£‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå)",
                inventoryDays: "Inventory Days (‡∏™‡∏ï‡πá‡∏≠‡∏Å)",
                hiringRecommendationTitle: "üíº ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô",
                currentStaff: "‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô",
                currentCapacity: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô",
                capacityPerPerson: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏ï‡πà‡∏≠‡∏Ñ‡∏ô",
                utilizationRate: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï",
                hiringThreshold: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏Ñ‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°",
                hiringBenefit: "‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏Ñ‡∏ô‡πÉ‡∏´‡∏°‡πà",
                hiringCost: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡∏Ñ‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                profitPerBag: "‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á",
                bagsNeededForHiring: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ñ‡∏∏‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á",
                hiringRecommendation: "‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥",
                notReadyToHire: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏à‡πâ‡∏≤‡∏á: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°",
                readyToHire: "‡∏Ñ‡∏ß‡∏£‡∏à‡πâ‡∏≤‡∏á: ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á {bags} ‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                overCapacity: "‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï: ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô",
                channelPandLTitle: "P&L ‡πÅ‡∏¢‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á",
                enableChannelBreakdown: "‡πÅ‡∏™‡∏î‡∏á P&L ‡πÅ‡∏¢‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á",
                tableChannel: "‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á",
                tableMixPct: "% ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢",
                tableRevenue: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ",
                tableFee: "‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°",
                tableAds: "‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤",
                tableGrossCM: "‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô",
                tableContribCM: "‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤",
                tableGMPct: "GM %",
                tableCvrCtr: "CVR \\ CTR",
                grossCmBag: "‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô/‡∏ñ‡∏∏‡∏á",
                adsBag: "‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤/‡∏ñ‡∏∏‡∏á",
                varCostBag: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏±‡∏ô‡πÅ‡∏õ‡∏£/‡∏ñ‡∏∏‡∏á",
                priceExVat: "‡∏£‡∏≤‡∏Ñ‡∏≤ (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° VAT)",
                monthlyFlowTitle: "Monthly Revenue & Cost Breakdown",
                cashInflow: "1. Cash Inflow",
                salesGross: "- Sales (Gross)",
                vatObligation: "2. VAT Obligation",
                vatNote2: "* VAT ‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°",
                opOutflow: "3. Operational Outflow",
                varExclVat: "Variable (excl. VAT)",
                fixedCost: "Fixed Cost",
                netCashEbitda: "Net Cash (EBITDA)",
                section3: "3. Financial Outlook",
                cumCashflow: "Cumulative Cashflow",
                bepTitle: "‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô (Break-even Analysis)",
                revStruct: "Revenue Structure",
                costStruct: "Cost Structure",
                sensitivity: "‚ö†Ô∏è Sensitivity (Net Profit)",
                tiktokAdsTitle: "TikTok Shop Ads Planning (GMV Max)",
                totalBudget: "Total Budget",
                budgetNote: "‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Marketing %",
                targetRoas: "Target ROAS",
                minRoasNote: "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Minimum ROAS",
                acos: "ACOS",
                acosNote: "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î/GMV",
                maxCpa: "Max CPA (Cost/Order)",
                maxCpaNote: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡∏¥‡∏ô)",
                maxCpc: "Max CPC (Bid)",
                maxCpcNote: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å (Standard Mode)",
                funnelInput: "Funnel Simulation Inputs",
                basketSize: "Basket Size (‡∏ñ‡∏∏‡∏á/‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå)",
                impressionsNeeded: "1. Impressions Needed",
                clicksTraffic: "2. Clicks (Traffic)",
                ordersTarget: "3. Orders (Target)",
                detailedCashflow: "Detailed Monthly Cashflow (Year 1)",
                monthlyGrowth: "Monthly Growth:",
                taxDepTitle: "Tax & Depreciation Details",
                depSchedule: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤ (Depreciation Schedule)",
                asset: "‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
                value: "‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤",
                lifeYear: "‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)",
                depPerYear: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°/‡∏õ‡∏µ",
                corpTax: "‡∏†‡∏≤‡∏©‡∏µ‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (Corporate Tax)",
                taxableIncome: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ó‡∏≤‡∏á‡∏†‡∏≤‡∏©‡∏µ (Taxable Income)",
                dividendTitle: "Dividend Policy & Shareholder Return",
                policyInput: "‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ (Policy Inputs)",
                payoutRatio: "Payout Ratio (%)",
                shareholders: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô (‡∏Ñ‡∏ô)",
                netProfitBreakdown: "‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Net Profit Breakdown)",
                shareholderReturn: "‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô (Per Shareholder)",
                totalPool: "‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡∏£‡∏ß‡∏° (Total Pool)",
                perYear: "‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ",
                avgPerMonth: "‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢",
                financialHealth: "Financial Health Check (Year 1)",
                debtToEquity: "D/E Ratio (‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡∏ó‡∏∏‡∏ô)",
                debtToEquityDesc: "‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡∏ó‡∏∏‡∏ô (‡∏Ñ‡∏ß‡∏£ < 2.0)",
                returnOnAsset: "‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
                returnOnEquity: "‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô",
                assetTurnoverDesc: "‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏£‡∏≠‡∏ö/‡∏õ‡∏µ)",
                projectionTitle: "‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô 5 ‡∏õ‡∏µ‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡∏£‡∏ß‡∏° Tax Shield ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡πÅ‡∏¢‡∏Å)",
                npvDesc: "‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (NPV) ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ 5 ‡∏õ‡∏µ ‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏Å",
                aiAnalysis: "ü§ñ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå & ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (AI Analysis)",
                businessAnalysis: "üìã ‡∏ö‡∏ó‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à (Business Analysis)",
                modelViability: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•",
                businessStrengths: "‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á",
                businessWeaknesses: "‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô",
                riskAssessment: "‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á",
                strategicRecommendations: "‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå",
                financialHealthScore: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô",
                unitEconomicsAnalysis: "‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Unit Economics",
                marketPositioning: "‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î",
                growthPotential: "‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï",
                viabilityScore: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ",
                excellent: "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°",
                good: "‡∏î‡∏µ",
                fair: "‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á",
                poor: "‡∏ï‡πà‡∏≥",
                critical: "‡∏ß‡∏¥‡∏Å‡∏§‡∏ï",
                financialDeepDive: "üìä ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Financial Deep Dive)",
                adsPerformance: "üì¢ ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Ads Performance)",
                financialGlossary: "üìö ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Financial Glossary)",
                marketingGlossary: "üì¢ ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Marketing & Ads Glossary)",
                
                // VAT Impact Analysis
                vatImpactTitle: "üìä ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏±‡∏ï‡∏£‡∏≤ VAT",
                vatRateLabel: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤ VAT (%)",
                vatRateDesc: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô 7%, ‡∏≠‡∏≤‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô 10%)",
                vatImpactCurrent: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô",
                vatImpactScenario: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏à‡∏≥‡∏•‡∏≠‡∏á",
                vatImpactRevenue: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (ex-VAT)",
                vatImpactCosts: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô (ex-VAT)",
                vatImpactProfit: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥",
                vatImpactCashFlow: "‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î",
                vatImpactMargin: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥",
                vatImpactChange: "‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á",
                vatImpactIncrease: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô",
                vatImpactDecrease: "‡∏•‡∏î‡∏•‡∏á",
                vatImpactNote: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° VAT ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ ex-VAT ‡∏•‡∏î‡∏•‡∏á ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô ex-VAT ‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô (‡πÄ‡∏û‡∏£‡∏≤‡∏∞ Input VAT ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô)",
                
                // --- Additional Translations ---
                beRoas: "Breakeven ROAS (‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô)",
                beRoasNote: "‡∏´‡πâ‡∏≤‡∏°‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ (‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ = 0)",
                beRoasDesc: "ROAS ‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ = 0 (Revenue = Variable Cost + Ad Spend)",
                spreadAnalysis: "‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß (Spread: ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô vs ‡∏£‡∏≤‡∏Ñ‡∏≤)",
                useStock: "‡∏î‡∏∂‡∏á‡∏™‡∏ï‡πá‡∏≠‡∏Ñ‡πÉ‡∏ä‡πâ", 
                stockBuy: "‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏ï‡πá‡∏≠‡∏Ñ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤",
                priceLabel: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢",
                perMonth: "‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                paybackNotYet: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏ô",
                autoChannel: "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å Channel Mix",
                taxSave: "‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î",
                capexDesc: "‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏Å",

                // NEW: Scenario Comparison
                scenComp: "‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 3 ‡∏â‡∏≤‡∏Å‡∏ó‡∏±‡∏®‡∏ô‡πå (Scenario Comparison)",
                scenWorst: "Worst (‡πÅ‡∏¢‡πà‡∏™‡∏∏‡∏î)",
                scenBase: "Base (‡∏õ‡∏Å‡∏ï‡∏¥)",
                scenBest: "Best (‡∏î‡∏µ‡∏™‡∏∏‡∏î)",
                scenProfit: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥",
                scenCash: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ",
                
                // --- Cash Flow Table Headers ---
                cfSales: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (Booking)",
                cfInflow: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á",
                cfExp: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ (Cash)",
                cfStock: "‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡πâ‡∏≤‡∏ß (Stock)", // NEW
                cfOpEx: "‡∏Ñ‡πà‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô (OpEx)", // NEW
                cfVat: "‡∏ô‡∏≥‡∏™‡πà‡∏á VAT",
                cfOpCash: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏£‡∏±‡∏ö-‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Net Flow)",
                cfBalance: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠",
                start0: "0 (‡πÄ‡∏£‡∏¥‡πà‡∏°)",
                
                // Note for Cashflow
                cfNote: "* ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏´‡∏≤‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å '‡∏™‡∏ï‡πá‡∏≠‡∏Ñ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤' (Stock Policy > 0) ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≤‡∏ß '‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤' ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 1 ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 3) ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏´‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏£‡∏Å‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏•‡∏á‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ (‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏°‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Ñ)",

                adsMatrixTitle: "üéØ Ads Efficiency Matrix (CTR x CVR = ROAS)",
                adsMatX: "CTR (Clip Quality)",
                adsMatY: "CVR (Sale Page)",

                // --- Cash Flow Summary (Below Table) ---
                wcStart: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (Working Cap)",
                lowestCash: "‡∏à‡∏∏‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (Lowest)",
                debtService: "‡∏ú‡πà‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô+‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢",
                taxPaidCash: "‡∏´‡∏±‡∏Å‡∏†‡∏≤‡∏©‡∏µ‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á‡∏õ‡∏µ‡∏ô‡∏µ‡πâ (Cash Paid)",
                netProfitAcc: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ó‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (Net Profit)",
                netProfitDesc: "(‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ - ‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏° - ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ - ‡∏†‡∏≤‡∏©‡∏µ)",
                cashEndYear: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ (Cash Balance Year End)",
                cashEndDesc: "(‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô + ‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏£‡∏±‡∏ö‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á - ‡∏†‡∏≤‡∏©‡∏µ - ‡∏´‡∏ô‡∏µ‡πâ)",

                // --- NEW MODULE: Runway ---
                runwayTitle: "üî• Cash Runway (‡∏™‡∏≤‡∏¢‡∏õ‡πà‡∏≤‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à)",
                burnRateTitle: "Burn Rate (‡πÄ‡∏ú‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞):",
                runwayMeaning: "‡∏´‡∏≤‡∏Å‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô 0 ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ:",
                runwaySafe: "‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢! (> 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)",
                runwayWarn: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (3-6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)",
                runwayDanger: "‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢! (< 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)",
                runwayDescText: "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡∏á‡∏ó‡∏µ‡πà+‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",

                // --- NEW MODULE: Future Stock Strategy ---
                futureStockTitle: "üåæ ‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ï‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏õ‡∏µ‡∏´‡∏ô‡πâ‡∏≤ (Year 2 Strategy)",
                cashAvailable: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ 1)",
                estRiceCostY2: "‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≤‡∏ß‡∏õ‡∏µ 2 (‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ)",
                canStock: "‡∏ï‡∏∏‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î:",
                months: "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                fullYearAble: "‚úÖ ‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏õ‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏ô‡∏≤‡∏õ‡∏µ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö 12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÑ‡∏î‡πâ‡∏°‡∏´‡∏≤‡∏®‡∏≤‡∏•)",
                partialYear: "‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡∏ï‡∏∏‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏õ‡∏µ (‡∏ï‡πâ‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°)",

                // ... (rest same) ...
                channelMixTitle: "üõí Channel Mix Revenue (‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Ç‡∏≤‡∏¢)",
                channelPct: "% ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢",
                platformFeePct: "‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏° %",
                mktPct: "% ‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î",
                offline: "Offline / Other",
                weightedFee: "‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (Weighted Fee):",
                b2c: "B2C",
                b2b: "B2B",
                tiktokShop: "TikTok Shop",
                lineShop: "Line Shop",
                ads: "‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤",
                organic: "‡∏≠‡∏≠‡πÅ‡∏Å‡∏ô‡∏¥‡∏Ñ",
                live: "‡πÑ‡∏•‡∏ü‡πå‡∏™‡∏î",
                affiliate: "Affiliate",
                member: "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å",
                normal: "‡∏õ‡∏Å‡∏ï‡∏¥",
                hotel: "‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°",
                export: "‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å",
                modernTrade: "‡πÇ‡∏°‡πÄ‡∏î‡∏¥‡∏£‡πå‡∏ô‡πÄ‡∏ó‡∏£‡∏î",
                channelMixTable: "‡∏ï‡∏≤‡∏£‡∏≤‡∏á Channel Mix",
                totalMix: "‡∏£‡∏ß‡∏° %",

                elasticityTitle: "üíé Brand Pricing Elasticity (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤)",
                elasticityCoef: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏ï‡πà‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ (Elasticity)",
                elasticityDesc: (c) => `(-${c} ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤ ‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤ 10% ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏Å ${(c * 10).toFixed(0)}%)`,
                optPrice: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô",
                estVol: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå",
                estRev: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå",
                
                clvTitle: "üë• Customer Lifetime Value (‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏•‡∏≠‡∏î‡∏ä‡∏µ‡∏û)",
                freqPerYear: "‡∏ã‡∏∑‡πâ‡∏≠‡∏ã‡πâ‡∏≥ (‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏õ‡∏µ)",
                retentionRate: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏≤ (%)",
                ltv1: "LTV (1 ‡∏õ‡∏µ)",
                ltv3: "LTV (3 ‡∏õ‡∏µ)",
                cac: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (CAC)",
                ltvCacRatio: "LTV : CAC Ratio",
                ltvDesc: "‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠ Ratio > 3 ‡πÄ‡∏ó‡πà‡∏≤",

                seasonalTitle: "‚õàÔ∏è Seasonal Supply Shock (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏§‡∏î‡∏π‡∏Å‡∏≤‡∏•)",
                enableShock: "‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå (Enable Scenario)",
                shockMonthStart: "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏° (Start)",
                shockMonthEnd: "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏à‡∏ö (End)",
                shockCostImpact: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏û‡∏¥‡πà‡∏° (%)",
                shockDesc: "‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á Cashflow ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",

                // --- 5-Year Projection Headers ---
                pyYear: "‡∏õ‡∏µ‡∏ó‡∏µ‡πà",
                pyRev: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°",
                pyExp: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ (Cash)",
                pyEbitda: "EBITDA",
                pyDep: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°",
                pyTax: "‡∏†‡∏≤‡∏©‡∏µ‡∏à‡πà‡∏≤‡∏¢",
                pyNet: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥",
                pyDiv: "‡∏õ‡∏±‡∏ô‡∏ú‡∏•",
                pyCashEnd: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏õ‡∏µ",
                ebitdaYear: "EBITDA (‡∏õ‡∏µ)",
                depreciation: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤",
                interest: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢",
                taxLiability: "‡∏†‡∏≤‡∏£‡∏∞‡∏†‡∏≤‡∏©‡∏µ",
                netProfit: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥",
                labelCampaign: "‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç:",
                labelErp: "ERP:",
                labelInsurance: "‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏†‡∏±‡∏¢:",
                labelAudit: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö/‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢:",
                labelTravel: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á/‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á:",
                labelMisc: "‡∏≠‡∏∑‡πà‡∏ô‡πÜ:",
                labelMaintenance: "‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á:",
                labelSalary: "‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (Base+SSO):",
                labelOtherFixed: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô‡πÜ:",
                labelRice: "‡∏Ç‡πâ‡∏≤‡∏ß:",
                labelPack: "‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå:",
                labelFees: "‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°:",
                labelElec: "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü:",
                growthLabel: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï:",
                inflationLabel: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠:",
                discountRateLabel: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏¥‡∏î‡∏•‡∏î:",
                monthly: "‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                annual: "‡∏£‡∏≤‡∏¢‡∏õ‡∏µ",
                deferred: "‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏à‡πà‡∏≤‡∏¢",
                tier: "‡∏ä‡πà‡∏ß‡∏á",
                rate: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤",
                taxLabel: "‡∏†‡∏≤‡∏©‡∏µ",
                totalTax: "‡∏†‡∏≤‡∏©‡∏µ‡∏£‡∏ß‡∏°",
                assetTurnover: "‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
                fixedCostDebtService: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà + ‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ",
                roa: "ROA",
                roe: "ROE",
                change: "‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á",

                // ...
                // NEW: Risk Simulator
                riskTitle: "üö® Risk Simulation Center (‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á)",
                riskLabelMarket: "1. Market Risk",
                riskLabelSupply: "2. Supply & Prod",
                riskLabelFin: "3. Financial",
                riskLabelOps: "4. Ops & Human",
                riskAnalTitle: "ü§ñ AI Risk Analysis",
                simLogic: "‚ö†Ô∏è Logic ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Assumption):",
                impact: "‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö (Impact):",
                cause: "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ (Cause):",
                strategy: "‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠ (Strategy):",
                simActive: "Simulation Active:",
                stopSim: "Stop Simulation",
                
                // NEW: Capacity Engine
                capTitle: "‚öôÔ∏è ‰∫ßËÉΩÂà©Áî®ÂºïÊìé (Capacity Utilization Engine)",
                maxCapInput: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (Max Capacity)",
                utilRate: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï (Utilization)",
                fcPerUnit: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á (Fixed Cost/Unit)",
                capStatus: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï",
                capWarning: "‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï! ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ OT ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏±‡∏á",
                capOptimal: "‚úÖ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° (Optimal) ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤",
                capWaste: "‚ùå ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ (Under) ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏™‡∏π‡∏á",
                
                // NEW: Monte Carlo
                mcTitle: "üé≤ Monte Carlo Simulation (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≥‡πÑ‡∏£)",
                mcDesc: "‡∏à‡∏≥‡∏•‡∏≠‡∏á 10,000 ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå ‡πÇ‡∏î‡∏¢‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡πà‡∏≤ CTR (¬±25%), CVR (¬±30%), CPM (‡∏ï‡∏≤‡∏°‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å), Demand (¬±15%), Basket Size (¬±10%), Return Rate (¬±2%), ‡πÅ‡∏•‡∏∞ Platform Conversion Drop (¬±10%)",
                cpmVolatilityTitle: "CPM Volatility Model (‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á CPM)",
                cpmVolatilityNormal: "Normal Market",
                cpmVolatilityNormalDesc: "‡∏ï‡∏•‡∏≤‡∏î‡∏õ‡∏Å‡∏ï‡∏¥: CPM ‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô ¬±60%",
                cpmVolatilityNormalTooltip: "‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ï‡∏•‡∏≤‡∏î‡∏õ‡∏Å‡∏ï‡∏¥:\n‚Ä¢ CPM ‡∏à‡∏∞‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á -60% ‡∏ñ‡∏∂‡∏á +60% ‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤ CPM ‡∏ê‡∏≤‡∏ô\n‚Ä¢ ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏•‡∏≤‡∏î‡∏°‡∏µ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏†‡∏≤‡∏û ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á\n‚Ä¢ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß",
                cpmVolatilityHigh: "High Competition",
                cpmVolatilityHighDesc: "‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏™‡∏π‡∏á: CPM ‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô ¬±100%",
                cpmVolatilityHighTooltip: "‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏™‡∏π‡∏á:\n‚Ä¢ CPM ‡∏à‡∏∞‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0% ‡∏ñ‡∏∂‡∏á +100% ‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤ CPM ‡∏ê‡∏≤‡∏ô\n‚Ä¢ ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏ï‡∏•‡∏≤‡∏î‡∏°‡∏≤‡∏Å\n‚Ä¢ CPM ‡∏≠‡∏≤‡∏à‡∏•‡∏î‡∏•‡∏á‡∏ï‡πà‡∏≥‡∏°‡∏≤‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å",
                cpmVolatilityExtreme: "Extreme Shock",
                cpmVolatilityExtremeDesc: "‡∏ï‡∏•‡∏≤‡∏î‡∏ä‡πá‡∏≠‡∏Å: CPM ‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô ¬±150%",
                cpmVolatilityExtremeTooltip: "‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ï‡∏•‡∏≤‡∏î‡∏ä‡πá‡∏≠‡∏Å:\n‚Ä¢ CPM ‡∏à‡∏∞‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á -150% ‡∏ñ‡∏∂‡∏á +150% ‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤ CPM ‡∏ê‡∏≤‡∏ô\n‚Ä¢ ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÑ‡∏°‡πà‡∏Ñ‡∏≤‡∏î‡∏Ñ‡∏¥‡∏î ‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à, ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢\n‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å ‡πÅ‡∏ï‡πà‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏≠‡∏≤‡∏à‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å‡πÄ‡∏ä‡πà‡∏ô‡∏Å‡∏±‡∏ô",
                mcP10: "P10 (Worst 10%)",
                mcP50: "P50 (Median)",
                mcP90: "P90 (Best 10%)",
                mcP5: "P5 (Worst 5%)",
                mcP95: "P95 (Best 5%)",
                mcProb: "Probability",
                mcProfit: "Net Profit",
                mcRiskTitle: "üìä Risk Analysis",
                mcProbLoss: "Probability of Loss",
                mcProbLossDesc: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡πÑ‡∏£ < 0",
                mcProbTarget: "Probability of Hitting Target",
                mcProbTargetDesc: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡πÑ‡∏£ ‚â• ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢",
                mcProbRoasBelow: "Probability ROAS < Breakeven",
                mcProbRoasBelowDesc: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà ROAS < Breakeven ROAS",
                mcWorstCase: "Worst Case (P5)",
                mcWorstCaseDesc: "‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏ß‡∏£‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (5% ‡πÅ‡∏£‡∏Å)",
                mcBestCase: "Best Case (P95)",
                mcSensitivityTitle: "üîç Sensitivity Analysis",
                mcTopDrivers: "Top Drivers of Profit Volatility",
                mcElasticityDesc: "‡∏ñ‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° 1% ‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏µ‡πà%",
                mcScaleTitle: "üìà Growth/Scale Analysis",
                mcScaleDesc: "Scaling scenarios when ROAS > Target",
                traffic: "Traffic",
                revenue: "Revenue",
                profit: "Profit",
                risk: "Risk",

                // AI Builders
                meaning: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢",
                situation: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå",
                status: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô",
                advice: "üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥",
                npvPos: "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ '‡∏ä‡∏ô‡∏∞' ‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á",
                npvNeg: "‡∏ô‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏´‡πà‡∏ß‡∏á! ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏¥‡∏î‡∏•‡∏î‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß '‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°' ‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÑ‡∏õ ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏û‡πâ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢/‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠",
                npvAdvPos: "‡∏•‡∏∏‡∏¢‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢! ‡πÅ‡∏ú‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ô‡∏µ‡πâ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ Re-invest ‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÇ‡∏ï‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°",
                npvAdvNeg: "‡∏´‡∏¢‡∏∏‡∏î‡∏Ñ‡∏¥‡∏î‡∏Å‡πà‡∏≠‡∏ô! ‡∏•‡∏≠‡∏á‡∏•‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (CAPEX) ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏≤‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢/‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤ NPV ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å",
                roasHigh: "‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏ñ‡∏π‡∏Å‡∏°‡∏≤‡∏Å! ‡∏¢‡∏¥‡∏á‡πÅ‡∏≠‡∏î 1 ‡∏ö‡∏≤‡∏ó ‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏ö‡∏≤‡∏ó ‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ü‡∏∑‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô",
                roasMed: "‡∏û‡∏≠‡πÑ‡∏õ‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏∂‡∏á! ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡πÑ‡∏õ‡∏û‡∏≠‡∏™‡∏°‡∏Ñ‡∏ß‡∏£ ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∏‡∏°‡∏á‡∏ö‡∏î‡∏µ‡πÜ ‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ ROAS ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ",
                roasLow: "‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢! ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡πÅ‡∏û‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏ô‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≤‡∏à‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠",
                roasAdvHigh: "Scale Up! ‡∏≠‡∏±‡∏î‡∏á‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏ï‡∏£‡∏≤‡∏ö‡πÉ‡∏î‡∏ó‡∏µ‡πà ROAS ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≠‡∏ö‡πÇ‡∏Å‡∏¢‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î",
                roasAdvMed: "Optimize! ‡∏•‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏î‡∏π‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° Basket Size ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á ROAS ‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô",
                roasAdvLow: "Stop & Fix! ‡∏´‡∏¢‡∏∏‡∏î‡∏≠‡∏±‡∏î‡∏á‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏£‡∏µ‡∏ö‡πÅ‡∏Å‡πâ‡∏Ñ‡∏•‡∏¥‡∏õ/‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô ‡∏ñ‡πâ‡∏≤‡∏ù‡∏∑‡∏ô‡∏¢‡∏¥‡∏á‡∏ï‡πà‡∏≠‡∏à‡∏∞‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô",
                cfSafe: (v) => `‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢! ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡∏à‡∏∏‡∏î‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà ${v} ‡∏ö‡∏≤‡∏ó ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏±‡∏ô`,
                cfDanger: (v) => `‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≤‡∏î‡∏°‡∏∑‡∏≠! ‡∏°‡∏µ‡∏ö‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ${v} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å`,
                cfAdvSafe: "‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡∏≠‡∏≤‡∏à‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ô‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏õ‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢",
                cfAdvDanger: "‡∏´‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πà‡∏ß‡∏ô! ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏Ç‡∏≠‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÄ‡∏ó‡∏≠‡∏°‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏ä‡πâ‡∏≤‡∏•‡∏á)",
                
                // Deep Dive Checks
                ebitdaOk: "‚úÖ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏õ‡∏à‡πà‡∏≤‡∏¢‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢/‡∏†‡∏≤‡∏©‡∏µ",
                ebitdaFail: "‚ùå ‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏µ‡∏ö‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢",
                dscrOk: "‚úÖ ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏£‡∏±‡∏Å! ‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏ö‡∏≤‡∏¢‡πÜ",
                dscrWarn: "‚ö†Ô∏è ‡∏û‡∏≠‡∏ñ‡∏π‡πÑ‡∏ñ ‡πÅ‡∏ï‡πà‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏∏‡∏î ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏ö‡∏á‡∏Å‡πå",
                dscrFail: "‚ùå ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢! ‡∏Å‡∏≥‡πÑ‡∏£‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î",
                deOk: "‚úÖ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏ô‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏Å‡∏π‡πâ‡∏à‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏ï‡∏±‡∏ß",
                deFail: "‚ùå ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á! ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏ö‡∏Å‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ",
                bepOk: (v) => `‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô‡∏°‡∏≤ ${v} ‡∏ñ‡∏∏‡∏á`,
                bepFail: "‚ùå ‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô! ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô",
                roeHigh: "‚úÖ ‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏°‡∏≤‡∏Å! ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏´‡∏∏‡πâ‡∏ô",
                roeMed: "‚ö†Ô∏è ‡∏û‡∏≠‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ù‡∏≤‡∏Å‡πÅ‡∏ö‡∏á‡∏Å‡πå‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢",
                roeLow: "‚ùå ‡∏ï‡πà‡∏≥‡πÑ‡∏õ ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢",
                nmHigh: "‚úÖ ‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏ô‡∏≤ ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á",
                nmMed: "‚ö†Ô∏è ‡∏Å‡∏≥‡πÑ‡∏£‡∏ö‡∏≤‡∏á ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ö‡∏≤‡∏ô‡∏õ‡∏•‡∏≤‡∏¢",
                nmLow: "‚ùå ‡∏Å‡∏≥‡πÑ‡∏£‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô",
                fixHigh: "‚ö†Ô∏è Fixed Cost ‡∏™‡∏π‡∏á! ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡πà‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (Economy of Scale)",
                varHigh: "‚úÖ ‡πÄ‡∏ô‡πâ‡∏ô Variable Cost ‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢",
                wcOk: "‚úÖ ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠",
                wcFail: "‚ùå ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠! ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏∞‡∏î‡∏∏‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏£‡∏Å",
                
                // Ads Checks
                acosOk: "‚úÖ ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£",
                acosFail: "‚ùå ‡∏™‡∏π‡∏á‡πÑ‡∏õ! ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡πÅ‡∏ï‡πà‡πÄ‡∏à‡πä‡∏á‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î",
                cpaCheck: (v) => `‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤ ‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô > ${v} ‡∏ö‡∏≤‡∏ó ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô`,
                bidCheck: "‡∏´‡πâ‡∏≤‡∏° Bid ‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ ‡∏ñ‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° CVR ‡∏´‡∏£‡∏∑‡∏≠ Basket Size ‡πÅ‡∏ó‡∏ô",
                ctrLow: "‚ö†Ô∏è CTR ‡∏ï‡πà‡∏≥‡πÑ‡∏õ ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡πÉ‡∏´‡πâ‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à",
                cvrLow: "‚ö†Ô∏è CVR ‡∏ï‡πà‡∏≥‡πÑ‡∏õ ‡∏õ‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ã‡∏•‡πÄ‡∏û‡∏à/‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô",
                aovTip: "‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° AOV ‡πÑ‡∏î‡πâ ‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏á ‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
                scaleTip: (v) => `‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏Ñ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ${v} ‡∏Ñ‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤`,

                // Glossary
                gEbitda: "‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏Å‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ ‡∏†‡∏≤‡∏©‡∏µ ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏° ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏ö‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£",
                gNpv: "‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏•‡∏î‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏´‡∏±‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô \n> 0 ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô",
                gDscr: "(EBITDA / ‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏õ‡∏µ) ‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÑ‡∏´‡∏° \n‡∏Ñ‡∏ß‡∏£ > 1.25 (‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ä‡∏≠‡∏ö)",
                gDe: "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á \n‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡∏¥‡∏ô 2.0 ÂÄç",
                gRoe: "(‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ / ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô) ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏•‡∏á‡πÑ‡∏õ 100 ‡∏ö‡∏≤‡∏ó ‡∏á‡∏≠‡∏Å‡πÄ‡∏á‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (‡∏Ñ‡∏ß‡∏£ > 10-15%)",
                gBep: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏û‡∏≠‡∏î‡∏µ (‡∏Å‡∏≥‡πÑ‡∏£ = 0) ‡∏ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≥‡πÑ‡∏£",
                gRoa: "(‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ / ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏ß‡∏°) ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≥‡πÑ‡∏£ \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ",
                gAssetTurn: "(‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ / ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏ß‡∏°) ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå 1 ‡∏ö‡∏≤‡∏ó ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó ‡∏ö‡∏≠‡∏Å‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
                gGross: "((‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≤‡∏¢) / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢) % ‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£",
                gNet: "(‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢) % ‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏©‡∏µ",
                gWc: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏∏‡∏î (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)",
                gTaxShield: "‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏≤‡∏á‡∏†‡∏≤‡∏©‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ô‡∏≥ \"‡∏ú‡∏•‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏™‡∏∞‡∏™‡∏°\" ‡πÉ‡∏ô‡∏≠‡∏î‡∏µ‡∏ï ‡∏°‡∏≤‡∏´‡∏±‡∏Å‡∏•‡∏ö‡∏Å‡∏≥‡πÑ‡∏£‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏µ‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á (‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ 5 ‡∏õ‡∏µ)",
                gCapex: "‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£ (‡πÑ‡∏°‡πà‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÅ‡∏ï‡πà‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°)",
                gOpex: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü ‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î (‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÜ)",
                gCf: "‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ç‡∏≤‡∏î‡∏°‡∏∑‡∏≠ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏à‡πä‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
                gFix: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏® ‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤",
                gVar: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏î‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å ‡∏Ñ‡πà‡∏≤‡∏ñ‡∏∏‡∏á ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≠‡∏°‡∏°‡∏¥‡∏ä‡∏ä‡∏±‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á",
                
                gRoas: "(‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ / ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤) ‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î 1 ‡∏ö‡∏≤‡∏ó ‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (TikTok Shop ‡∏Ñ‡∏ß‡∏£ > 5-7x)",
                gAcos: "(‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢) ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏µ‡πà % ‡∏Ç‡∏≠‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ \n‡∏¢‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≥‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (‡∏Ñ‡∏ß‡∏£‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ % ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô)",
                gCpa: "(‡∏á‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î / ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå) ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á \n‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô",
                gCpc: "‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á \n‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤",
                gCtr: "(‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å / ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•) % ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏Ñ‡∏•‡∏¥‡∏Å \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à (TikTok ‡∏Ñ‡∏ß‡∏£ > 1.5-2%)",
                gCvr: "(‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå / ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å) % ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏£‡∏¥‡∏á \n‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å! ‡∏ñ‡πâ‡∏≤‡∏ï‡πà‡∏≥‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏£‡∏≤‡∏Ñ‡∏≤",
                gCpm: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏£‡∏ö 1,000 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á \n‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏û‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏π‡∏Å‡∏•‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°",
                gGmv: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á)",
                gImp: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏ô‡∏±‡∏ö‡∏ã‡πâ‡∏≥‡∏Ñ‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ)",
                gAov: "‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠ 1 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏¢‡∏≠‡∏∞‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏±‡∏Å‡∏à‡∏∞‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ö‡∏¥‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô)",
                gAff: "‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô (Creators) ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏≤‡πÅ‡∏ö‡πà‡∏á % ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ \n‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ñ‡∏∑‡∏≠: ‡∏Ç‡∏≤‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢ (Cost per Action)",
                gReach: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô \"‡∏Ñ‡∏ô\" ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å Impression ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô \"‡∏Ñ‡∏£‡∏±‡πâ‡∏á\") ‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÑ‡∏õ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô",
                gLtv: "‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏à‡∏∞‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å AOV √ó ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠ √ó % ‡∏Å‡∏≥‡πÑ‡∏£ √ó ‡∏≠‡∏≤‡∏¢‡∏∏‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤) \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡πà‡∏≤",
                gCac: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà 1 ‡∏Ñ‡∏ô (‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î) \n‡∏Ñ‡∏ß‡∏£‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ LTV ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡πÄ‡∏ó‡πà‡∏≤",
                
                // New Financial Glossary terms
                gContributionMargin: "‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Gross Margin - Marketing Cost) \n‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà",
                gChannelMix: "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á (‡πÄ‡∏ä‡πà‡∏ô TikTok Shop 80%, Line Shop 10%, B2B 10%) \n‡πÉ‡∏ä‡πâ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°",
                gWorkingCapitalCycle: "‡∏ß‡∏á‡∏à‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ñ‡∏π‡∏Å \"‡∏ú‡∏π‡∏Å\" ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏±‡πâ‡∏ô‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ = ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏£‡πá‡∏ß",
                gArDays: "Accounts Receivable Days: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏µ‡πà‡∏£‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏±‡πâ‡∏ô‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (0 ‡∏ß‡∏±‡∏ô = ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ)",
                gApDays: "Accounts Payable Days: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ \n‡∏¢‡∏¥‡πà‡∏á‡∏¢‡∏≤‡∏ß‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ = ‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏î‡πâ‡∏ô‡∏≤‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô",
                gInventoryDays: "Inventory Days: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏Å‡∏î‡∏±‡∏á \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏±‡πâ‡∏ô‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ = ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ú‡∏π‡∏Å‡πÑ‡∏ß‡πâ",
                gCapexStepUp: "‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏´‡∏ô‡∏∂‡πà‡∏á (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°) \n‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß",
                gUnitEconomics: "‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≥‡πÑ‡∏£-‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠ 1 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏£‡∏≤‡∏Ñ‡∏≤, ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô, ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô, ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤) \n‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà",
                gVatInput: "‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤: VAT ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô ‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö) \n‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡∏°‡∏≤‡∏´‡∏±‡∏Å‡∏Å‡∏±‡∏ö VAT ‡∏Ç‡∏≤‡∏≠‡∏≠‡∏Å‡πÑ‡∏î‡πâ",
                gVatOutput: "‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≤‡∏≠‡∏≠‡∏Å: VAT ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á \n‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏≥‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏™‡∏£‡∏£‡∏û‡∏≤‡∏Å‡∏£‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                gVatNet: "VAT ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ = Output VAT - Input VAT \n‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å = ‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏™‡∏£‡∏£‡∏û‡∏≤‡∏Å‡∏£, ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏ö = ‡πÑ‡∏î‡πâ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏Ñ‡∏∑‡∏ô",
                gMultiChannelPl: "P&L ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Ç‡∏≤‡∏¢: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô \n‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÑ‡∏´‡∏ô‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î"
            },
            cn: {
                title: "Ê≥∞ÂõΩÂπ∏ËøêÂàõÊñ∞ (Thai Fortunate Innovation)",
                subtitle: "Ë¥¢Âä°ÊàòÁï•Ê®°ÊãüÂô®",
                scenario: "Âú∫ÊôØ (SCENARIO):",

                // Function-based translations (must exist to avoid runtime crash)
                cfSafe: (v) => `‚úÖ ÂÆâÂÖ®ÔºÅÁé∞Èáë‰ªéÊú™‰∏∫Ë¥üÔºåÊúÄ‰ΩéÁÇπÁ∫¶‰∏∫ ${v} Ê≥∞Èì¢ÔºåËµÑÈáëÂë®ËΩ¨ËâØÂ•Ω„ÄÇ`,
                cfDanger: (v) => `‚ùå Áé∞ÈáëÂêÉÁ¥ßÔºÅÁé∞ÈáëÊõæÂá∫Áé∞Áº∫Âè£ÔºåÊúÄÂ§ßÁº∫Âè£Á∫¶‰∏∫ ${v} Ê≥∞Èì¢ÔºåË°®Á§∫ÂõûÊ¨æÈÄüÂ∫¶Ë∑ü‰∏ç‰∏äÊîØÂá∫„ÄÇ`,
                bepOk: (v) => `‚úÖ ÂÆâÂÖ®ÔºöÈîÄÈáèË∂ÖËøáÁõà‰∫èÂπ≥Ë°°ÁÇπ ${v} Ë¢ã„ÄÇ`,
                cpaCheck: (v) => `ËØ∑Á°Æ‰øù‚ÄúÂçï‰ª∂Âà©Ê∂¶‚Äù > ${v} Ê≥∞Èì¢ÔºåÂê¶Âàô‰ºö‰∫èÊçü„ÄÇ`,
                scaleTip: (v) => `Ë¶ÅËææÂà∞ÁõÆÊ†áÈîÄÈáèÔºåÈ¢ÑËÆ°ÊØèÊúàÈúÄË¶ÅÂºïÂÖ•Á∫¶ ${v} Ê¨°ÁÇπÂáª/ËÆøÂÆ¢„ÄÇ`,

                reset: "ÈáçÁΩÆ",
                share: "ÂàÜ‰∫´",
                print: "ÊâìÂç∞",
                section1: "1. Áîü‰∫ß‰∏éÊàêÊú¨ (Production & Cost)",
                capexTitle: "ÊäïËµÑ‰∏éËµÑÈáëÊù•Ê∫ê (CAPEX)",
                regCapital: "Ê≥®ÂÜåËµÑÊú¨ (Equity)",
                bankLoan: "üè¶ Èì∂Ë°åË¥∑Ê¨æ (Bank Loan)",
                loanAmount: "Ë¥∑Ê¨æÈáëÈ¢ù",
                interestRate: "Âà©Áéá%",
                loanTerm: "ÊúüÈôê (Âπ¥)",
                interestPerYear: "Âà©ÊÅØ/Âπ¥ (ÈÄíÂáè)",
                factory: "Â∑•ÂéÇ",
                machine: "Êú∫Âô®",
                license: "ËÆ∏ÂèØËØÅ",
                stockMoney: "È¶ñÊâπÂ§ßÁ±≥Â∫ìÂ≠òËµÑÈáë",
                stockMoneyAuto: "È¢Ñ‰ªòÂ∫ìÂ≠òËµÑÈáë (Ëá™Âä®ËÆ°ÁÆó)",
                stockPolicy: "Â∫ìÂ≠òÁ≠ñÁï• (Êúà)",
                workingCap: "Ââ©‰ΩôËê•ËøêËµÑÈáë:",
                productionTitle: "Áîü‰∫ß (Yield)",
                yieldRice: "Â§ßÁ±≥Âá∫Á±≥Áéá (Yield)",
                paddyPrice: "Á®ªË∞∑‰ª∑Ê†º (Ê≥∞Èì¢/Âê®)",
                paddyUsed: "ÈúÄÁî®Á®ªË∞∑:",
                ton: "Âê®",
                riceBudget: "Â§ßÁ±≥ÈááË¥≠È¢ÑÁÆó:",
                unitCostTitle: "ÊØèË¢ãÊàêÊú¨",
                rice: "Â§ßÁ±≥",
                bag: "ÂåÖË£ÖË¢ã",
                sticker: "Âø´ÈÄíÁõí",
                totalUnitCost: "ÊØèÊúàÊÄªÁîü‰∫ßÊàêÊú¨:",
                hrTitle: "‰∫∫ÂëòÁªìÊûÑ",
                role: "ËÅå‰Ωç",
                count: "‰∫∫Êï∞",
                salary: "Ëñ™Ê∞¥",
                sso: "Á§æ‰øù (5%)",
                total: "ÊÄªËÆ°",
                expenseTitle: "ÂÖ∂‰ªñË¥πÁî® (Expenses)",
                varParamTitle: "ÂèòÂä®ÊàêÊú¨ÂèÇÊï∞",
                elec: "ÁîµË¥π",
                platform: "Âπ≥Âè∞Ë¥π",
                marketing: "Ëê•ÈîÄË¥π",
                returnRate: "ÈÄÄË¥ßÁéá (Return %)",
                fixedParamTitle: "Âõ∫ÂÆöÊàêÊú¨ (ÂÖ∂‰ªñ)",
                operationTitle: "ËøêËê•‰∏éÁÆ°ÁêÜ (Operation)", // New Header
                maintenance: "Áª¥‰øÆ‰øùÂÖª (%)",
                insurance: "‰øùÈô©Ë¥π (Âπ¥)",
                erp: "ERP ËΩØ‰ª∂",
                audit: "‰ºöËÆ°/Ê≥ïÂæã (Audit)",
                travel: "Â∑ÆÊóÖ/ÊãõÂæÖ (Travel)",
                campaign: "ÈªÑÈáëÊ¥ªÂä®",
                misc: "ÊùÇÈ°π (Misc)",
                campaignBreakdown: "üèÜ ÈªÑÈáëÊ¥ªÂä®ÁªÜÂàÜ",
                reward: "Â•ñÂìÅ",
                qty: "Êï∞Èáè",
                costPerUnit: "Âçï‰ª∑",
                section2: "2. ÊàòÁï•‰∏éÁª©Êïà (Strategy & Performance)",
                execSummary: "ÊâßË°åÊëòË¶Å (Executive Summary)",
                netProfitYear1: "ÂáÄÂà©Ê∂¶ (Á¨¨1Âπ¥)",
                payback: "ÂõûÊú¨Êúü:",
                month: "Êúà",
                year: "Âπ¥",
                day: "Â§©",
                salesTargetTitle: "ÈîÄÂîÆÁõÆÊ†á & ‰ø°Áî®",
                targetBags: "ÈîÄÂîÆÁõÆÊ†á (Ë¢ã/Êúà)",
                sellPrice: "ÂîÆ‰ª∑ (Ê≥∞Èì¢/Ë¢ã)",
                creditTerm: "‰ø°Áî®ÊúüÈôê (Credit Term)",
                cash: "Áé∞ÈîÄ (0 Â§©)",
                credit: "‰ø°Áî®",
                creditWarning: "*ÈÄâÊã©Êõ¥ÈïøÁöÑ‰ø°Áî®ÊúüÔºåÁé∞ÈáëÂõûÊµÅ‰ºöÂèòÊÖ¢",
                totalSales: "ÊÄªÈîÄÂîÆÈ¢ù",
                targetPerDay: "ÊØèÊó•ÁõÆÊ†á",
                targetPerHour: "ÊØèÂ∞èÊó∂ÁõÆÊ†á (24h)",
                byProductTitle: "ÂâØ‰∫ßÂìÅÊî∂ÂÖ• (By-products)",
                item: "È°πÁõÆ",
                pricePerTon: "‰ª∑Ê†º/Âê®",
                totalIncome: "ÊÄªËÆ° (Èì¢)",
                totalByProductIncome: "ÊØèÊúàÂâØ‰∫ßÂìÅÊÄªÊî∂ÂÖ•",
                prod_husk: "Á®ªÂ£≥",
                prod_fine: "ÁªÜÁ±≥Á≥†",
                prod_rough: "Á≤óÁ±≥Á≥†",
                prod_broken: "Á¢éÁ±≥",
                prod_waste: "Â∫üÊñô",
                logisticsTitle: "Drop-off Êî∂ÂÖ• (J&T Home)",
                ownDeliveryPercent: "Ëá™ÈÄÅÊØî‰æã (%)",
                dropOffProfit: "Drop-off Âà©Ê∂¶/‰ª∂",
                extraIncome: "È¢ùÂ§ñÊî∂ÂÖ•:",
                vatRefundTitle: "È¢Ñ‰º∞ËøõÈ°πÁ®éÈÄÄÁ®é (VAT Refund Est.)",
                vatableExp: "ÂèØÊäµÊâ£Ë¥πÁî®Âü∫Êï∞ (Vatable Expenses)",
                vatNote: "- ÂåÖÊã¨ÂåÖË£Ö, ÁîµË¥π, Âπ≥Âè∞Ë¥π, ÂπøÂëäË¥πÔºå‰ª•ÂèäÂõ∫ÂÆöÊàêÊú¨ÔºàÊåâËÆæÂÆöÊØî‰æãÔºâ",
                outputVat: "ÈîÄÈ°πÁ®é (Output VAT)",
                inputVat: "ËøõÈ°πÁ®é (Input VAT)",
                vatExplanationTitle: "üí° ËØ¥Êòé:",
                vatExplanation1: "‚Ä¢ Input VAT (ËøõÈ°πÁ®é) = Ë¥≠‰π∞ÂïÜÂìÅ/ÊúçÂä°Êó∂ÊîØ‰ªòÁöÑÁ®éÊ¨æ",
                vatExplanation2: "‚Ä¢ Output VAT (ÈîÄÈ°πÁ®é) = ÂêëÂÆ¢Êà∑Êî∂ÂèñÁöÑÁ®éÊ¨æ",
                vatExplanation3: "‚Ä¢ Net VAT = Output VAT - Input VAT (Ê≠£Êï∞ = ÈúÄË°•Áº¥, Ë¥üÊï∞ = ÂèØÈÄÄÁ®é)",
                vatCashPaid: "ÂÆûÈôÖÁº¥Á∫≥ VAT (Áé∞Èáë)",
                vatCashPaidDesc: "ÊØèÊúàÂÆûÈôÖÁº¥Á∫≥ÁöÑ VAT (Êâ£Èô§ËøõÈ°πÁ®éÁªìËΩ¨Âêé)",
                vatCreditCarry: "ËøõÈ°πÁ®éÁªìËΩ¨ (Carry)",
                vatCreditCarryDesc: "Á¥ØÁßØÁöÑËøõÈ°πÁ®é‰ø°Áî®ÔºåÁî®‰∫éÊäµÊâ£‰∏ã‰∏™ÊúàÁöÑÁ®éÊ¨æ",
                payMore: "ÈúÄË°•Áº¥ (Pay)",
                payMoreDesc: "Output VAT > Input VAT ‚Üí ÈúÄÂêëÊîøÂ∫úË°•Áº¥Á®éÊ¨æ",
                refund: "ÂèØÈÄÄÁ®é (Refund)",
                refundDesc: "Input VAT > Output VAT ‚Üí ÂèØÁî≥ËØ∑ÈÄÄËøòËøõÈ°πÁ®é",
                vatableFixedPercent: "Âõ∫ÂÆöÊàêÊú¨Âê´Á®éÊØî‰æã (%)",
                // Scaling features translations
                scalingTitle: "‰∏öÂä°Êâ©Â±ï (Scaling)",
                capexStepUpTitle: "ËµÑÊú¨ÊîØÂá∫Êâ©Â±ï (CAPEX Step-up)",
                enableCapexStepUp: "ÂêØÁî® CAPEX Êâ©Â±ï",
                thresholdBags: "Ëß¶ÂèëÊâ©Â±ïÁöÑÈîÄÈáè (Ë¢ã/Êúà)",
                factoryExpansion: "Â∑•ÂéÇÊâ©Âª∫ÊàêÊú¨",
                machineExpansion: "Êú∫Âô®Â¢ûÂä†ÊàêÊú¨",
                capacityIncrease: "‰∫ßËÉΩÂ¢ûÂä† (Ë¢ã/Êúà)",
                workingCapitalTitle: "Ëê•ËøêËµÑÈáëÂë®Êúü",
                hiringRecommendationTitle: "üíº ÊãõËÅòÂª∫ËÆÆ",
                currentStaff: "ÂΩìÂâçÂëòÂ∑•",
                currentCapacity: "ÂΩìÂâç‰∫ßËÉΩ",
                capacityPerPerson: "‰∫∫Âùá‰∫ßËÉΩ",
                utilizationRate: "‰∫ßËÉΩÂà©Áî®Áéá",
                hiringThreshold: "Â∫îÊãõËÅòÁöÑÈîÄÂîÆÈ¢ù",
                hiringBenefit: "ÊãõËÅòÊñ∞ÂëòÂ∑•ÁöÑÂà©Ê∂¶Â¢ûÂä†",
                hiringCost: "ÊØèÂêçÂëòÂ∑•ÊØèÊúàÊàêÊú¨",
                profitPerBag: "ÊØèË¢ãÂà©Ê∂¶",
                bagsNeededForHiring: "ÈúÄË¶ÅÈîÄÂîÆÁöÑË¢ãÊï∞‰ª•ÊîØ‰ªòÂ∑•ËµÑ",
                hiringRecommendation: "Âª∫ËÆÆ",
                notReadyToHire: "Ëøò‰∏çÂ∫îËØ•ÊãõËÅòÔºö‰∫ßËÉΩÂ∞öÊú™Êª°",
                readyToHire: "Â∫îËØ•ÊãõËÅòÔºöÈîÄÂîÆÈ¢ùËææÂà∞ {bags} Ë¢ã/Êúà",
                overCapacity: "Ë∂ÖËøá‰∫ßËÉΩÔºöÈúÄË¶ÅÂÖàÊâ©Âª∫Â∑•ÂéÇ",
                arDays: "Â∫îÊî∂Ë¥¶Ê¨æÂ§©Êï∞ (ÂÆ¢Êà∑‰ªòÊ¨æ)",
                apDays: "Â∫î‰ªòË¥¶Ê¨æÂ§©Êï∞ (Êàë‰ª¨‰ªòÊ¨æÁªô‰æõÂ∫îÂïÜ)",
                inventoryDays: "Â∫ìÂ≠òÂ§©Êï∞ (Â∫ìÂ≠ò)",
                channelPandLTitle: "ÂàÜÊ∏†ÈÅìÊçüÁõä",
                enableChannelBreakdown: "ÊòæÁ§∫ÂàÜÊ∏†ÈÅì P&L",
                monthlyFlowTitle: "ÊØèÊúàÊî∂ÂÖ•‰∏éÊàêÊú¨ÊòéÁªÜ (Monthly Revenue & Cost Breakdown)",
                cashInflow: "1. Áé∞ÈáëÊµÅÂÖ•",
                salesGross: "- ÈîÄÂîÆÈ¢ù (ÊØõ)",
                refundDeduction: "- ÈÄÄË¥ß (Refunds)",
                vatObligation: "2. Â¢ûÂÄºÁ®é‰πâÂä°",
                vatNote2: "* Âü∫‰∫éÊÄªÈîÄÂîÆÈ¢ùÁöÑÂ¢ûÂÄºÁ®é",
                opOutflow: "3. ËøêËê•ÊµÅÂá∫",
                varExclVat: "ÂèòÂä®ÊàêÊú¨ (‰∏çÂê´Á®é)",
                fixedCost: "Âõ∫ÂÆöÊàêÊú¨",
                netCashEbitda: "ÂáÄÁé∞ÈáëÊµÅ (EBITDA)",
                section3: "3. Ë¥¢Âä°Â±ïÊúõ (Financial Outlook)",
                cumCashflow: "Á¥ØËÆ°Áé∞ÈáëÊµÅ (Cumulative Cashflow)",
                bepTitle: "Áõà‰∫èÂπ≥Ë°°ÁÇπ (Break-even Analysis)",
                revStruct: "Êî∂ÂÖ•ÁªìÊûÑ",
                costStruct: "ÊàêÊú¨ÁªìÊûÑ",
                sensitivity: "‚ö†Ô∏è ÊïèÊÑüÊÄßÂàÜÊûê (ÂáÄÂà©Ê∂¶)",
                tiktokAdsTitle: "TikTok Shop ÂπøÂëäËßÑÂàí (GMV Max)",
                totalBudget: "ÊÄªÈ¢ÑÁÆó",
                budgetNote: "‰ªÖÈôêËê•ÈîÄ %",
                targetRoas: "ÁõÆÊ†á ROAS",
                minRoasNote: "ËÆæÁΩÆÊúÄ‰Ωé ROAS",
                acos: "ACOS",
                acosNote: "ÂπøÂëäË¥π/GMV ÊØî‰æã",
                maxCpa: "ÊúÄÂ§ß CPA (ÊàêÊú¨/Âçï)",
                maxCpaNote: "ÊØèÂçïÊàêÊú¨ (‰∏çÂèØË∂ÖËøá)",
                maxCpc: "ÊúÄÂ§ß CPC (Âá∫‰ª∑)",
                maxCpcNote: "ÁÇπÂáª‰ª∑Ê†º (Ê†áÂáÜÊ®°Âºè)",
                funnelInput: "ÊºèÊñóÊ®°ÊãüËæìÂÖ•",
                basketSize: "ÂÆ¢ÂçïÈáè (Ë¢ã/Âçï)",
                impressionsNeeded: "1. ÊâÄÈúÄÊõùÂÖâ (Impressions)",
                clicksTraffic: "2. ÁÇπÂáªÈáè (ÊµÅÈáè)",
                ordersTarget: "3. ËÆ¢ÂçïÈáè (ÁõÆÊ†á)",
                detailedCashflow: "ËØ¶ÁªÜÊØèÊúàÁé∞ÈáëÊµÅ (Á¨¨1Âπ¥)",
                monthlyGrowth: "ÊúàÂ¢ûÈïøÁéá:",
                taxDepTitle: "Á®éÂä°‰∏éÊäòÊóßËØ¶ÊÉÖ",
                depSchedule: "ÊäòÊóßË°® (Depreciation Schedule)",
                asset: "ËµÑ‰∫ß",
                value: "‰ª∑ÂÄº",
                lifeYear: "ÂØøÂëΩ (Âπ¥)",
                depPerYear: "ÊäòÊóß/Âπ¥",
                corpTax: "‰ºÅ‰∏öÊâÄÂæóÁ®é (Corporate Tax)",
                taxableIncome: "Â∫îÁ∫≥Á®éÊâÄÂæóÈ¢ù (Taxable Income)",
                dividendTitle: "ËÇ°ÊÅØÊîøÁ≠ñ & ËÇ°‰∏úÂõûÊä•",
                policyInput: "ÊîøÁ≠ñ (Policy Inputs)",
                payoutRatio: "ÂàÜÁ∫¢ÊØî‰æã (%)",
                shareholders: "ËÇ°‰∏ú‰∫∫Êï∞ (‰∫∫)",
                netProfitBreakdown: "ÂáÄÂà©Ê∂¶Êù•Ê∫ê (Net Profit Breakdown)",
                shareholderReturn: "ËÇ°‰∏úÂõûÊä• (Per Shareholder)",
                totalPool: "Êù•Ëá™ÊÄªÂàÜÁ∫¢Ê±† (Total Pool)",
                perYear: "Ê≥∞Èì¢/Âπ¥",
                perMonth: "Ê≥∞Èì¢/Êúà",
                avgPerMonth: "Âπ≥Âùá",
                financialHealth: "Ë¥¢Âä°ÂÅ•Â∫∑Ê£ÄÊü• (Á¨¨1Âπ¥)",
                debtToEquity: "ÂÄ∫Âä°ÊùÉÁõäÊØî (D/E Ratio)",
                debtToEquityDesc: "ÂÄ∫Âä°/ÊùÉÁõä (Â∫î < 2.0)",
                returnOnAsset: "ËµÑ‰∫ßÂõûÊä•Áéá (ROA)",
                returnOnEquity: "ËÇ°Êú¨ÂõûÊä•Áéá (ROE)",
                assetTurnoverDesc: "ËµÑ‰∫ßÂë®ËΩ¨Áéá (Ê¨°/Âπ¥)",
                projectionTitle: "ËØ¶ÁªÜ5Âπ¥Ë¥¢Âä°È¢ÑÊµã (Âê´Á®éÁõæ & ÂàÜÁ¶ªÂ¢ûÈïø)",
                npvDesc: "ÂáÄÁé∞ÂÄº (NPV) Ê†πÊçÆ5Âπ¥ÂáÄÁé∞ÈáëÊµÅÂáèÂéªÂàùÂßãÊäïËµÑËÆ°ÁÆó",
                aiAnalysis: "ü§ñ ÁªìÊûúÂàÜÊûê & Âª∫ËÆÆ (AI Analysis)",
                businessAnalysis: "üìã ‰∏öÂä°ÂàÜÊûê (Business Analysis)",
                modelViability: "Ê®°ÂûãÂèØË°åÊÄß",
                businessStrengths: "‰ºòÂäø",
                businessWeaknesses: "Âä£Âäø",
                riskAssessment: "È£éÈô©ËØÑ‰º∞",
                strategicRecommendations: "ÊàòÁï•Âª∫ËÆÆ",
                financialHealthScore: "Ë¥¢Âä°ÂÅ•Â∫∑ËØÑÂàÜ",
                unitEconomicsAnalysis: "Âçï‰ΩçÁªèÊµéÂàÜÊûê",
                marketPositioning: "Â∏ÇÂú∫ÂÆö‰Ωç",
                growthPotential: "Â¢ûÈïøÊΩúÂäõ",
                viabilityScore: "ÂèØË°åÊÄßËØÑÂàÜ",
                excellent: "‰ºòÁßÄ",
                good: "ËâØÂ•Ω",
                fair: "‰∏ÄËà¨",
                poor: "ËæÉÂ∑Æ",
                critical: "Âç±ÊÄ•",
                financialDeepDive: "üìä Ê∑±ÂÖ•Ë¥¢Âä°ÂÅ•Â∫∑ (Financial Deep Dive)",
                adsPerformance: "üì¢ Ê∑±ÂÖ•ÂπøÂëäÁª©Êïà (Ads Performance)",
                financialGlossary: "üìö Ë¥¢Âä°Áº©Áï•ËØ≠Ëß£Èáä (Financial Glossary)",
                marketingGlossary: "üì¢ Ëê•ÈîÄ‰∏éÂπøÂëäÁº©Áï•ËØ≠Ëß£Èáä (Marketing & Ads Glossary)",
                
                // --- Additional Translations ---
                beRoas: "Áõà‰∫èÂπ≥Ë°° ROAS (Breakeven)",
                beRoasNote: "‰∏çÂæó‰Ωé‰∫éÊ≠§ÂÄº (Âçï‰ΩçÂà©Ê∂¶ = 0)",
                beRoasDesc: "‰ΩøÂçï‰ΩçÂà©Ê∂¶ = 0 ÁöÑÊúÄ‰Ωé ROAS (Êî∂ÂÖ• = ÂèòÂä®ÊàêÊú¨ + ÂπøÂëäÊîØÂá∫)",
                spreadAnalysis: "‚ö†Ô∏è ÊïèÊÑüÊÄßÂàÜÊûê (‰ª∑Â∑Æ: ÊàêÊú¨ vs ÂîÆ‰ª∑)",
                useStock: "‰ΩøÁî®Â∫ìÂ≠ò", 
                stockBuy: "Ë¥≠‰π∞Â∫ìÂ≠ò",
                priceLabel: "ÂîÆ‰ª∑ (Price)",
                perMonth: "Ê≥∞Èì¢/Êúà",
                paybackNotYet: "Â∞öÊú™ÂõûÊú¨",
                autoChannel: "Ê†πÊçÆÊ∏†ÈÅìÁªÑÂêàËÆ°ÁÆó",
                taxSave: "ËäÇÁ®é",
                capexDesc: "Êî∂ÂõûÂàùÂßãÊäïËµÑÁöÑÊúüÈôê",

                // NEW: Scenario Comparison
                scenComp: "Âú∫ÊôØÊØîËæÉ (Scenario Comparison)",
                scenWorst: "ÊúÄÂ∑Æ (Worst)",
                scenBase: "Ê≠£Â∏∏ (Base)",
                scenBest: "ÊúÄÂ•Ω (Best)",
                scenProfit: "ÂáÄÂà©Ê∂¶",
                scenCash: "Âπ¥Êú´Áé∞Èáë",

                // NEW: Ads Matrix
                adsMatrixTitle: "üéØ ÂπøÂëäÊïàÁéáÁü©Èòµ (CTR x CVR = ROAS)",
                adsMatX: "CTR (ËßÜÈ¢ëË¥®Èáè)",
                adsMatY: "CVR (ËΩ¨ÂåñËÉΩÂäõ)",
                
                // NEW: Monte Carlo
                mcTitle: "üé≤ ËíôÁâπÂç°Ê¥õÊ®°Êãü (Âà©Ê∂¶Ê¶ÇÁéá)",
                mcDesc: "Ê®°Êãü 10,000 ‰∏™Âú∫ÊôØÔºåÈöèÊú∫Âåñ CTR (¬±25%)„ÄÅCVR (¬±30%)„ÄÅCPM (Ê†πÊçÆÊâÄÈÄâÊ®°Âûã)„ÄÅÈúÄÊ±Ç (¬±15%)„ÄÅË¥≠Áâ©ÁØÆÂ§ßÂ∞è (¬±10%)„ÄÅÈÄÄË¥ßÁéá (¬±2%) ÂíåÂπ≥Âè∞ËΩ¨Âåñ‰∏ãÈôç (¬±10%)",
                cpmVolatilityTitle: "CPM Ê≥¢Âä®Ê®°Âûã",
                cpmVolatilityNormal: "Ê≠£Â∏∏Â∏ÇÂú∫",
                cpmVolatilityNormalDesc: "Ê≠£Â∏∏Â∏ÇÂú∫: CPM Ê≥¢Âä® ¬±60%",
                cpmVolatilityNormalTooltip: "Ê≠£Â∏∏Â∏ÇÂú∫Ê®°Âûã:\n‚Ä¢ CPM Â∞ÜÂú®Âü∫Á°Ä CPM ÁöÑ -60% Ëá≥ +60% ‰πãÈó¥Ê≥¢Âä®\n‚Ä¢ ÈÄÇÁî®‰∫éÂ∏ÇÂú∫Á®≥ÂÆö„ÄÅÁ´û‰∫â‰∏çÊøÄÁÉàÁöÑÊÉÖÂÜµ\n‚Ä¢ ÈÄÇÂêàÈïøÊúüËßÑÂàí",
                cpmVolatilityHigh: "È´òÁ´û‰∫âÊúü",
                cpmVolatilityHighDesc: "È´òÁ´û‰∫âÊúü: CPM Ê≥¢Âä® ¬±100%",
                cpmVolatilityHighTooltip: "È´òÁ´û‰∫âÊúüÊ®°Âûã:\n‚Ä¢ CPM Â∞ÜÂú®Âü∫Á°Ä CPM ÁöÑ 0% Ëá≥ +100% ‰πãÈó¥Ê≥¢Âä®\n‚Ä¢ ÈÄÇÁî®‰∫éÂ§ßÈáèÁ´û‰∫âÂØπÊâãËøõÂÖ•Â∏ÇÂú∫ÁöÑÊÉÖÂÜµ\n‚Ä¢ CPM ÂèØËÉΩÂ§ßÂπÖ‰∏ãÈôçÊàñÂ§ßÂπÖ‰∏äÂçá",
                cpmVolatilityExtreme: "ÊûÅÁ´ØÂÜ≤Âáª",
                cpmVolatilityExtremeDesc: "Â∏ÇÂú∫ÂÜ≤Âáª: CPM Ê≥¢Âä® ¬±150%",
                cpmVolatilityExtremeTooltip: "Â∏ÇÂú∫ÂÜ≤ÂáªÊ®°Âûã:\n‚Ä¢ CPM Â∞ÜÂú®Âü∫Á°Ä CPM ÁöÑ -150% Ëá≥ +150% ‰πãÈó¥Ê≥¢Âä®\n‚Ä¢ ÈÄÇÁî®‰∫éÂèëÁîüÊÑèÂ§ñ‰∫ã‰ª∂ÔºåÂ¶ÇÁªèÊµéÂç±Êú∫„ÄÅÊîøÁ≠ñÂèòÂåñ\n‚Ä¢ È£éÈô©ÊûÅÈ´òÔºå‰ΩÜÂõûÊä•‰πüÂèØËÉΩÊûÅÈ´ò",
                mcP10: "P10 (ÊúÄÂ∑Æ 10%)",
                mcP50: "P50 (‰∏≠‰ΩçÊï∞)",
                mcP90: "P90 (ÊúÄÂ•Ω 10%)",
                mcP5: "P5 (ÊúÄÂ∑Æ 5%)",
                mcP95: "P95 (ÊúÄÂ•Ω 5%)",
                mcProb: "Ê¶ÇÁéá",
                mcProfit: "ÂáÄÂà©Ê∂¶",
                mcRiskTitle: "üìä È£éÈô©ÂàÜÊûê",
                mcProbLoss: "‰∫èÊçüÊ¶ÇÁéá",
                mcProbLossDesc: "Âà©Ê∂¶ < 0 ÁöÑÊ¶ÇÁéá",
                mcProbTarget: "ËææÂà∞ÁõÆÊ†áÂà©Ê∂¶Ê¶ÇÁéá",
                mcProbTargetDesc: "Âà©Ê∂¶ ‚â• ÁõÆÊ†áÁöÑÊ¶ÇÁéá",
                mcProbRoasBelow: "ROAS < Áõà‰∫èÂπ≥Ë°°Ê¶ÇÁéá",
                mcProbRoasBelowDesc: "ROAS < Áõà‰∫èÂπ≥Ë°° ROAS ÁöÑÊ¶ÇÁéá",
                mcWorstCase: "ÊúÄÂùèÊÉÖÂÜµ (P5)",
                mcWorstCaseDesc: "ÊúÄÂùèÊÉÖÂÜµ (Ââç 5%)",
                mcBestCase: "ÊúÄÂ•ΩÊÉÖÂÜµ (P95)",
                mcSensitivityTitle: "üîç ÊïèÊÑüÊÄßÂàÜÊûê",
                mcTopDrivers: "Âà©Ê∂¶Ê≥¢Âä®ÁöÑ‰∏ªË¶ÅÈ©±Âä®Âõ†Á¥†",
                mcElasticityDesc: "ÂèòÈáèÂ¢ûÂä† 1% Êó∂Âà©Ê∂¶ÂèòÂåñÁôæÂàÜÊØî",
                mcScaleTitle: "üìà Â¢ûÈïø/ËßÑÊ®°ÂàÜÊûê",
                mcScaleDesc: "ÂΩì ROAS > ÁõÆÊ†áÊó∂ÁöÑÊâ©Â±ïÂú∫ÊôØ",
                traffic: "ÊµÅÈáè",
                revenue: "Êî∂ÂÖ•",
                profit: "Âà©Ê∂¶",
                risk: "È£éÈô©",
                traffic: "ÊµÅÈáè",
                revenue: "Êî∂ÂÖ•",
                profit: "Âà©Ê∂¶",
                risk: "È£éÈô©",

                // --- Cash Flow Summary (Below Table) ---
                wcStart: "ÂàùÂßãËµÑÈáë (Working Cap)",
                lowestCash: "ÊúÄ‰ΩéÁé∞ÈáëÁÇπ (Lowest)",
                debtService: "ÂÅøËøòÊú¨Èáë+Âà©ÊÅØ",
                taxPaidCash: "ÂÆûÁº¥Á®éÊ¨æ (Cash Paid)",
                netProfitAcc: "‰ºöËÆ°ÂáÄÂà©Ê∂¶ (Net Profit)",
                netProfitDesc: "(Êî∂ÂÖ• - ÊîØÂá∫ - ÊäòÊóß - Âà©ÊÅØ - Á®é)",
                cashEndYear: "Âπ¥Êú´Áé∞Èáë‰ΩôÈ¢ù (Cash Balance)",
                cashEndDesc: "(ÂàùÂßãËµÑÈáë + ÂÆûÈôÖÁé∞ÈáëÊµÅ - Á®é - ÂÄ∫Âä°)",

                // --- NEW MODULE: Runway ---
                runwayTitle: "üî• Áé∞ÈáëË∑ëÈÅì (Cash Runway)",
                burnRateTitle: "ÁÉßÈí±Áéá (Êúà):",
                runwayMeaning: "Ëã•Êî∂ÂÖ•‰∏∫0ËøòËÉΩÁîüÂ≠ò:",
                runwaySafe: "ÂÆâÂÖ®! (> 6 ‰∏™Êúà)",
                runwayWarn: "È£éÈô© (3-6 ‰∏™Êúà)",
                runwayDanger: "Âç±Èô©! (< 3 ‰∏™Êúà)",
                runwayDescText: "ËÆ°ÁÆóÔºöÊâãÂ§¥Áé∞Èáë / (Âõ∫ÂÆöÊîØÂá∫ + ÊúàËøòÊ¨æ)",

                // --- NEW MODULE: Future Stock Strategy ---
                futureStockTitle: "üåæ Á¨¨‰∫åÂπ¥Â∫ìÂ≠òÁ≠ñÁï• (Year 2 Strategy)",
                cashAvailable: "Âπ¥Êú´Áé∞Èáë‰ΩôÈ¢ù (Cash End Y1)",
                estRiceCostY2: "È¢Ñ‰º∞Á¨¨‰∫åÂπ¥Á±≥ÊàêÊú¨ (Total)",
                canStock: "ÂèØÈ¢ÑË¥≠Â∫ìÂ≠ò:",
                months: "Êúà (Months)",
                fullYearAble: "‚úÖ ÊûÅÂ•ΩÔºÅÊòéÂπ¥ÂèØ‰ª•Âõ§Êª°12‰∏™ÊúàÁöÑË¥ß (Â§ßÂπÖÈôç‰ΩéÊàêÊú¨)",
                partialYear: "‚ö†Ô∏è ËµÑÈáë‰∏çË∂≥‰ª•Âõ§Êª°ÂÖ®Âπ¥ (ÈúÄË°•ÂÖÖÁé∞ÈáëÊµÅ)",

                // ... (rest same) ...
                channelMixTitle: "üõí Ê∏†ÈÅìÊî∂ÂÖ•ÁªÑÂêà (Channel Mix)",
                channelPct: "% ÈîÄÂîÆÈ¢ù",
                platformFeePct: "ÊâãÁª≠Ë¥π %",
                mktPct: "% Ëê•ÈîÄ",
                tableChannel: "Ê∏†ÈÅì",
                tableMixPct: "% ÈîÄÂîÆÈ¢ù",
                tableRevenue: "Êî∂ÂÖ•",
                tableFee: "ÊâãÁª≠Ë¥π",
                tableAds: "ÂπøÂëäË¥π",
                tableGrossCM: "ÊØõÂà©Ê∂¶",
                tableContribCM: "Ë¥°ÁåÆÂà©Ê∂¶",
                tableGMPct: "ÊØõÂà©Áéá %",
                tableCvrCtr: "CVR \\ CTR",
                grossCmBag: "ÊØõÂà©Ê∂¶/Ë¢ã",
                adsBag: "ÂπøÂëäË¥π/Ë¢ã",
                varCostBag: "ÂèòÂä®ÊàêÊú¨/Ë¢ã",
                priceExVat: "‰ª∑Ê†ºÔºà‰∏çÂê´Á®éÔºâ",
                offline: "Á∫ø‰∏ã / ÂÖ∂‰ªñ",
                weightedFee: "Âπ≥Âùá (Weighted Fee):",
                b2c: "B2C",
                b2b: "B2B",
                tiktokShop: "TikTok Shop",
                lineShop: "Line Shop",
                ads: "ÂπøÂëä",
                organic: "Ëá™ÁÑ∂ÊµÅÈáè",
                live: "Áõ¥Êí≠",
                affiliate: "ËÅîÁõüËê•ÈîÄ",
                member: "‰ºöÂëò",
                normal: "ÊôÆÈÄö",
                hotel: "ÈÖíÂ∫ó",
                export: "Âá∫Âè£",
                modernTrade: "Áé∞‰ª£Ë¥∏Êòì",
                channelMixTable: "Ê∏†ÈÅìÁªÑÂêàË°®",
                totalMix: "ÊÄªËÆ° %",

                elasticityTitle: "üíé ÂìÅÁâå‰ª∑Ê†ºÂºπÊÄß (Brand Pricing Elasticity)",
                elasticityCoef: "‰ª∑Ê†ºÊïèÊÑüÂ∫¶ (Elasticity)",
                elasticityDesc: (c) => `(-${c} ÊÑèÂë≥ÁùÄ ‰ª∑Ê†º‰∏äÊ∂® 10%ÔºåÈîÄÈáè‰∏ãÈôç ${(c * 10).toFixed(0)}%)`,
                optPrice: "ÂΩìÂâç‰ª∑Ê†º",
                estVol: "È¢Ñ‰º∞ÈîÄÈáè",
                estRev: "È¢Ñ‰º∞Êî∂ÂÖ•",
                
                clvTitle: "üë• ÂÆ¢Êà∑ÁªàË∫´‰ª∑ÂÄº (CLV)",
                freqPerYear: "Ë¥≠‰π∞È¢ëÁéá (Ê¨°/Âπ¥)",
                retentionRate: "ÁïôÂ≠òÁéá (%)",
                ltv1: "LTV (1 Âπ¥)",
                ltv3: "LTV (3 Âπ¥)",
                cac: "Ëé∑ÂÆ¢ÊàêÊú¨ (CAC)",
                ltvCacRatio: "LTV : CAC ÊØî‰æã",
                ltvDesc: "Ratio > 3 ÂÄçÊó∂ÂÄºÂæóÊäïÂÖ•",

                seasonalTitle: "‚õàÔ∏è Â≠£ËäÇÊÄß‰æõÂ∫îÂÜ≤Âáª (Seasonal Supply Shock)",
                enableShock: "Ê®°ÊãüÂú∫ÊôØ (Enable Scenario)",
                shockMonthStart: "ÂºÄÂßãÊúà‰ªΩ",
                shockMonthEnd: "ÁªìÊùüÊúà‰ªΩ",
                shockCostImpact: "Á®ªË∞∑ÊàêÊú¨Â¢ûÂä† (%)",
                shockDesc: "ÂΩ±ÂìçÂ∞ÜÊòæÁ§∫Âú®ÊØèÊúàÁöÑÁé∞ÈáëÊµÅË°®‰∏≠",

                // --- Cash Flow Table Headers ---
                cfSales: "ÈîÄÂîÆÈ¢ù (È¢ÑËÆ¢)",
                cfInflow: "ÂÆûÈôÖÁé∞ÈáëÊµÅÂÖ•",
                cfExp: "Áé∞ÈáëÊîØÂá∫",
                cfStock: "Ë¥≠‰π∞Â∫ìÂ≠ò (Stock)", // NEW
                cfOpEx: "ËøêËê•ÊîØÂá∫ (OpEx)", // NEW
                cfVat: "Â¢ûÂÄºÁ®éÂáÄÈ¢ù",
                cfOpCash: "ÂáÄÁé∞ÈáëÊµÅ (Net Flow)", // Changed
                cfBalance: "Áé∞Èáë‰ΩôÈ¢ù",
                start0: "0 (ÂàùÂßã)",
                
                // Note for Cashflow
                cfNote: "* Ê≥®ÊÑèÔºöËã•ÈÄâÊã©‚ÄúÈ¢ÑÂ≠òÂ∫ìÂ≠ò‚ÄùÔºàStock Policy > 0ÔºâÔºåÊÇ®Â∞ÜÂú®ÊØè‰∏™ÊúàÁúãÂà∞‚ÄúÊèêÂâç‚ÄùÁöÑÂ∫ìÂ≠òÊîØÂá∫Ôºà‰æãÂ¶ÇÔºåÁ¨¨ 1 ‰∏™ÊúàÊîØ‰ªòÁî®‰∫éÈîÄÂîÆÁ¨¨ 3 ‰∏™ÊúàÁöÑÂ§ßÁ±≥ÔºâÔºåËøôÂØºËá¥Êó©ÊúüÁé∞ÈáëÊµÅ‰∏∫Ë¥üÊàñÊ∂àËÄóÊõ¥Âø´ÔºàËµÑÈáëÁßØÂéãÂú®Â∫ìÂ≠ò‰∏≠Ôºâ„ÄÇ",

                // Glossary (Chinese)
                gEbitda: "ÊÅØÁ®éÊäòÊóßÊëäÈîÄÂâçÂà©Ê∂¶ÔºåÂèçÊò†‰ºÅ‰∏öÁúüÂÆûÁé∞ÈáëÂàõÈÄ†ËÉΩÂäõ",
                gNpv: "Êú™Êù•Áé∞ÈáëÊµÅÊäòÁé∞ÂêéÁöÑÊÄª‰ª∑ÂÄºÂáèÂéªÂàùÂßãÊäïËµÑ \n> 0 Ë°®Á§∫ÂÄºÂæóÊäïËµÑ",
                gDscr: "(EBITDA / Âπ¥Â∫¶ÂÄ∫Âä°ÂÅøËøòÈ¢ù) Áî®‰∫éËØÑ‰º∞ÊòØÂê¶ÊúâË∂≥Â§üÁé∞ÈáëÂÅøËøòÈì∂Ë°åË¥∑Ê¨æ \nÂ∫î > 1.25 (Èì∂Ë°åÂñúÊ¨¢)",
                gDe: "Ë¥üÂÄ∫‰∏éÊùÉÁõäÊØîÁéáÔºåË∂äÈ´òË∂äÈ£éÈô© \n‰∏çÂ∫îË∂ÖËøá 2.0 ÂÄç",
                gRoe: "(ÂáÄÂà©Ê∂¶ / ËÇ°‰∏úÊùÉÁõä) ËÇ°‰∏úÊäïÂÖ• 100 Ê≥∞Èì¢ËÉΩ‰∫ßÁîüÂ§öÂ∞ëÂà©Ê∂¶ \nË∂äÈ´òË∂äÂ•Ω (Â∫î > 10-15%)",
                gBep: "‰ΩøÊî∂ÂÖ•Á≠â‰∫éÊîØÂá∫ÁöÑ‰∫ßÂìÅÈîÄÂîÆÊï∞Èáè (Âà©Ê∂¶ = 0) Ë∂ÖËøáÊ≠§ÁÇπÂç≥‰∏∫ÁõàÂà©",
                gRoa: "(ÂáÄÂà©Ê∂¶ / ÊÄªËµÑ‰∫ß) Ë°°Èáè‰ΩøÁî®ËµÑ‰∫ßÂàõÈÄ†Âà©Ê∂¶ÁöÑËÉΩÂäõ \nË∂äÈ´òË∂äÂ•Ω",
                gAssetTurn: "(ÈîÄÂîÆÈ¢ù / ÊÄªËµÑ‰∫ß) 1 Ê≥∞Èì¢ËµÑ‰∫ßËÉΩÂàõÈÄ†Â§öÂ∞ëÈîÄÂîÆÈ¢ùÔºåÂèçÊò†ËµÑ‰∫ß‰ΩøÁî®ÊïàÁéá",
                gGross: "((ÈîÄÂîÆÈ¢ù - ÈîÄÂîÆÊàêÊú¨) / ÈîÄÂîÆÈ¢ù) % Êâ£Èô§Áõ¥Êé•Áîü‰∫ßÊàêÊú¨ÂêéÁöÑÂà©Ê∂¶Ôºå‰∏çÂåÖÊã¨ÁÆ°ÁêÜË¥πÁî®",
                gNet: "(ÂáÄÂà©Ê∂¶ / ÈîÄÂîÆÈ¢ù) % Êâ£Èô§ÊâÄÊúâË¥πÁî®ÔºàÂåÖÊã¨Âà©ÊÅØÂíåÁ®éÔºâÂêéÁöÑÂÆûÈôÖÂà©Ê∂¶",
                gWc: "‰∏∫Áª¥ÊåÅ‰∏öÂä°ËøêËê•ËÄåÂøÖÈ°ªÂÇ®Â§áÁöÑÁé∞ÈáëÔºàÂú®Á≠âÂæÖÂÆ¢Êà∑‰ªòÊ¨æÊúüÈó¥ÈùûÂ∏∏ÈáçË¶ÅÔºâ",
                gTaxShield: "ÂÖÅËÆ∏Â∞ÜËøáÂéªÁöÑ\"Á¥ØËÆ°‰∫èÊçü\"Áî®‰∫éÊäµÊâ£Êú™Êù•Âà©Ê∂¶‰ª•ÂáèÂ∞ëÁ∫≥Á®éÁöÑÁ®éÂä°ÊùÉÂà©ÔºàÂèØ‰ΩøÁî® 5 Âπ¥Ôºâ",
                gCapex: "Áî®‰∫éË¥≠‰π∞ÈïøÊúüËµÑ‰∫ßÁöÑÂ§ßÈ¢ùÊäïËµÑÔºåÂ¶ÇÂª∫ÂéÇ„ÄÅË¥≠‰π∞Êú∫Âô®Ôºà‰∏çËÆ°ÂÖ•ÊúàÂ∫¶Ë¥πÁî®ÔºåËÄåÊòØ‰Ωú‰∏∫ÊäòÊóßÔºâ",
                gOpex: "Êó•Â∏∏ËøêËê•Ë¥πÁî®ÔºåÂ¶ÇÂ∑•ËµÑ„ÄÅÁîµË¥π„ÄÅËê•ÈîÄË¥πÁî®ÔºàËÆ°ÂÖ•ÂΩìÊúàË¥πÁî®Ôºâ",
                gCf: "‰ºÅ‰∏öÁöÑÁîüÂëΩÁ∫øÔºåÂç≥ÂÆûÈôÖÊµÅÂÖ•ÂíåÊµÅÂá∫ÁöÑÁé∞ÈáëÔºåÊØî‰ºöËÆ°Âà©Ê∂¶Êõ¥ÈáçË¶ÅÔºåÂõ†‰∏∫Â¶ÇÊûúÁé∞ÈáëÁü≠Áº∫Ôºå‰ºÅ‰∏öÂèØËÉΩÁ´ãÂç≥ÂÄíÈó≠",
                gFix: "Êó†ËÆ∫ÈîÄÂîÆÂ•ΩÂùèÈÉΩÂøÖÈ°ªÊîØ‰ªòÁöÑÂõ∫ÂÆöË¥πÁî®ÔºåÂ¶ÇÁßüÈáë„ÄÅÂäûÂÖ¨ÂÆ§ÂëòÂ∑•Â∑•ËµÑ„ÄÅÊäòÊóß",
                gVar: "ÈöèÈîÄÂîÆÈ¢ùÂ¢ûÂáèÁöÑË¥πÁî®ÔºåÂ¶ÇÁ®ªË∞∑ÊàêÊú¨„ÄÅÂåÖË£ÖË¢ã„ÄÅ‰Ω£Èáë„ÄÅËøêË¥π",
                
                gRoas: "(ÂπøÂëäÈîÄÂîÆÈ¢ù / ÂπøÂëäË¥πÁî®) Ëä±Ë¥π 1 Ê≥∞Èì¢ÂπøÂëäË¥πËÉΩËé∑ÂæóÂ§öÂ∞ëÈîÄÂîÆÈ¢ù \nË∂äÈ´òË∂äÂ•Ω (TikTok Shop Â∫î > 5-7x)",
                gAcos: "(ÂπøÂëäË¥πÁî® / ÈîÄÂîÆÈ¢ù) ÂπøÂëäË¥πÁî®Âç†‰∫ßÂìÅÈîÄÂîÆÈ¢ùÁöÑÁôæÂàÜÊØî \nË∂ä‰ΩéË∂äÂ•Ω (Â∫î‰Ωé‰∫éÊØõÂà©ÁéáÁôæÂàÜÊØî)",
                gCpa: "(ÊÄªÈ¢ÑÁÆó / ËÆ¢ÂçïÊï∞) ‰∏∫Ëé∑Âæó‰∏Ä‰∏™ÂÆ¢Êà∑ÈúÄË¶ÅËä±Ë¥πÂ§öÂ∞ëÊ≥∞Èì¢ \n‰∏çËÉΩË∂ÖËøáÊØè‰ª∂Âà©Ê∂¶ÔºåÂê¶Âàô‰∫èÊçü",
                gCpc: "ÂΩìÊúâ‰∫∫ÁÇπÂáªÂπøÂëäÊó∂Êàë‰ª¨ÊîØ‰ªòÁöÑÂπ≥Âùá‰ª∑Ê†º \nÂèñÂÜ≥‰∫éÁ´û‰∫âÂíåÂπøÂëäË¥®Èáè",
                gCtr: "(ÁÇπÂáªÊ¨°Êï∞ / Â±ïÁ§∫Ê¨°Êï∞) % ÁúãÂà∞ÂπøÂëäÂêéÁÇπÂáªÁöÑ‰∫∫ \nË∂äÈ´òË°®Á§∫ÂÜÖÂÆπË∂äÊúâË∂£ (TikTok Â∫î > 1.5-2%)",
                gCvr: "(ËÆ¢ÂçïÊï∞ / ÁÇπÂáªÊ¨°Êï∞) % ÁÇπÂáªÂêéÁúüÊ≠£ÂÜ≥ÂÆöË¥≠‰π∞ÁöÑ‰∫∫ \nÈùûÂ∏∏ÈáçË¶ÅÔºÅÂ¶ÇÊûú‰ΩéÂøÖÈ°ªÊîπËøõ‰∫ßÂìÅÈ°µÈù¢/‰ª∑Ê†º",
                gCpm: "ÂπøÂëäÂ±ïÁ§∫ 1,000 Ê¨°ÈúÄË¶ÅÊîØ‰ªòÁöÑ‰ª∑Ê†º \nÁî®‰∫éÊü•ÁúãÂπøÂëäË¥πÁî®Êï¥‰ΩìÊòØ‰∏äÊ∂®ËøòÊòØ‰∏ãÈôç",
                gGmv: "Âπ≥Âè∞‰∏äÂèëÁîüÁöÑÂïÜÂìÅÈîÄÂîÆÊÄªÈ¢ùÔºàÂ∞öÊú™Êâ£Èô§ÊâãÁª≠Ë¥πÊàñÈÄÄË¥ßÔºâ",
                gImp: "ÂπøÂëäË¢´ÂèëÈÄÅÂà∞ÂÆ¢Êà∑Â±èÂπïÊòæÁ§∫ÁöÑÊ¨°Êï∞ÔºàÂêå‰∏Ä‰∫∫ÂèØ‰ª•ÈáçÂ§çËÆ°ÁÆóÔºâ",
                gAov: "ÊØè‰∏™ËÆ¢ÂçïÁöÑÂπ≥ÂùáË¥≠‰π∞ÈáëÈ¢ùÔºàË∂äÂ§öË∂äÂ•ΩÔºåÂõ†‰∏∫ËøêË¥πÂíåÂπøÂëäË¥πÈÄöÂ∏∏Áõ∏ÂêåÔºå‰ΩøÊØèÂçïÂà©Ê∂¶Â¢ûÂä†Ôºâ",
                gAff: "ÈÄöËøá‰ªñ‰∫∫ÔºàÂàõ‰ΩúËÄÖÔºâÈîÄÂîÆÔºåÊàë‰ª¨ÂàÜ‰∫´ÈîÄÂîÆÈ¢ùÁöÑÁôæÂàÜÊØî \n‰ºòÁÇπÊòØÔºöÂ¶ÇÊûúÊ≤°ÂçñÂá∫Â∞±‰∏çÈúÄË¶ÅÊîØ‰ªò (Cost per Action)",
                gReach: "ÁúüÊ≠£\"ÁúãÂà∞\"ÂπøÂëäÁöÑ\"‰∫∫Êï∞\"Ôºà‰∏çÂêå‰∫é Impression ËÆ°ÁÆó\"Ê¨°Êï∞\"ÔºâÁî®‰∫éÊü•ÁúãÂπøÂëäË¶ÜÁõñËåÉÂõ¥",
                gLtv: "‰∏Ä‰∏™ÂÆ¢Êà∑Êú™Êù•Â∞Ü‰ªéÊàë‰ª¨ËøôÈáåË¥≠‰π∞ÁöÑÊÄª‰ª∑ÂÄºÔºàÊ†πÊçÆ AOV √ó Ë¥≠‰π∞È¢ëÁéá √ó Âà©Ê∂¶Áéá √ó ÂÆ¢Êà∑ÁîüÂëΩÂë®ÊúüËÆ°ÁÆóÔºâ\nË∂äÈ´òË∂äÂ•ΩÔºåË°®ÊòéÂÆ¢Êà∑Êúâ‰ª∑ÂÄº",
                gCac: "‰∏∫Ëé∑Âæó‰∏Ä‰∏™Êñ∞ÂÆ¢Êà∑ÂøÖÈ°ªÊîØ‰ªòÁöÑÂπ≥ÂùáË¥πÁî®ÔºàÂåÖÊã¨ÊâÄÊúâÂπøÂëäÂíåËê•ÈîÄË¥πÁî®Ôºâ\nÂ∫î‰Ωé‰∫é LTV Ëá≥Â∞ë 3 ÂÄç",
                
                // New Financial Glossary terms (Chinese)
                gContributionMargin: "Êâ£Èô§ÂπøÂëäË¥πÁî®ÂêéÁöÑÊØõÂà©Ê∂¶ (Gross Margin - Marketing Cost) \nÊòæÁ§∫ÊîØ‰ªòÂπøÂëäË¥πÁî®ÂêéËøòÂâ©Â§öÂ∞ëÂà©Ê∂¶",
                gChannelMix: "ÂêÑÊ∏†ÈÅìÈîÄÂîÆÈ¢ùÂç†ÊØîÔºàÂ¶Ç TikTok Shop 80%, Line Shop 10%, B2B 10%Ôºâ\nÁî®‰∫éËßÑÂàíËê•ÈîÄÈ¢ÑÁÆóÂíåÂπ≥Âè∞ÊâãÁª≠Ë¥π",
                gWorkingCapitalCycle: "Ëê•ËøêËµÑÈáëÂë®ÊúüÔºöÁé∞ÈáëË¢´\"ÈîÅÂÆö\"Âú®Â∫îÊî∂Ë¥¶Ê¨æ„ÄÅÂ∫ìÂ≠òÂíåÂ∫î‰ªòË¥¶Ê¨æ‰∏≠ÁöÑÂ§©Êï∞ \nË∂äÁü≠Ë∂äÂ•Ω = Áé∞ÈáëÂë®ËΩ¨Ë∂äÂø´",
                gArDays: "Â∫îÊî∂Ë¥¶Ê¨æÂ§©Êï∞ÔºöÂπ≥ÂùáÁ≠âÂæÖ‰ªéÂÆ¢Êà∑Êî∂Ê¨æÁöÑÂ§©Êï∞ \nË∂äÁü≠Ë∂äÂ•Ω (0 Â§© = Á´ãÂç≥Áé∞ÈáëÊîØ‰ªò)",
                gApDays: "Â∫î‰ªòË¥¶Ê¨æÂ§©Êï∞ÔºöÂπ≥ÂùáÂèØ‰ª•Âª∂ËøüÊîØ‰ªò‰æõÂ∫îÂïÜÁöÑÂ§©Êï∞ \nË∂äÈïøË∂äÂ•Ω = ÂèØ‰ª•‰ΩøÁî®‰æõÂ∫îÂïÜËµÑÈáëÊõ¥ÈïøÊó∂Èó¥",
                gInventoryDays: "Â∫ìÂ≠òÂ§©Êï∞ÔºöÂπ≥ÂùáÂ∫ìÂ≠òÂïÜÂìÅÂú®‰ªìÂ∫ì‰∏≠ÁöÑÂ§©Êï∞ \nË∂äÁü≠Ë∂äÂ•Ω = Áé∞Èáë‰∏çË¢´ÈîÅÂÆö",
                gCapexStepUp: "ÂΩìÈîÄÂîÆÈ¢ùËææÂà∞‰∏ÄÂÆöÊ∞¥Âπ≥Êó∂ÁöÑÈ¢ùÂ§ñÊäïËµÑÔºàÂ¶ÇÊâ©Âª∫Â∑•ÂéÇ„ÄÅË¥≠‰π∞Êõ¥Â§öÊú∫Âô®Ôºâ\nÁî®‰∫éÈïøÊúüÂ¢ûÈïøËßÑÂàí",
                gUnitEconomics: "Âçï‰ΩçÁªèÊµéÂ≠¶ÔºöÂàÜÊûêÊØèÂçï‰Ωç‰∫ßÂìÅÁöÑÁõà‰∫èÔºà‰ª∑Ê†º„ÄÅÊàêÊú¨„ÄÅÊØõÂà©Ê∂¶„ÄÅÂπøÂëäË¥πÁî®Ôºâ\nÁî®‰∫éÂÜ≥ÂÆöÊòØÂê¶Â∫îËØ•ÈîÄÂîÆ",
                gVatInput: "ËøõÈ°πÂ¢ûÂÄºÁ®éÔºöË¥≠‰π∞ÂïÜÂìÅÊó∂ÊîØ‰ªòÁöÑ VATÔºàÂ¶ÇË¥≠‰π∞ÂéüÊùêÊñôÔºâ\nÂèØ‰ª•ÊäµÊâ£ÈîÄÈ°πÂ¢ûÂÄºÁ®é",
                gVatOutput: "ÈîÄÈ°πÂ¢ûÂÄºÁ®éÔºöÈîÄÂîÆÂïÜÂìÅÊó∂ÂøÖÈ°ªÂêëÂÆ¢Êà∑Êî∂ÂèñÁöÑ VAT \nÂøÖÈ°ªÊØèÊúàÂêëÁ®éÂä°Â±ÄÁº¥Á∫≥",
                gVatNet: "ÂáÄÂ¢ûÂÄºÁ®é = ÈîÄÈ°πÂ¢ûÂÄºÁ®é - ËøõÈ°πÂ¢ûÂÄºÁ®é \nÂ¶ÇÊûú‰∏∫Ê≠£ = ÂøÖÈ°ªÊîØ‰ªòÁªôÁ®éÂä°Â±ÄÔºåÂ¶ÇÊûú‰∏∫Ë¥ü = Ëé∑ÂæóÈÄÄÁ®é",
                gMultiChannelPl: "ÊåâÈîÄÂîÆÊ∏†ÈÅìÂàÜÂàóÁöÑ P&LÔºöÂàÜÂà´ÂàÜÊûêÂêÑÊ∏†ÈÅìÁöÑÊî∂ÂÖ•„ÄÅË¥πÁî®ÂíåÂà©Ê∂¶ \nÁî®‰∫éÊü•ÁúãÂì™‰∏™Ê∏†ÈÅìÊúÄËµöÈí±",
                
                // --- 5-Year Projection Headers (CN) ---
                pyYear: "Âπ¥‰ªΩ",
                pyRev: "ÊÄªÊî∂ÂÖ•",
                pyExp: "ÊîØÂá∫ (Áé∞Èáë)",
                pyEbitda: "EBITDA",
                pyDep: "ÊäòÊóß",
                pyTax: "Á®éÊ¨æ",
                pyNet: "ÂáÄÂà©Ê∂¶",
                pyDiv: "ËÇ°ÊÅØ",
                pyCashEnd: "Âπ¥Êú´Áé∞Èáë",
                ebitdaYear: "EBITDA (Âπ¥)",
                depreciation: "ÊäòÊóß",
                interest: "Âà©ÊÅØ",
                taxLiability: "Á®éÂä°Ë¥üÂÄ∫",
                netProfit: "ÂáÄÂà©Ê∂¶",
                labelCampaign: "Ê¥ªÂä®:",
                labelErp: "ERP:",
                labelInsurance: "‰øùÈô©:",
                labelAudit: "ÂÆ°ËÆ°/Ê≥ïÂæã:",
                labelTravel: "Â∑ÆÊóÖ/Â®±‰πê:",
                labelMisc: "ÊùÇÈ°π:",
                labelMaintenance: "Áª¥Êä§:",
                labelSalary: "Â∑•ËµÑ (Âü∫Êú¨+Á§æ‰øù):",
                labelOtherFixed: "ÂÖ∂‰ªñÂõ∫ÂÆöÊàêÊú¨:",
                labelRice: "Â§ßÁ±≥:",
                labelPack: "ÂåÖË£Ö:",
                labelFees: "ÊâãÁª≠Ë¥π:",
                labelElec: "ÁîµË¥π:",
                growthLabel: "Â¢ûÈïøÁéá:",
                inflationLabel: "ÈÄöË¥ßËÜ®ËÉÄÁéá:",
                discountRateLabel: "Ë¥¥Áé∞Áéá:",
                monthly: "ÊØèÊúà",
                annual: "ÊØèÂπ¥",
                deferred: "Âª∂Êúü",
                tier: "Á≠âÁ∫ß",
                rate: "Á®éÁéá",
                taxLabel: "Á®é",
                totalTax: "ÊÄªÁ®éÈ¢ù",
                assetTurnover: "ËµÑ‰∫ßÂë®ËΩ¨Áéá",
                fixedCostDebtService: "Âõ∫ÂÆöÊàêÊú¨ + ÂÄ∫Âä°ÊúçÂä°",
                roa: "ROA",
                roe: "ROE",
                change: "ÂèòÂåñ",
                
                // VAT Impact Analysis (CN)
                vatImpactTitle: "üìä Â¢ûÂÄºÁ®éÁéáÂèòÂåñÂΩ±ÂìçÂàÜÊûê",
                vatRateLabel: "Â¢ûÂÄºÁ®éÁéá (%)",
                vatRateDesc: "Â¢ûÂÄºÁ®éÁéá (ÂΩìÂâç 7%ÔºåÂèØËÉΩÂ¢ûËá≥ 10%)",
                vatImpactCurrent: "ÂΩìÂâçÊÉÖÂÜµ",
                vatImpactScenario: "Ê®°ÊãüÊÉÖÂÜµ",
                vatImpactRevenue: "Êî∂ÂÖ•Ôºà‰∏çÂê´Á®éÔºâ",
                vatImpactCosts: "ÊàêÊú¨Ôºà‰∏çÂê´Á®éÔºâ",
                vatImpactProfit: "ÂáÄÂà©Ê∂¶",
                vatImpactCashFlow: "Áé∞ÈáëÊµÅ",
                vatImpactMargin: "ÂáÄÂà©Áéá",
                vatImpactChange: "ÂèòÂåñ",
                vatImpactIncrease: "Â¢ûÂä†",
                vatImpactDecrease: "ÂáèÂ∞ë",
                vatImpactNote: "Ê≥®ÊÑèÔºöÊèêÈ´òÂ¢ûÂÄºÁ®éÁéáÂ∞ÜÂØºËá¥‰∏çÂê´Á®éÊî∂ÂÖ•‰∏ãÈôçÔºå‰ΩÜ‰∏çÂê´Á®éÊàêÊú¨Â∞ÜÂ¢ûÂä†ÔºàÂõ†‰∏∫ËøõÈ°πÁ®éÂ¢ûÂä†Ôºâ"
            }
        };

        const SCENARIOS = {
            // ... (keep SCENARIOS unchanged) ...
            price_war: {
                category: 1,
                label: { th: "‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤ (Price War)", cn: "‰ª∑Ê†ºÊàò" },
                apply: (d) => ({ ...d, price: d.price * 0.85, varParams: { ...d.varParams, mktPercent: d.varParams.mktPercent * 1.2 } }),
                math_desc: { th: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ -15%, ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î +20%", cn: "ÂîÆ‰ª∑ -15%, Ëê•ÈîÄÈ¢ÑÁÆó +20%" },
                analysis: {
                    th: { impact: "‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏•‡∏î‡∏Æ‡∏ß‡∏ö, ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏û‡∏∏‡πà‡∏á", cause: "‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏£‡∏≤‡∏¢‡πÉ‡∏´‡∏ç‡πà‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏±‡∏î‡∏´‡∏ô‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏µ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ï‡∏µ‡∏ï‡∏•‡∏≤‡∏î", strategy: "‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏Ç‡πà‡∏á! ‡πÉ‡∏´‡πâ‡πÄ‡∏ô‡πâ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏±‡∏î‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Bundling) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏ô‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤" },
                    cn: { impact: "ÊØõÂà©ÁéáÊö¥Ë∑åÔºåËê•ÈîÄÊàêÊú¨È£ôÂçá", cause: "‰∏ªË¶ÅÁ´û‰∫âÂØπÊâãÈôç‰ª∑Êàñ‰∏≠ÂõΩÂïÜÂìÅËøõÂÖ•Â∏ÇÂú∫", strategy: "‰∏çË¶ÅÊâì‰ª∑Ê†ºÊàòÔºÅ‰∏ìÊ≥®‰∫éÂìÅÁâåÂª∫ËÆæÔºåÂ¢ûÂä†ÊúçÂä°ÊàñÊçÜÁªëÈîÄÂîÆ (Bundling) ‰ª•ÈÅøÂÖç‰ª∑Ê†ºÊØîËæÉ" }
                }
            },
            new_competitor: {
                category: 1,
                label: { th: "‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÉ‡∏´‡∏°‡πà (New Competitor)", cn: "Êñ∞Á´û‰∫âÂØπÊâã" },
                apply: (d) => ({ ...d, targetBags: d.targetBags * 0.8 }),
                math_desc: { th: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡πÄ‡∏õ‡πâ‡∏≤) -20%", cn: "ÈîÄÂîÆÁõÆÊ†á -20%" },
                analysis: {
                    th: { impact: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏Å 20%, ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏ï‡∏•‡∏≤‡∏î‡∏•‡∏î‡∏•‡∏á", cause: "‡∏°‡∏µ‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÅ‡∏¢‡πà‡∏á‡∏ê‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏î‡∏¥‡∏°", strategy: "‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ê‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏≤ (Retention) ‡∏î‡πâ‡∏ß‡∏¢ CRM, ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏ã‡πâ‡∏≥" },
                    cn: { impact: "ÈîÄÂîÆÈ¢ù‰∏ãÈôç 20%ÔºåÂ∏ÇÂú∫‰ªΩÈ¢ùÂáèÂ∞ë", cause: "Êñ∞ÂìÅÁâåÊä¢Âç†ÂéüÊúâÂÆ¢Êà∑Áæ§", strategy: "ÈÄöËøá CRM„ÄÅ‰ºöÂëòÁ≥ªÁªüÂíåÂ§çË¥≠‰øÉÈîÄÊù•Áïô‰ΩèËÄÅÂÆ¢Êà∑ (Retention)" }
                }
            },
            algo_change: {
                category: 1,
                label: { th: "‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏° (Algo Change)", cn: "ÁÆóÊ≥ïÂèòÊõ¥" },
                apply: (d) => ({ ...d, varParams: { ...d.varParams, mktPercent: d.varParams.mktPercent * 1.5 } }),
                math_desc: { th: "‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î (Ads) +50%", cn: "ÂπøÂëäÈ¢ÑÁÆó +50%" },
                analysis: {
                    th: { impact: "‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡πÅ‡∏û‡∏á‡∏Ç‡∏∂‡πâ‡∏ô 50% ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ, ROAS ‡∏£‡πà‡∏ß‡∏á", cause: "TikTok/Shopee ‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô (Reach) ‡∏Ç‡∏≠‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á", strategy: "‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏õ‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° ‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡∏ó‡∏≥‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå Organic ‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô (Entertainment first)" },
                    cn: { impact: "ÂπøÂëäË¥πÁ´ãÂç≥‰∏äÊ∂® 50%ÔºåROAS ‰∏ãË∑å", cause: "TikTok/Shopee Èôç‰Ωé‰∫ÜÈîÄÂîÆÂ∏ñÂ≠êÁöÑÊõùÂÖâÁéá (Reach)", strategy: "ÂàÜÊï£È£éÈô©Ëá≥Â§ö‰∏™Âπ≥Âè∞ÔºåÂπ∂‰∏ìÊ≥®‰∫éÂà∂‰ΩúÊõ¥Â§öÂéüÁîüÂÜÖÂÆπ (Â®±‰πê‰ºòÂÖà)" }
                }
            },
            negative_viral: {
                category: 1,
                label: { th: "‡∏î‡∏£‡∏≤‡∏°‡πà‡∏≤‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏• (Viral Drama)", cn: "Á§æ‰∫§Â™í‰ΩìÂç±Êú∫" },
                apply: (d) => ({ ...d, targetBags: d.targetBags * 0.6, varParams: { ...d.varParams, returnRate: 10 } }),
                math_desc: { th: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ -40%, ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á = 10%", cn: "ÈîÄÂîÆÈ¢ù -40%, ÈÄÄË¥ßÁéá = 10%" },
                analysis: {
                    th: { impact: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏´‡∏≤‡∏¢ 40%, ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏´‡πà‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á", cause: "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏¢‡πà‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πà‡∏≤‡∏ß", strategy: "‡πÅ‡∏ñ‡∏•‡∏á‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏ó‡∏±‡∏ô‡∏ó‡∏µ, ‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏° 100% ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á QC ‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" },
                    cn: { impact: "ÈîÄÂîÆÈ¢ùÊçüÂ§± 40%ÔºåÂÆ¢Êà∑Â§ßÈáèÈÄÄË¥ß", cause: "‰∫ßÂìÅË¥®ÈáèÈóÆÈ¢òÊàñÂîÆÂêéÊúçÂä°Á≥üÁ≥ïÂØºËá¥Ë¥üÈù¢Êñ∞Èóª", strategy: "Á´ãÂç≥ÂèëË°®ÈÅìÊ≠âÂ£∞ÊòéÔºåÊó†Êù°‰ª∂ 100% ÁêÜËµîÔºåÂπ∂Â∞ΩÂø´ÊîπËøõ QC" }
                }
            },
            drought: {
                category: 2,
                label: { th: "‡∏†‡∏±‡∏¢‡πÅ‡∏•‡πâ‡∏á‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á (Drought)", cn: "‰∏•ÈáçÂπ≤Êó±" },
                apply: (d) => ({ ...d, paddyPrice: d.paddyPrice * 1.25 }),
                math_desc: { th: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å +25%", cn: "Á®ªË∞∑ÊàêÊú¨ +25%" },
                analysis: {
                    th: { impact: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏û‡∏∏‡πà‡∏á 25%, ‡∏Å‡∏≥‡πÑ‡∏£‡∏ö‡∏≤‡∏á‡πÄ‡∏â‡∏µ‡∏¢‡∏ö", cause: "‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏î‡∏•‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®", strategy: "‡∏•‡πá‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (Futures) ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡πÑ‡∏î‡πâ)" },
                    cn: { impact: "ÂéüÊùêÊñôÊàêÊú¨È£ôÂçá 25%ÔºåÂà©Ê∂¶ÂæÆËñÑ", cause: "Áî±‰∫éÂ§©Ê∞îÂéüÂõ†Á®ªË∞∑‰∫ßÈáè‰∏ãÈôç", strategy: "ÈîÅÂÆöËøúÊúüË¥≠‰π∞‰ª∑Ê†º (Futures) ÊàñÊèêÈ´òÁªàÁ´Ø‰∫ßÂìÅÂîÆ‰ª∑ (Â¶ÇÊûúÂèØËÉΩ)" }
                }
            },
            machine_break: {
                category: 2,
                label: { th: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏±‡∏á (Machine Break)", cn: "Êú∫Âô®ÊïÖÈöú" },
                apply: (d) => ({ ...d, yield: d.yield * 0.95, fixedParams: { ...d.fixedParams, other: d.fixedParams.other + 50000 } }),
                math_desc: { th: "Yield -5%, ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏° +50,000", cn: "Âá∫Á±≥Áéá -5%, Áª¥‰øÆË¥π +50,000" },
                analysis: {
                    th: { impact: "Yield ‡∏ï‡∏Å 5%, ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô", cause: "‡∏Ç‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö (Preventive Maintenance)", strategy: "‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏™‡∏≥‡∏£‡∏≠‡∏á (Spare Parts) ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÑ‡∏ß‡πâ‡πÄ‡∏™‡∏°‡∏≠" },
                    cn: { impact: "‰∫ßÈáè‰∏ãÈôç 5%Ôºå‰∫ßÁîüÁ¥ßÊÄ•Áª¥‰øÆË¥π", cause: "Áº∫‰πèÂÆöÊúüÈ¢ÑÈò≤ÊÄßÁª¥Êä§ (Preventive Maintenance)", strategy: "Âà∂ÂÆöÊèêÂâçÁª¥Êä§ËÆ°ÂàíÔºåÂπ∂ÂßãÁªàÂáÜÂ§áÂÖ≥ÈîÆÂ§á‰ª∂ (Spare Parts)" }
                }
            },
            pack_cost: {
                category: 2,
                label: { th: "‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ç‡∏∂‡πâ‡∏ô (Pack Cost)", cn: "ÂåÖË£ÖÊàêÊú¨‰∏äÊ∂®" },
                apply: (d) => ({ ...d, unit: { bag: d.unit.bag * 1.5, sticker: d.unit.sticker * 1.5 } }),
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡∏ñ‡∏∏‡∏á/‡∏Å‡∏•‡πà‡∏≠‡∏á +50%", cn: "ÂåÖË£ÖË¢ã/Ë¥¥Á∫∏ÊàêÊú¨ +50%" },
                analysis: {
                    th: { impact: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å", cause: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÇ‡∏•‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤", strategy: "‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å (Mass Lot) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏™‡πÄ‡∏õ‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡∏ñ‡∏∏‡∏á‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢" },
                    cn: { impact: "ÊØèË¢ãÊàêÊú¨Â§ßÂπÖ‰∏äÂçá", cause: "ÂÖ®ÁêÉÊ≤π‰ª∑‰∏äÊ∂®ÊàñÂ°ëÊñôÂéÇÊèê‰ª∑", strategy: "Â§ßÈáèËÆ¢Ë¥≠ (Mass Lot) ‰ª•ËÆÆ‰ª∑ÔºåÊàñÁ®çÂæÆÈôç‰ΩéË¢ãÂ≠êÂéöÂ∫¶ËßÑÊ†º" }
                }
            },
            energy_crisis: {
                category: 2,
                label: { th: "‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (Energy Crisis)", cn: "ËÉΩÊ∫êÂç±Êú∫" },
                apply: (d) => ({ ...d, varParams: { ...d.varParams, elecRate: d.varParams.elecRate * 1.4 }, logistics: { ...d.logistics, profit: d.logistics.profit * 0.5 } }),
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü +40%, ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á -50%", cn: "ÁîµË¥π +40%, ËøêËæìÂà©Ê∂¶ -50%" },
                analysis: {
                    th: { impact: "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏û‡∏∏‡πà‡∏á 40%, ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏´‡∏≤‡∏¢‡∏Ñ‡∏£‡∏∂‡πà‡∏á", cause: "‡∏Ñ‡πà‡∏≤ Ft ‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤‡∏î‡∏µ‡πÄ‡∏ã‡∏•", strategy: "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Solar Rooftop ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏ö‡∏ß‡∏¥‡πà‡∏á‡∏£‡∏ñ‡∏Ç‡∏ô‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡πâ‡∏°‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" },
                    cn: { impact: "ÁîµË¥πÈ£ôÂçá 40%ÔºåËøêËæìÂà©Ê∂¶ÂáèÂçä", cause: "Ft Ë¥πÁî®‰∏äÊ∂®ÂíåÊü¥Ê≤π‰ª∑Ê†ºË∞ÉÊï¥", strategy: "ÂÆâË£ÖÂ±ãÈ°∂Â§™Èò≥ËÉΩ‰ª•ÈïøÊúüÈôç‰ΩéÁîµË¥πÔºåÂπ∂‰ºòÂåñËøêËæìËΩ¶Ê¨°‰ª•ÂÆûÁé∞ÊúÄÂ§ßÊïàÁõä" }
                }
            },
            rate_hike: {
                category: 3,
                label: { th: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏Ç‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô (Rate Hike)", cn: "Âä†ÊÅØ" },
                apply: (d) => ({ ...d, loan: { ...d.loan, rate: 9 } }),
                math_desc: { th: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 9%", cn: "Ë¥∑Ê¨æÂà©ÁéáË∞ÉËá≥ 9%" },
                analysis: {
                    th: { impact: "‡∏†‡∏≤‡∏£‡∏∞‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ï‡∏±‡∏ß", cause: "‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢", strategy: "‡∏£‡∏µ‡πÑ‡∏ü‡πÅ‡∏ô‡∏ô‡∏ã‡πå (Refinance) ‡∏´‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡πà‡∏á‡πÇ‡∏õ‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏†‡∏≤‡∏£‡∏∞‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢" },
                    cn: { impact: "Âà©ÊÅØË¥üÊãÖÂá†‰πéÁøªÂÄç", cause: "Â§ÆË°å‰∏äË∞ÉÊîøÁ≠ñÂà©Áéá", strategy: "ÂÜçËûçËµÑ (Refinance) ÂØªÊâæÂõ∫ÂÆöÂà©ÁéáÔºåÊàñÂä†ÈÄüÂÅøËøòÊú¨Èáë‰ª•ÂáèÂ∞ëÂà©ÊÅØË¥üÊãÖ" }
                }
            },
            credit_crunch: {
                category: 3,
                label: { th: "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏ä‡πâ‡∏≤ (Credit Crunch)", cn: "‰ø°Ë¥∑Á¥ßÁº©" },
                apply: (d) => ({ ...d, creditTerm: 60 }),
                math_desc: { th: "‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÄ‡∏ó‡∏≠‡∏° = 60 ‡∏ß‡∏±‡∏ô", cn: "‰ø°Áî®Êúü = 60 Â§©" },
                analysis: {
                    th: { impact: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ç‡∏≤‡∏î‡∏°‡∏∑‡∏≠‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô 2 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô", cause: "‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÑ‡∏°‡πà‡∏î‡∏µ ‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏î‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á", strategy: "‡πÉ‡∏´‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (Cash Discount) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏£‡πá‡∏ß ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏Ç‡∏∂‡πâ‡∏ô" },
                    cn: { impact: "Áé∞ÈáëÊµÅÁº∫Âè£Ëææ 2 ‰∏™Êúà", cause: "ÁªèÊµé‰∏çÊôØÊ∞îÔºåÂêà‰Ωú‰ºô‰º¥Áº∫‰πèÊµÅÂä®ÊÄß", strategy: "‰∏∫Âø´ÈÄü‰ªòÊ¨æËÄÖÊèê‰æõÁé∞ÈáëÊäòÊâ£ (Cash Discount)ÔºåÂπ∂Êõ¥‰∏•Ê†ºÂú∞Á≠õÈÄâÂÆ¢Êà∑‰ø°Áî®" }
                }
            },
            tax_fine: {
                category: 3,
                label: { th: "‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ (Tax Fine)", cn: "Á®éÂä°ÁΩöÊ¨æ" },
                apply: (d) => ({ ...d, fixedParams: { ...d.fixedParams, other: d.fixedParams.other + 100000 } }),
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô‡πÜ +100,000", cn: "ÂÖ∂‰ªñË¥πÁî® +100,000" },
                analysis: {
                    th: { impact: "‡πÇ‡∏î‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö 100,000 ‡∏ö‡∏≤‡∏ó ‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ", cause: "‡∏¢‡∏∑‡πà‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö", strategy: "‡∏à‡πâ‡∏≤‡∏á‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (ERP) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î Human Error" },
                    cn: { impact: "Ë¢´ÁΩöÊ¨æ 100,000 Ê≥∞Èì¢ÔºåÂΩ±ÂìçÊú¨ÊúàÂà©Ê∂¶", cause: "Êä•Á®éÈîôËØØÊàñÊñá‰ª∂‰∏çÂÖ®", strategy: "ËÅòËØ∑‰∏ì‰∏ö‰ºöËÆ°Â∏à‰∫ãÂä°ÊâÄÔºåÂπ∂‰ΩøÁî®‰ºöËÆ°ËΩØ‰ª∂ (ERP) ‰ª•ÂáèÂ∞ë‰∫∫‰∏∫ÈîôËØØ" }
                }
            },
            inflation: {
                category: 3,
                label: { th: "‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠‡∏û‡∏∏‡πà‡∏á (Inflation)", cn: "ÈÄöË¥ßËÜ®ËÉÄ" },
                apply: (d) => {
                     const newHr = d.hr.map(h => ({ ...h, salary: h.salary * 1.1 }));
                     return { ...d, hr: newHr, paddyPrice: d.paddyPrice * 1.1, unit: { bag: d.unit.bag * 1.1, sticker: d.unit.sticker * 1.1 } };
                },
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á/‡∏Ç‡πâ‡∏≤‡∏ß/‡∏ñ‡∏∏‡∏á +10%", cn: "Â∑•ËµÑ/Â§ßÁ±≥/ÂåÖË£Ö +10%" },
                analysis: {
                    th: { impact: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô 10% ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô", cause: "‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡∏°‡∏´‡∏†‡∏≤‡∏Ñ", strategy: "‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Reprice) ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Shrinkflation) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Å‡∏≥‡πÑ‡∏£" },
                    cn: { impact: "ÊâÄÊúâÊàêÊú¨ÂêåÊó∂‰∏äÊ∂® 10%", cause: "ÂÆèËßÇÁªèÊµéÁä∂ÂÜµ", strategy: "ÂøÖÈ°ªÊèê‰ª∑ (Reprice) ÊàñÁº©Â∞èÂïÜÂìÅÂ∞∫ÂØ∏ (Shrinkflation) ‰ª•‰øùÊåÅÂà©Ê∂¶" }
                }
            },
            staff_turnover: {
                category: 4,
                label: { th: "‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏•‡∏≤‡∏≠‡∏≠‡∏Å (Staff Turnover)", cn: "ÂëòÂ∑•ÊµÅÂ§±" },
                apply: (d) => {
                     const newHr = d.hr.map(h => ({ ...h, salary: h.salary * 1.1 })); 
                     return { ...d, hr: newHr, targetBags: d.targetBags * 0.9, fixedParams: { ...d.fixedParams, other: d.fixedParams.other + 20000 } };
                },
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á +10%, ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ -10%, ‡∏Ñ‡πà‡∏≤‡∏´‡∏≤‡∏Ñ‡∏ô +20,000", cn: "Â∑•ËµÑ +10%, ÈîÄÂîÆ -10%, ÊãõËÅòË¥π +20,000" },
                analysis: {
                    th: { impact: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏Å 10%, ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡πÅ‡∏û‡∏á‡∏Ç‡∏∂‡πâ‡∏ô", cause: "‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏´‡∏°‡∏î‡πÑ‡∏ü ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏î‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏ï‡∏±‡∏ß", strategy: "‡∏™‡∏£‡πâ‡∏≤‡∏á Career Path ‡πÉ‡∏´‡πâ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ Incentive ‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô (Performance-based)" },
                    cn: { impact: "ÈîÄÂîÆÈ¢ù‰∏ãÈôç 10%ÔºåÂ∑•ËµÑÊàêÊú¨‰∏äÂçá", cause: "ÂëòÂ∑•ÂÄ¶ÊÄ†ÊàñË¢´ÊåñËßí", strategy: "‰∏∫ÂëòÂ∑•Âª∫Á´ãËÅå‰∏öÂèëÂ±ïË∑ØÂæÑ (Career Path)ÔºåÂπ∂Êèê‰æõÂü∫‰∫éÁª©ÊïàÁöÑÊøÄÂä± (Incentive)" }
                }
            },
            fraud: {
                category: 4,
                label: { th: "‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï‡∏†‡∏≤‡∏¢‡πÉ‡∏ô (Fraud)", cn: "ÂÜÖÈÉ®Ê¨∫ËØà" },
                apply: (d) => ({ ...d, yield: d.yield * 0.9 }), 
                math_desc: { th: "Yield ‡∏´‡∏≤‡∏¢ 10% (Stock Loss)", cn: "Âá∫Á±≥Áéá -10% (Â∫ìÂ≠òÊçüÂ§±)" },
                analysis: {
                    th: { impact: "Yield ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ 10% (‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏≤‡∏¢)", cause: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏´‡∏•‡∏∞‡∏´‡∏•‡∏ß‡∏°", strategy: "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ß‡∏á‡∏à‡∏£‡∏õ‡∏¥‡∏î‡∏à‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥ Stock Count ‡∏ó‡∏∏‡∏Å‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏° (Surprise Check)" },
                    cn: { impact: "‰∫ßÈáèÊçüÂ§± 10% (Â§ßÁ±≥Â§±Ë∏™)", cause: "ÂÜÖÈÉ®ÊéßÂà∂Á≥ªÁªüÊùæÊáà", strategy: "Âú®Áß∞ÈáçÂ§ÑÂÆâË£ÖÈó≠Ë∑ØÁîµËßÜÔºåÂπ∂ÊØèÂë®ËøõË°åÈöèÊú∫Â∫ìÂ≠òÁõòÁÇπ (Surprise Check)" }
                }
            },
            warehouse_pest: {
                category: 4,
                label: { th: "‡∏°‡∏≠‡∏î/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô (Pest/Moisture)", cn: "Ëô´ÂÆ≥/ÊΩÆÊπø" },
                apply: (d) => ({ ...d, fixedParams: { ...d.fixedParams, other: d.fixedParams.other + 50000 }, yield: d.yield * 0.98 }),
                math_desc: { th: "Yield -2%, ‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ +50,000", cn: "Âá∫Á±≥Áéá -2%, Â§ÑÁêÜË¥π +50,000" },
                analysis: {
                    th: { impact: "‡πÄ‡∏™‡∏µ‡∏¢‡∏Ñ‡πà‡∏≤‡∏£‡∏°‡∏¢‡∏≤ 50k, ‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢", cause: "‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡πÇ‡∏Å‡∏î‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô", strategy: "‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏® ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏£‡∏∞‡∏ö‡∏ö FIFO (‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô) ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡πà‡∏á‡∏Ñ‡∏£‡∏±‡∏î" },
                    cn: { impact: "ÊçüÂ§± 5‰∏áÁÜèËí∏Ë¥πÔºåÂ§ßÁ±≥ÂèóÊçü", cause: "‰ªìÂ∫ìÂÇ®Â≠ò‰∏çËææÊ†á", strategy: "ÊîπÂñÑÈÄöÈ£éÁ≥ªÁªüÔºåÂπ∂‰∏•Ê†ºÊâßË°å FIFO (ÂÖàËøõÂÖàÂá∫) Á≥ªÁªü" }
                }
            },
            platform_ban: {
                category: 4,
                label: { th: "‡πÇ‡∏î‡∏ô‡πÅ‡∏ö‡∏ô‡∏£‡πâ‡∏≤‡∏ô (Platform Ban)", cn: "Âπ≥Âè∞Â∞ÅÂè∑" },
                apply: (d) => ({ ...d, targetBags: d.targetBags * 0.5 }),
                math_desc: { th: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ -50%", cn: "ÈîÄÂîÆÈ¢ù -50%" },
                analysis: {
                    th: { impact: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏´‡∏≤‡∏¢‡∏ß‡∏π‡∏ö 50% ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ", cause: "‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏Å‡∏é‡∏ä‡∏∏‡∏°‡∏ä‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏•‡∏ü‡πå‡∏ú‡∏¥‡∏î‡∏Å‡∏é", strategy: "‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÑ‡∏õ‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á (Omni-channel) ‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏£‡∏ô‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏é‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠" },
                    cn: { impact: "ÈîÄÂîÆÈ¢ùÁ´ãÂç≥Êö¥Ë∑å 50%", cause: "ËøùÂèçÁ§æÂå∫ÂáÜÂàôÊàñÁõ¥Êí≠ËøùËßÑ", strategy: "ÈÄöËøáÂÖ®Ê∏†ÈÅì (Omni-channel) ÂàÜÊï£Êî∂ÂÖ•ÔºåÂπ∂ÂÆöÊúüÂüπËÆ≠Âõ¢ÈòüÊúâÂÖ≥Ê≥ïËßÑ" }
                }
            }
        };

        // ... (INITIAL data remains the same) ...
        const INITIAL = {
            regCapital: 13000000,
            loan: { amount: 0, rate: 5, term: 5 },
            maxCapacity: 70000, 
            capex: { factory: 7000000, machine: 1300000, license: 200000, stock: 2000000 },
            depreciation: { factoryYears: 20, machineYears: 10 }, 
            targetBags: 15000, 
            price: 389,
            creditTerm: 0, 
            yield: 60, paddyPrice: 16000,
            byProducts: [
                { id: "prod_husk", name: "‡πÅ‡∏Å‡∏•‡∏ö", percent: 23, price: 1500 },
                { id: "prod_fine", name: "‡∏£‡∏≥‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î", percent: 10, price: 9000 },
                { id: "prod_rough", name: "‡∏£‡∏≥‡∏´‡∏¢‡∏≤‡∏ö", percent: 2, price: 9000 },
                { id: "prod_broken", name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏±‡∏Å", percent: 2, price: 12000 },
                { id: "prod_waste", name: "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢", percent: 1, price: 0 },
            ],
            unit: { bag: 10.0, sticker: 13.0 },
            hr: [
                { role: "CEO/MD", count: 1, salary: 30000 },
                { role: "Plant Manager", count: 1, salary: 30000 },
                { role: "Production Staff", count: 5, salary: 14000 },
                { role: "Admin/Account", count: 1, salary: 14000 },
                { role: "Sales/Marketing", count: 2, salary: 14000 }
            ],
            varParams: { elecRate: 550, mktPercent: 15, platformPercent: 12, returnRate: 0.5 },
            cpmVolatilityModel: 'normal', // 'normal', 'high', 'extreme'
            fixedParams: { erp: 9000, campaign: 41000, other: 10000, maintPercent: 2, insurance: 60000, audit: 5000, travel: 10000 },
            campaignDetails: [
                { id: "camp_gold1", name: "‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á 1 ‡∏™‡∏•‡∏∂‡∏á", qty: 1, costPerUnit: 16500 },
                { id: "camp_gold2", name: "‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á ‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏™‡∏•‡∏∂‡∏á", qty: 2, costPerUnit: 8500 },
                { id: "camp_free", name: "‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏ü‡∏£‡∏µ 1 ‡∏õ‡∏µ", qty: 3, costPerUnit: 2500 }
            ],
            logistics: { active: true, percent: 100, profit: 3 },
            dividend: { payout: 50, founders: 3 },
            growth: 10, inflation: 3, monthlyGrowth: 0, discountRate: 10,
            vatRate: 7, // VAT rate in percentage (default 7%)
            mktFunnel: { basketSize: 1.0, cvr: 2.0, ctr: 1.5 },
            scenario: 'base', taxPaymentMode: 'annual',
            clvParams: { freq: 4, retention: 60 },
            // Channel Mix with sub-channels for detailed planning
            channelMix: {
                b2c: {
                    tiktokShop: {
                        ads: 40,      // ‡∏Ç‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤
                        organic: 20,  // ‡∏≠‡∏≠‡πÅ‡∏Å‡∏ô‡∏¥‡∏Ñ
                        live: 10,     // ‡πÑ‡∏•‡∏ü‡πå‡∏™‡∏î
                        affiliate: 10 // Affiliate
                    },
                    lineShop: {
                        member: 5,    // ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ã‡∏∑‡πâ‡∏≠
                        normal: 5     // ‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥
                    }
                },
                b2b: {
                    hotel: 5,         // ‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°
                    export: 3,        // ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å
                    modernTrade: 2    // ‡πÇ‡∏°‡πÄ‡∏î‡∏¥‡∏£‡πå‡∏ô‡πÄ‡∏ó‡∏£‡∏î
                }
            },
            channelFees: {
                b2c: {
                    tiktokShop: { ads: 12, organic: 12, live: 12, affiliate: 15 },
                    lineShop: { member: 5, normal: 8 }
                },
                b2b: {
                    hotel: 0, export: 0, modernTrade: 3
                }
            },
            channelMktPercent: {
                b2c: {
                    tiktokShop: { ads: 20, organic: 0, live: 5, affiliate: 0 },
                    lineShop: { member: 0, normal: 3 }
                },
                b2b: {
                    hotel: 0, export: 0, modernTrade: 0
                }
            },
            // Legacy support (for backward compatibility)
            channelMixLegacy: { tiktok: 80, shopee: 10, offline: 10 },
            channelFeesLegacy: { tiktok: 12, shopee: 8, offline: 0 },
            elasticityParams: { coefficient: 1.5 }, 
            seasonalShock: { active: false, startM: 5, endM: 8, costImpact: 20 },
            stockMonths: 2, // New: Default stock policy (2 months buffer)
            // Scaling parameters for 1000M growth planning
            capexStepUp: {
                enabled: false,
                thresholdBags: 30000, // Trigger expansion at this volume
                factoryExpansion: 5000000, // Additional factory cost
                machineExpansion: 2000000, // Additional machines
                capacityIncrease: 50000 // New max capacity after expansion
            },
            workingCapital: {
                arDays: 0, // Accounts Receivable (customer payment terms)
                apDays: 30, // Accounts Payable (supplier payment terms)
                inventoryDays: 60 // Inventory holding period (matches stockMonths * 30)
            },
            channelBreakdown: {
                enabled: true // Enable multi-channel P&L
            }
        };

        const App = () => {
            const [toast, setToast] = useState(null); 
            const [lang, setLang] = useState('th'); 
            const [activeSim, setActiveSim] = useState(null); 
            const [backupD, setBackupD] = useState(null);
            const [tooltip, setTooltip] = useState(null); // {metric: string, x: number, y: number}
            
            const handleTooltip = (e, metric) => {
                e.preventDefault();
                e.stopPropagation();
                const rect = e.currentTarget.getBoundingClientRect();
                const x = rect.left + rect.width / 2;
                const y = rect.top - 10;
                console.log('Tooltip triggered:', { metric, x, y, c: !!c });
                setTooltip({
                    metric,
                    x: x,
                    y: y
                });
            };
            
            const hideTooltip = () => {
                setTooltip(null);
            }; 

            // t function inside App
            const t = (key) => {
                if (!TRANS[lang]) return key;
                return TRANS[lang][key] || key;
            };

            // Deep merge function to ensure all fields from INITIAL are present
            const deepMergeDefaults = (saved, defaults) => {
                if (!saved || typeof saved !== 'object') return defaults;
                if (Array.isArray(saved)) return saved; // Arrays are replaced, not merged
                
                const result = { ...defaults };
                for (const key in saved) {
                    if (saved.hasOwnProperty(key)) {
                        if (saved[key] !== null && typeof saved[key] === 'object' && !Array.isArray(saved[key]) && 
                            defaults[key] !== null && typeof defaults[key] === 'object' && !Array.isArray(defaults[key])) {
                            // Deep merge nested objects
                            result[key] = deepMergeDefaults(saved[key], defaults[key] || {});
                        } else {
                            // Use saved value if exists (including arrays and primitives)
                            result[key] = saved[key];
                        }
                    }
                }
                return result;
            };

            const [d, setD] = useState(() => {
                try {
                    const params = new URLSearchParams(window.location.search);
                    const sharedData = params.get('data');
                    if (sharedData) {
                        const safeBase64 = sharedData.replace(/ /g, '+');
                        const parsed = JSON.parse(fromBase64(safeBase64));
                        if (!parsed.campaignDetails) parsed.campaignDetails = INITIAL.campaignDetails;
                        if (parsed.fixedParams && parsed.fixedParams.insurance === undefined) {
                            parsed.fixedParams.insurance = 60000;
                        }
                        if (parsed.fixedParams && parsed.fixedParams.audit === undefined) parsed.fixedParams.audit = 5000;
                        if (parsed.fixedParams && parsed.fixedParams.travel === undefined) parsed.fixedParams.travel = 10000;

                        if (!parsed.clvParams) parsed.clvParams = INITIAL.clvParams;
                        if (parsed.vatRate === undefined) parsed.vatRate = INITIAL.vatRate;
                        if (!parsed.channelMix) parsed.channelMix = INITIAL.channelMix;
                        if (!parsed.channelFees) parsed.channelFees = INITIAL.channelFees;
                        if (!parsed.channelMktPercent) parsed.channelMktPercent = INITIAL.channelMktPercent;
                        // Migrate legacy channelMix to new structure if needed
                        if (parsed.channelMix && !parsed.channelMix.b2c && !parsed.channelMix.b2b && parsed.channelMix.tiktok !== undefined) {
                            // Legacy structure detected, migrate
                            const legacy = parsed.channelMix;
                            parsed.channelMix = {
                                b2c: {
                                    tiktokShop: { ads: legacy.tiktok * 0.5, organic: legacy.tiktok * 0.3, live: legacy.tiktok * 0.15, affiliate: legacy.tiktok * 0.05 },
                                    lineShop: { member: legacy.shopee * 0.3, normal: legacy.shopee * 0.7 }
                                },
                                b2b: { hotel: legacy.offline * 0.5, export: legacy.offline * 0.3, modernTrade: legacy.offline * 0.2 }
                            };
                            const legacyFees = parsed.channelFees || {};
                            parsed.channelFees = {
                                b2c: {
                                    tiktokShop: { ads: legacyFees.tiktok || 12, organic: legacyFees.tiktok || 12, live: legacyFees.tiktok || 12, affiliate: 15 },
                                    lineShop: { member: 5, normal: legacyFees.shopee || 8 }
                                },
                                b2b: { hotel: 0, export: 0, modernTrade: 3 }
                            };
                            parsed.channelMktPercent = {
                                b2c: {
                                    tiktokShop: { ads: 20, organic: 0, live: 5, affiliate: 0 },
                                    lineShop: { member: 0, normal: 3 }
                                },
                                b2b: { hotel: 0, export: 0, modernTrade: 0 }
                            };
                        }
                        if (!parsed.elasticityParams) parsed.elasticityParams = INITIAL.elasticityParams;
                        if (!parsed.seasonalShock) parsed.seasonalShock = INITIAL.seasonalShock;
                        if (!parsed.maxCapacity) parsed.maxCapacity = INITIAL.maxCapacity; 
                        if (parsed.stockMonths === undefined) parsed.stockMonths = 2; // Default for old data
                        // Migration: Add cpmVolatilityModel if missing (new feature)
                        if (parsed.cpmVolatilityModel === undefined) parsed.cpmVolatilityModel = INITIAL.cpmVolatilityModel || 'normal';
                        
                        // Deep merge with INITIAL to ensure all new fields are present
                        const migratedData = deepMergeDefaults(parsed, INITIAL);
                        if (migratedData.cpmVolatilityModel === undefined) migratedData.cpmVolatilityModel = 'normal';
                        return migratedData;
                    }

                    const savedData = localStorage.getItem('morbSukFinancialData_v43'); 
                    let parsed = savedData ? JSON.parse(savedData) : INITIAL;
                    
                    // ===== DATA MIGRATION & VALIDATION =====
                    // Ensure all required fields exist, migrate old data to new structure
                    if (!parsed.campaignDetails) parsed.campaignDetails = INITIAL.campaignDetails;
                    if (parsed.vatRate === undefined) parsed.vatRate = INITIAL.vatRate;
                    if (parsed.fixedParams && parsed.fixedParams.insurance === undefined) {
                        parsed.fixedParams.insurance = 60000;
                    }
                    if (parsed.fixedParams && parsed.fixedParams.audit === undefined) parsed.fixedParams.audit = 5000;
                    if (parsed.fixedParams && parsed.fixedParams.travel === undefined) parsed.fixedParams.travel = 10000;

                    if (!parsed.clvParams) parsed.clvParams = INITIAL.clvParams;
                    if (!parsed.channelMix) parsed.channelMix = INITIAL.channelMix;
                    if (!parsed.channelFees) parsed.channelFees = INITIAL.channelFees;
                    if (!parsed.channelMktPercent) parsed.channelMktPercent = INITIAL.channelMktPercent;
                    
                    // Migration: Add cpmVolatilityModel if missing (new feature added)
                    if (parsed.cpmVolatilityModel === undefined) parsed.cpmVolatilityModel = INITIAL.cpmVolatilityModel || 'normal';
                    // Migrate legacy channelMix to new structure if needed
                    if (parsed.channelMix && !parsed.channelMix.b2c && !parsed.channelMix.b2b && parsed.channelMix.tiktok !== undefined) {
                        // Legacy structure detected, migrate
                        const legacy = parsed.channelMix;
                        parsed.channelMix = {
                            b2c: {
                                tiktokShop: { ads: legacy.tiktok * 0.5, organic: legacy.tiktok * 0.3, live: legacy.tiktok * 0.15, affiliate: legacy.tiktok * 0.05 },
                                lineShop: { member: legacy.shopee * 0.3, normal: legacy.shopee * 0.7 }
                            },
                            b2b: { hotel: legacy.offline * 0.5, export: legacy.offline * 0.3, modernTrade: legacy.offline * 0.2 }
                        };
                        const legacyFees = parsed.channelFees || {};
                        parsed.channelFees = {
                            b2c: {
                                tiktokShop: { ads: legacyFees.tiktok || 12, organic: legacyFees.tiktok || 12, live: legacyFees.tiktok || 12, affiliate: 15 },
                                lineShop: { member: 5, normal: legacyFees.shopee || 8 }
                            },
                            b2b: { hotel: 0, export: 0, modernTrade: 3 }
                        };
                        parsed.channelMktPercent = {
                            b2c: {
                                tiktokShop: { ads: 20, organic: 0, live: 5, affiliate: 0 },
                                lineShop: { member: 0, normal: 3 }
                            },
                            b2b: { hotel: 0, export: 0, modernTrade: 0 }
                        };
                    }
                    if (!parsed.elasticityParams) parsed.elasticityParams = INITIAL.elasticityParams;
                    if (!parsed.seasonalShock) parsed.seasonalShock = INITIAL.seasonalShock;
                    if (!parsed.maxCapacity) parsed.maxCapacity = INITIAL.maxCapacity; 
                    if (parsed.stockMonths === undefined) parsed.stockMonths = 2;
                    // Migration: Add cpmVolatilityModel if missing (new feature)
                    if (parsed.cpmVolatilityModel === undefined) parsed.cpmVolatilityModel = INITIAL.cpmVolatilityModel || 'normal';
                    
                    parsed.byProducts = parsed.byProducts.map((p, i) => (!p.id ? { ...p, id: INITIAL.byProducts[i]?.id } : p));
                    parsed.campaignDetails = parsed.campaignDetails.map((c, i) => (!c.id ? { ...c, id: INITIAL.campaignDetails[i]?.id } : c));

                    // Deep merge with INITIAL to ensure all new fields are present
                    const migratedData = deepMergeDefaults(parsed, INITIAL);
                    // Re-apply critical migrations after merge
                    if (migratedData.cpmVolatilityModel === undefined) migratedData.cpmVolatilityModel = 'normal';
                    
                    return migratedData;
                } catch (e) { 
                    console.error("Data load error:", e);
                    return INITIAL; 
                }
            });
            const [c, setC] = useState(null); 

            useEffect(() => { 
                // Ensure all required fields are present before saving
                // Deep merge with INITIAL to ensure new fields are included
                const dataToSave = deepMergeDefaults(d, INITIAL);
                // Ensure critical new fields are explicitly set
                if (!dataToSave.cpmVolatilityModel) dataToSave.cpmVolatilityModel = 'normal';
                localStorage.setItem('morbSukFinancialData_v43', JSON.stringify(dataToSave)); 
            }, [d]);

            const resetToDefault = () => {
                if (confirm("Reset all data to default?")) { 
                    setD(INITIAL); 
                    setActiveSim(null);
                    setBackupD(null);
                    localStorage.removeItem('morbSukFinancialData_v43'); 
                    window.history.pushState({}, document.title, window.location.pathname);
                }
            };

            const handleSimulate = (key) => {
                if (activeSim === key) {
                    if (backupD) {
                        setD(backupD); 
                        setBackupD(null);
                    } else {
                        applyScenario('base'); 
                    }
                    setActiveSim(null);
                } else {
                    let baseState;
                    if (activeSim && backupD) {
                        baseState = backupD;
                    } else {
                        baseState = JSON.parse(JSON.stringify(d)); 
                        setBackupD(baseState);
                    }
                    const newD = SCENARIOS[key].apply(baseState);
                    setD(newD);
                    setActiveSim(key);
                    setToast(`Activated: ${SCENARIOS[key].label[lang]}`);
                    setTimeout(() => setToast(null), 3000);
                }
            };

            const handleShare = () => {
                try {
                    const jsonString = JSON.stringify(d);
                    const encoded = toBase64(jsonString);
                    const url = `${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(encoded)}`;
                    const textArea = document.createElement("textarea");
                    textArea.value = url;
                    textArea.style.position = "fixed";
                    textArea.style.left = "-9999px";
                    textArea.style.top = "0";
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    try {
                        const successful = document.execCommand('copy');
                        if (successful) {
                            setToast("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß! ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (Copied!)");
                            setTimeout(() => setToast(null), 3000);
                            window.history.pushState({}, document.title, `?data=${encodeURIComponent(encoded)}`);
                        } else {
                            prompt("Copy this link:", url);
                        }
                    } catch (err) {
                        console.error('Fallback: Oops, unable to copy', err);
                        prompt("Copy this link:", url);
                    }
                    document.body.removeChild(textArea);
                } catch (e) {
                    console.error(e);
                    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå");
                }
            };

            const handlePrint = () => window.print();
            
            const handleExport = () => {
                if(!c) return;
                let csvContent = "data:text/csv;charset=utf-8,";
                csvContent += "Year,Revenue,Expenses,EBITDA,Depreciation,Tax,Net Profit,Dividend,Cash Balance\n";
                c.yrProj.data.forEach(row => {
                    csvContent += `${row.y},${row.rev},${row.exp},${row.ebitda},${row.dep},${row.tax},${row.net},${row.div},${row.cash}\n`;
                });
                csvContent += "\nMonthly Year 1\nMonth,Cash Inflow (Rev),Expense(Cash),EBITDA,Tax Paid,Cash Balance\n";
                c.cf.forEach(row => {
                    csvContent += `${row.m},${row.revCashIn},${row.expCash},${row.netOpCash},${row.tax},${row.cashFinal}\n`;
                });
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "financial_projection_pro.csv");
                document.body.appendChild(link);
                link.click();
            };

            const applyScenario = (type) => {
                let newData = { ...d, scenario: type };
                if (type === 'worst') { 
                    newData.targetBags = 8000; 
                    newData.paddyPrice = 18000; 
                    newData.growth = 0; 
                    newData.varParams.mktPercent = 20; 
                } 
                else if (type === 'base') { 
                    newData.targetBags = 15000; 
                    newData.paddyPrice = 16000; 
                    newData.growth = 10; 
                    newData.varParams.mktPercent = 15; 
                } 
                else if (type === 'best') { 
                    newData.targetBags = 20000; 
                    newData.paddyPrice = 15000; 
                    newData.growth = 15; 
                    newData.varParams.mktPercent = 13; 
                }
                setD(newData);
                setActiveSim(null); 
                setBackupD(null);
            };

            const up = (k, sk, v) => setD(p => ({...p, [k]: sk ? {...p[k], [sk]: +v} : +v}));
            const upStr = (k, v) => setD(p => ({...p, [k]: v})); // For string values
            const upArr = (k, i, f, v) => {
                const n = [...d[k]]; 
                if (f === 'name') delete n[i].id;
                n[i][f] = f==='name'||f==='role'?v:+v; 
                setD(p=>({...p, [k]: n}));
            };
            const upFunnel = (k, v) => setD(p => ({...p, mktFunnel: {...p.mktFunnel, [k]: +v}}));

            const upCampaign = (idx, field, val) => {
                setD(prev => {
                    const newDetails = [...prev.campaignDetails];
                    if (field === 'name') delete newDetails[idx].id;
                    newDetails[idx][field] = field === 'name' ? val : +val;
                    const newTotal = newDetails.reduce((sum, item) => sum + (item.qty * item.costPerUnit), 0);
                    return {
                        ...prev,
                        campaignDetails: newDetails,
                        fixedParams: { ...prev.fixedParams, campaign: newTotal }
                    };
                });
            };

            const upNew = (category, field, val) => {
                setD(prev => ({
                    ...prev,
                    [category]: { ...prev[category], [field]: +val }
                }));
            };
            
            // Helper for nested channel updates (category, subCategory, subChannel, nestedChannel, val)
            const upChannel = (category, subCategory, subChannel, nestedChannel, val) => {
                setD(prev => {
                    const newData = JSON.parse(JSON.stringify(prev)); // Deep clone
                    if (!newData[category]) newData[category] = {};
                    if (!newData[category][subCategory]) newData[category][subCategory] = {};
                    if (nestedChannel !== null && nestedChannel !== undefined) {
                        // Nested structure (e.g., channelMix.b2c.tiktokShop.ads)
                        if (!newData[category][subCategory][subChannel]) newData[category][subCategory][subChannel] = {};
                        newData[category][subCategory][subChannel][nestedChannel] = +val;
                    } else {
                        // Direct structure (e.g., channelMix.b2b.hotel)
                        newData[category][subCategory][subChannel] = +val;
                    }
                    return newData;
                });
            };

            const handleYieldChange = (e) => {
                const newYield = parseFloat(e.target.value);
                setD(prev => {
                    const currentByProdSum = prev.byProducts.reduce((sum, item) => sum + item.percent, 0);
                    const totalSolidMass = prev.yield + currentByProdSum; 
                    let newByProdTarget = totalSolidMass - newYield;
                    if (newByProdTarget < 0) newByProdTarget = 0; 
                    const ratio = currentByProdSum > 0 ? newByProdTarget / currentByProdSum : 0;
                    const newByProducts = prev.byProducts.map(item => ({
                        ...item,
                        percent: parseFloat((item.percent * ratio).toFixed(2))
                    }));
                    return { ...prev, yield: newYield, byProducts: newByProducts };
                });
            };

            // Calculate Financials - Defined INSIDE App component
            const calculateFinancials = (data) => {
                // Ensure t is available or use fallback
                const _t = (k) => TRANS[lang] ? (TRANS[lang][k] || k) : k;

                // Safety checks for required data
                if (!data || typeof data !== 'object') {
                    console.error("Invalid data passed to calculateFinancials");
                    return null;
                }

                const stockPolicyMonths = data.stockMonths !== undefined ? data.stockMonths : 2;

                const dayTarget = (data.targetBags || 0) / 30;
                const hourTarget = dayTarget / 24; 
                // ===== REVENUE CALCULATION (VAT-INCLUSIVE) =====
                // Revenue = Price per bag √ó Target bags (VAT-inclusive, as per Thai accounting standards)
                const riceRev = (data.targetBags || 0) * (data.price || 0);
                
                // ===== RAW MATERIAL COST CALCULATION =====
                // Paddy tons needed = (Bags √ó 5kg per bag) / Yield % / 1000 (convert to tons)
                // Example: 15,000 bags √ó 5kg = 75,000kg √∑ 60% yield = 125,000kg √∑ 1000 = 125 tons
                const paddyTons = ((data.targetBags || 0) * 5) / ((data.yield || 60)/100) / 1000;
                const paddyBudget = paddyTons * (data.paddyPrice || 0);
                
                // ===== BY-PRODUCT REVENUE =====
                // Calculate revenue from by-products (e.g., rice bran, broken rice)
                // Weight = Paddy tons √ó By-product percentage
                // Revenue = Weight √ó Price per ton
                let totalByProductIncome = 0;
                const byProductsCalc = (data.byProducts || []).map(item => {
                    const weight = paddyTons * ((item.percent || 0) / 100);
                    const revenue = weight * (item.price || 0);
                    totalByProductIncome += revenue;
                    return { ...item, weight, revenue };
                });

                // ===== LOGISTICS INCOME =====
                // Additional income from logistics services (if applicable)
                // Income = Bags √ó Logistics % √ó Profit per bag
                const logIncome = (data.targetBags || 0) * ((data.logistics?.percent || 0)/100) * (data.logistics?.profit || 0);

                // ===== RETURNS/REFUNDS HANDLING =====
                // Returns reduce gross sales (VAT-inclusive)
                // Accounting standard: Returns are treated as reduction of revenue
                const refundTotal = riceRev * ((data.varParams.returnRate || 0) / 100);

                // Net rice sales after returns (VAT-inclusive)
                const netRiceSales = riceRev - refundTotal;

                // ===== TOTAL REVENUE (BASE REVENUE) =====
                // Base revenue = Net rice sales + By-product income + Logistics income
                // This is VAT-inclusive revenue before VAT calculation
                const baseRev = netRiceSales + totalByProductIncome + logIncome; 
                
                // ===== VAT CALCULATION =====
                // VAT Rate: Configurable (default 7% for Thailand)
                // VAT Multiplier: 1 + (VAT Rate / 100) = 1.07 for 7% VAT
                // Output VAT = Total Revenue - (Total Revenue / VAT Multiplier)
                // Example: 1,000,000 - (1,000,000 / 1.07) = 1,000,000 - 934,579 = 65,421 (VAT)
                const vatRate = data.vatRate !== undefined ? data.vatRate : 7;
                const vatMultiplier = 1 + (vatRate / 100);
                const totalVatOut = baseRev - (baseRev / vatMultiplier);
                
                // Helper function: Convert VAT-inclusive amount to ex-VAT amount
                // Ex-VAT = VAT-inclusive / VAT Multiplier
                const exVat = (amt) => amt / vatMultiplier;

                // Channel Mix calculation - support both new sub-channel structure and legacy
                let blendedFeePct = 0;
                let blendedMktPct = 0; // Weighted average marketing % from channel mix
                let platformTotal = 0;
                let totalMarketingBudget = 0;
                let channelDetails = {};
                let platformPctFinal = 0; // Will be set based on structure used
                let totalMixPct = 0; // Total mix percentage for weighted average calculation
                
                if (data.channelMix?.b2c || data.channelMix?.b2b) {
                    // New sub-channel structure
                    const cm = data.channelMix;
                    const cFees = data.channelFees || {};
                    const cMkt = data.channelMktPercent || {};
                    // Don't redeclare totalMixPct - use the one declared at function level
                    
                    // Calculate blended fee and marketing from sub-channels
                    const processSubChannels = (category, subChannels, fees, mktPcts) => {
                        Object.entries(subChannels).forEach(([subKey, mixPct]) => {
                            if (typeof mixPct === 'object') {
                                // Nested sub-channels (e.g., tiktokShop: {ads: 40, organic: 20})
                                Object.entries(mixPct).forEach(([nestedKey, nestedPct]) => {
                                    const feePct = fees?.[subKey]?.[nestedKey] || 0;
                                    const mktPct = mktPcts?.[subKey]?.[nestedKey] || 0;
                                    const channelKey = `${category}_${subKey}_${nestedKey}`;
                                    channelDetails[channelKey] = {
                                        category, subChannel: subKey, nestedChannel: nestedKey,
                                        mixPct: nestedPct, feePct, mktPct
                                    };
                                    blendedFeePct += (nestedPct * feePct) / 100;
                                    blendedMktPct += (nestedPct * mktPct) / 100; // Weighted marketing %
                                    // Don't calculate Marketing cost here - will use weighted average (finalBlendedMktPct) later
                                    totalMixPct += nestedPct;
                                });
                            } else {
                                // Direct sub-channels (e.g., hotel: 5)
                                const feePct = fees?.[subKey] || 0;
                                const mktPct = mktPcts?.[subKey] || 0;
                                const channelKey = `${category}_${subKey}`;
                                channelDetails[channelKey] = {
                                    category, subChannel: subKey, nestedChannel: null,
                                    mixPct, feePct, mktPct
                                };
                                blendedFeePct += (mixPct * feePct) / 100;
                                blendedMktPct += (mixPct * mktPct) / 100; // Weighted marketing %
                                // Don't calculate Marketing cost here - will use weighted average (finalBlendedMktPct) later
                                totalMixPct += mixPct;
                            }
                        });
                    };
                    
                    if (cm.b2c) {
                        Object.entries(cm.b2c).forEach(([subKey, subChannels]) => {
                            processSubChannels('b2c', {[subKey]: subChannels}, cFees.b2c || {}, cMkt.b2c || {});
                        });
                    }
                    if (cm.b2b) {
                        processSubChannels('b2b', cm.b2b, cFees.b2b || {}, cMkt.b2b || {});
                    }
                    
                    platformTotal = netRiceSales * (blendedFeePct / 100);
                    // Set platformPct for use later in the function
                    platformPctFinal = blendedFeePct;
                } else {
                    // Legacy structure (backward compatibility)
                    const cm = data.channelMix || { tiktok: 80, shopee: 10, offline: 10 };
                    const cFees = data.channelFees || { tiktok: 12, shopee: 8, offline: 0 };
                    blendedFeePct = (cm.tiktok * cFees.tiktok + cm.shopee * cFees.shopee + cm.offline * cFees.offline) / 100;
                    const legacyPlatformPct = data.varParams?.platformPercent ?? 0;
                    platformPctFinal = (data.channelMix && data.channelFees) ? blendedFeePct : legacyPlatformPct;
                    platformTotal = netRiceSales * (platformPctFinal/100);
                    // Marketing % should be calculated from total revenue (baseRev), not just netRiceSales
                    // But for legacy compatibility, we calculate from netRiceSales and scale to baseRev
                    totalMarketingBudget = baseRev * (data.varParams.mktPercent/100);
                    // For legacy, use the input mktPercent as blended
                    blendedMktPct = data.varParams.mktPercent || 0;
                    totalMixPct = (cm.tiktok || 0) + (cm.shopee || 0) + (cm.offline || 0);
                }
                
                // Fallback if platformPctFinal is still 0
                if (platformPctFinal === 0) {
                    platformPctFinal = blendedFeePct || (data.varParams?.platformPercent || 0);
                }
                
                // ===== MARKETING BUDGET CALCULATION (WEIGHTED AVERAGE) =====
                // Calculate final blended marketing % (weighted average) - SAME LOGIC AS Summary section
                // blendedMktPct = Œ£((mixPct √ó mktPct) / 100) = weighted sum
                // finalBlendedMktPct = (blendedMktPct / totalMixPct) √ó 100 = weighted average percentage
                // Example: Channel A: 50% mix, 20% mkt ‚Üí weighted = 10
                //          Channel B: 30% mix, 10% mkt ‚Üí weighted = 3
                //          Channel C: 20% mix, 5% mkt ‚Üí weighted = 1
                //          Total weighted = 14, Total mix = 100
                //          Final blended = (14 / 100) √ó 100 = 14%
                const finalBlendedMktPct = (totalMixPct > 0 && blendedMktPct >= 0) 
                    ? ((blendedMktPct / totalMixPct) * 100)  // Weighted average: (weighted sum / total mix) √ó 100
                    : (data.varParams?.mktPercent || 0);
                
                // ===== MARKETING BUDGET ALLOCATION =====
                // IMPORTANT: Marketing % should be calculated from total revenue (baseRev), not just netRiceSales
                // This follows accounting standards: Marketing spend is % of total revenue (including by-products)
                // Always use weighted average from channel mix (finalBlendedMktPct) if available
                // Otherwise, use input Marketing % from Variable Cost Parameters
                if (data.channelMix?.b2c || data.channelMix?.b2b) {
                    // Using channel mix structure: ALWAYS use weighted average from channel mix (finalBlendedMktPct)
                    // This ensures Marketing cost = baseRev √ó weighted average Marketing % from Channel Mix Revenue
                    // Same logic as platformTotal = netRiceSales √ó (blendedFeePct / 100)
                    // Formula: Marketing Budget = Total Revenue √ó Weighted Average Marketing %
                    if (totalMixPct > 0 && finalBlendedMktPct >= 0) {
                        totalMarketingBudget = baseRev * (finalBlendedMktPct / 100);
                    } else {
                        // No channel mix data, fallback to input Marketing %
                        totalMarketingBudget = baseRev * ((data.varParams?.mktPercent || 0) / 100);
                    }
                } else {
                    // Legacy structure: use input Marketing %
                    if (data.varParams?.mktPercent !== undefined && data.varParams.mktPercent >= 0) {
                        totalMarketingBudget = baseRev * (data.varParams.mktPercent / 100);
                    } else if (totalMarketingBudget === 0) {
                        // Fallback if mktTotal not calculated
                        totalMarketingBudget = baseRev * ((data.varParams?.mktPercent || 0) / 100);
                    }
                } 

                const riceTotal = paddyBudget; 
                const packTotal = ((data.unit?.bag || 0) + (data.unit?.sticker || 0)) * (data.targetBags || 0); 
                const elecTotal = (data.varParams?.elecRate || 0) * paddyTons; 
                const mktTotal = totalMarketingBudget; // Use calculated from sub-channels or fallback to legacy 

                let baseSalaryTotal = 0;
                let ssoTotal = 0;
                const hrCosts = (data.hr || []).map(h => {
                    const ssoPerPerson = Math.floor(Math.min(h.salary || 0, 15000) * 0.05);
                    const totalPerRole = ((h.salary || 0) + ssoPerPerson) * (h.count || 0);
                    const ssoTotalRole = ssoPerPerson * (h.count || 0);
                    baseSalaryTotal += (h.salary || 0) * (h.count || 0);
                    ssoTotal += ssoTotalRole;
                    return { ...h, ssoPerPerson, totalPerRole, ssoTotalRole };
                });
                const salaryTotal = baseSalaryTotal + ssoTotal; 
                
                const fixedCostItems = 
                    (data.fixedParams?.erp || 0) + 
                    (data.fixedParams?.campaign || 0) + 
                    (data.fixedParams?.other || 0) + 
                    ((data.capex?.machine || 0) * ((data.fixedParams?.maintPercent || 2) / 100) / 12) + 
                    ((data.fixedParams.insurance || 60000) / 12) + 
                    (data.fixedParams.audit || 0) + 
                    (data.fixedParams.travel || 0);

                const fixedCashTotal = salaryTotal + fixedCostItems; 

                // ===== INPUT VAT CALCULATION =====
                // Some fixed costs may also include VAT (e.g., ERP, services). Allow configurable share.
                // This allows flexibility: some fixed costs are VAT-inclusive (services), some are not (salaries)
                const vatableFixedPercent = data.fixedParams?.vatablePercent ?? 0;
                const vatableFixed = fixedCostItems * (vatableFixedPercent / 100);

                // Vatable expenses = All expenses that include VAT (VAT-inclusive)
                // Includes: Packaging, Electricity, Platform fees, Marketing, Vatable fixed costs
                // Note: Rice cost (paddy) is typically non-VAT (agricultural product)
                const vatableExpenses = packTotal + elecTotal + platformTotal + mktTotal + vatableFixed;
                
                // Input VAT = Vatable expenses - (Vatable expenses / VAT Multiplier)
                // This is VAT we paid on purchases (can be used as credit against output VAT)
                // Example: 100,000 VAT-inclusive expense ‚Üí Input VAT = 100,000 - (100,000 / 1.07) = 6,542
                const totalVatIn = vatableExpenses - (vatableExpenses / vatMultiplier);
                
                const totalVar = riceTotal + packTotal + elecTotal + platformTotal + mktTotal; 
                const section7Total = elecTotal + platformTotal + mktTotal + fixedCostItems;

                const riceCostUnit = (5 / (data.yield/100)) * (data.paddyPrice/1000);
                const matCostUnit = riceCostUnit + data.unit.bag + data.unit.sticker;

                // --- Calculate 24-Month Projections for Stock Purchase Logic ---
                const season = data.seasonalShock || { active: false, startM: 5, endM: 8, costImpact: 20 };
                const projectedRiceCosts = []; // Array of monthly rice costs for 24 months
                for(let k=1; k<=24; k++) {
                   let growthFactor = Math.pow(1 + data.monthlyGrowth/100, k - 1);
                   if (k <= 2) growthFactor *= 0.5; // Ramp up constraint on sales volume (so cost also low)
                   
                   let monthlyRiceCost = riceTotal * growthFactor;
                   if (season.active && k >= season.startM && k <= season.endM) {
                       monthlyRiceCost *= (1 + season.costImpact/100);
                   }
                   projectedRiceCosts.push(monthlyRiceCost);
                }

                // --- INITIAL STOCK REQUIREMENT (Based on Policy) ---
                let initialStockAmount = 0;
                if (stockPolicyMonths > 0) {
                    for (let m=0; m < stockPolicyMonths; m++) {
                        // Sum up cost for Month 1, Month 2... based on policy
                        if (m < projectedRiceCosts.length) {
                            initialStockAmount += projectedRiceCosts[m];
                        }
                    }
                }

                // --- WORKING CAPITAL Adjustment ---
                // We use the CALCULATED initial stock requirement as the actual cash outflow at Day 0
                // regardless of what user typed in `capex.stock` (to be accurate to the policy).
                // However, `capex.stock` is still used for Depreciation logic if needed, but for Cash Flow Start:
                const totalCapexNonStock = data.capex.factory + data.capex.machine + data.capex.license; 
                
                // --- CAPEX STEP-UP (for scaling to 1000M) ---
                let additionalCapex = 0;
                let effectiveMaxCapacity = data.maxCapacity || 70000;
                if (data.capexStepUp?.enabled && data.targetBags >= (data.capexStepUp.thresholdBags || 30000)) {
                    additionalCapex = (data.capexStepUp.factoryExpansion || 0) + (data.capexStepUp.machineExpansion || 0);
                    effectiveMaxCapacity = (data.capexStepUp.capacityIncrease || 0) || effectiveMaxCapacity;
                }
                
                const totalSources = data.regCapital + (data.loan.amount || 0);
                
                // ===== WORKING CAPITAL CYCLE CALCULATION =====
                // Working Capital Cycle Impact (AR/AP/Inventory)
                // NOTE: These are used for cash flow planning, NOT deducted from initial Working Capital
                // Working Capital = money available at Day 0, WC Cycle = money tied up during operations
                //
                // AR (Accounts Receivable) Days: Days customers take to pay
                //    AR Requirement = (Monthly Revenue / 30) √ó AR Days
                //    Example: 1,000,000/month revenue, 30 days AR ‚Üí 1,000,000 THB tied in receivables
                //
                // AP (Accounts Payable) Days: Days we take to pay suppliers
                //    AP Benefit = (Monthly Cost / 30) √ó AP Days
                //    Example: 800,000/month cost, 30 days AP ‚Üí 800,000 THB we can delay paying (benefit)
                //
                // Inventory Days: Days inventory sits in warehouse
                //    Inventory Requirement = (Monthly Rice Cost / 30) √ó Inventory Days
                //    Example: 500,000/month rice cost, 60 days inventory ‚Üí 1,000,000 THB tied in inventory
                //
                // Net WC Requirement = AR + Inventory - AP Benefit
                //    Shows how much cash will be tied up during operations
                const wc = data.workingCapital || { arDays: 0, apDays: 30, inventoryDays: 60 };
                const monthlyRevExVat = exVat(baseRev);
                const monthlyCostExVat = riceTotal + (vatableExpenses - totalVatIn) + fixedCashTotal;
                const arRequirement = (monthlyRevExVat / 30) * (wc.arDays || 0); // Money tied in receivables
                const apBenefit = (monthlyCostExVat / 30) * (wc.apDays || 0); // Money we can delay paying
                const inventoryRequirement = (riceTotal / 30) * (wc.inventoryDays || 60); // Money tied in inventory
                const netWcRequirement = arRequirement + inventoryRequirement - apBenefit;
                
                // ===== INITIAL WORKING CAPITAL CALCULATION =====
                // Real Working Capital = Sources - Fixed Assets - Initial Stock Purchase - Additional CAPEX
                // This is cash available at Day 0 for operations
                // WC Cycle is informational only (shows how much cash will be tied up during operations)
                // Formula: Working Capital = Total Sources - CAPEX (Factory + Machine + License) - Initial Stock - Step-up CAPEX
                const workingCap = totalSources - totalCapexNonStock - initialStockAmount - additionalCapex;
                const totalCapex = totalCapexNonStock + initialStockAmount + additionalCapex; // Update Total Capex Display

                // Depreciation includes step-up CAPEX if triggered
                const totalFactoryCapex = data.capex.factory + (additionalCapex > 0 ? (data.capexStepUp?.factoryExpansion || 0) : 0);
                const totalMachineCapex = data.capex.machine + (additionalCapex > 0 ? (data.capexStepUp?.machineExpansion || 0) : 0);
                const annualDepreciation = (totalFactoryCapex / data.depreciation.factoryYears) + (totalMachineCapex / data.depreciation.machineYears);

                const basketSize = data.mktFunnel?.basketSize || 1;
                const cvr = data.mktFunnel?.cvr || 2.0;
                const ctr = data.mktFunnel?.ctr || 1.5;

                const totalOrders = data.targetBags / basketSize;
                const cpa = totalMarketingBudget / totalOrders; 
                const visitorsNeeded = totalOrders / (cvr / 100);
                const impressionsNeeded = visitorsNeeded / (ctr / 100);
                const impliedCPC = totalMarketingBudget / visitorsNeeded;
                const impliedCPM = (totalMarketingBudget / impressionsNeeded) * 1000;

                // ===== MARKETING METRICS (ROAS & ACOS) =====
                // Finance-standard: use ex-VAT revenue and ex-VAT ad spend (VAT on ads is input VAT recoverable)
                // ROAS (Return on Ad Spend) = Revenue from ads / Ad Spend
                // Higher ROAS = Better efficiency (e.g., ROAS 4.0 means 4 THB revenue per 1 THB ad spend)
                // ACOS (Advertising Cost of Sales) = Ad Spend / Revenue √ó 100%
                // Lower ACOS = Better efficiency (e.g., ACOS 25% means 25% of revenue goes to ads)
                const roas = totalMarketingBudget > 0 ? exVat(netRiceSales) / exVat(totalMarketingBudget) : 0;
                const acos = netRiceSales > 0 ? (exVat(totalMarketingBudget) / exVat(netRiceSales)) * 100 : 0;

                // ===== BREAKEVEN ROAS CALCULATION =====
                // Breakeven ROAS = Minimum ROAS needed to break even (profit = 0)
                // At breakeven: Revenue - Variable Cost (no ads) - Ad Spend = 0
                // Therefore: Ad Spend = Revenue - Variable Cost (no ads) = Contribution Margin
                // Breakeven ROAS = Revenue / Contribution Margin
                // 
                // Example: Revenue = 100, Variable Cost (no ads) = 60, Contribution Margin = 40
                //          Breakeven ROAS = 100 / 40 = 2.5
                //          Meaning: Need at least 2.5 THB revenue per 1 THB ad spend to break even
                //
                // If Contribution Margin <= 0: Cannot make profit even without ads (business model not viable)
                const revUnitExVat = exVat(data.price);
                const packUnitExVat = exVat(data.unit.bag + data.unit.sticker);
                const elecUnitIncVat = (data.varParams.elecRate * (5 / (data.yield/100)) / 1000);
                const elecUnitExVat = exVat(elecUnitIncVat);
                const platformFeeUnitIncVat = (data.price * platformPctFinal/100);
                const platformFeeUnitExVat = exVat(platformFeeUnitIncVat);
                const varCostNoAdsUnitExVat = riceCostUnit + packUnitExVat + elecUnitExVat + platformFeeUnitExVat;
                const contributionMarginPerUnit = revUnitExVat - varCostNoAdsUnitExVat;
                
                // Breakeven ROAS: Revenue / Contribution Margin
                // If Contribution Margin <= 0, set to 999 (impossible to break even)
                const beRoasVal = contributionMarginPerUnit > 0 ? (revUnitExVat / contributionMarginPerUnit) : 999;

                // Unit economics (ex-VAT) for real planning
                const adsSpendExVat = exVat(totalMarketingBudget);
                const adsUnitExVat = data.targetBags > 0 ? (adsSpendExVat / data.targetBags) : 0;
                const grossCmUnitExVat = contributionMarginPerUnit; // before ads (contribution margin = revenue - variable cost without ads)
                const contribCmUnitExVat = grossCmUnitExVat - adsUnitExVat; // after ads (contribution margin after ads)
                const cpaExVat = totalOrders > 0 ? (adsSpendExVat / totalOrders) : 0;

                const clvP = data.clvParams || { freq: 4, retention: 60 };
                // Gross margin for LTV: use ex-VAT revenue and exclude ads spend (since CAC is ad spend)
                const riceRevExVat = exVat(netRiceSales);
                const packExVat = exVat(packTotal);
                const elecExVat = exVat(elecTotal);
                const platformExVat = exVat(platformTotal);
                const grossMarginPct = riceRevExVat > 0 ? ((riceRevExVat - (riceTotal + packExVat + elecExVat + platformExVat)) / riceRevExVat) : 0; 
                const aov = basketSize * exVat(data.price);
                const retention = clvP.retention / 100;
                const ltv1 = (aov * clvP.freq * grossMarginPct); 
                const ltv3 = ltv1 * (1 + retention + Math.pow(retention, 2)); 
                const churn = 1 - retention;
                const lifetimeValue = churn > 0.001 ? (ltv1 / churn) : (ltv1 * 50); 
                // LTV/CAC ratio: Use ex-VAT CPA for consistency
                const ltvCac = cpaExVat > 0 ? lifetimeValue / cpaExVat : 0;

                const elasticityData = [];
                const baseVol = data.targetBags;
                const baseP = data.price;
                const coef = data.elasticityParams?.coefficient || 1.5;
                
                [-20, -10, 0, 10, 20].forEach(change => {
                    const newP = baseP * (1 + change/100);
                    const qtyChange = (change/100) * -coef;
                    const newVol = baseVol * (1 + qtyChange);
                    const newRev = newP * newVol;
                    elasticityData.push({
                        pct: `${change > 0 ? '+' : ''}${change}%`,
                        price: newP,
                        vol: newVol,
                        rev: newRev
                    });
                });

                const funnelMetrics = {
                    budget: totalMarketingBudget, orders: totalOrders, cpa: cpa, visitors: visitorsNeeded,
                    cpc: impliedCPC, impressions: impressionsNeeded, cpm: impliedCPM, roas: roas, acos: acos, 
                    gmv: riceRev, beRoas: beRoasVal, ltv1, ltv3, ltvCacRatio: ltvCac, lifetimeValue,
                    cpaExVat: cpaExVat // Also include ex-VAT CPA for consistency
                };

                const accruedRev = [];
                for(let k=1; k<=24; k++) {
                   let growthFactor = Math.pow(1 + data.monthlyGrowth/100, k - 1);
                   if (k <= 2) growthFactor *= 0.5;
                   accruedRev.push(baseRev * growthFactor);
                }
                const dailyRevs = [0, ...accruedRev].map(r => r/30); 

                const cf = [];
                let runningCash = workingCap; 
                let annualOperatingCashProfit = 0; 
                let annualFinanceCost = 0; 
                let annualPrincipalPaid = 0;
                let lowestCashBalance = workingCap; 
                let vatCarry = 0; // negative = accumulated input VAT credit to offset future payable

                let remainingLoanPrincipal = data.loan.amount;
                const monthlyPrincipalPayment = data.loan.amount > 0 ? data.loan.amount / (data.loan.term * 12) : 0; 
                const creditTermDays = parseInt(data.creditTerm || 0);

                const calcTax = (profit) => {
                    if(profit <= 300000) return 0;
                    let tax = 0;
                    if(profit > 300000) tax += Math.min(profit - 300000, 2700000) * 0.15;
                    if(profit > 3000000) tax += (profit - 3000000) * 0.20;
                    return tax;
                };

                // ===== MONTHLY CASH FLOW CALCULATION (12 MONTHS) =====
                for(let i=1; i<=12; i++) {
                    const mRev = accruedRev[i-1]; // Revenue for this month (VAT-inclusive)
                    
                    // ===== CASH INFLOW CALCULATION (Accounts Receivable) =====
                    // Cash inflow considers credit terms (payment delay)
                    // If credit term = 0 days: Cash received same month as sale
                    // If credit term = 30 days: Cash received 1 month after sale
                    //
                    // Example with 30-day credit term:
                    //   Month 1 sales ‚Üí Cash received in Month 2
                    //   Month 2 sales ‚Üí Cash received in Month 3
                    //
                    // Calculation finds overlap between:
                    //   - Sales period (when revenue was earned)
                    //   - Payment period (when cash is received, offset by credit term)
                    let cashInflow = 0;
                    const currentMonthStartCashDay = (i-1)*30 + 1; // Day 1 of current month
                    const currentMonthEndCashDay = i*30; // Day 30 of current month
                    const startSalesDay = currentMonthStartCashDay - creditTermDays; // Sales that pay this month
                    const endSalesDay = currentMonthEndCashDay - creditTermDays;
                    const maxLookBack = Math.ceil(creditTermDays/30) + 1; // How many months to look back
                    const startSourceM = Math.max(1, i - maxLookBack);
                    
                    // Calculate cash inflow from sales in previous months that pay this month
                    for(let srcM = startSourceM; srcM <= i; srcM++) {
                        const mStart = (srcM-1)*30 + 1;
                        const mEnd = srcM*30;
                        const overlapStart = Math.max(startSalesDay, mStart);
                        const overlapEnd = Math.min(endSalesDay, mEnd);
                        if (overlapEnd >= overlapStart) {
                            const daysCount = overlapEnd - overlapStart + 1;
                            cashInflow += daysCount * dailyRevs[srcM]; // Add proportional daily revenue
                        }
                    }

                    // --- COST CALCULATION ---
                    let volumeFactor = Math.pow(1 + data.monthlyGrowth/100, i - 1);
                    if (i <= 2) volumeFactor *= 0.5; // Ramp up match
                    
                    // Accounting Cost (Used for Profit calc)
                    let accountingRiceCost = projectedRiceCosts[i-1];

                    // ===== STOCK REPLENISHMENT LOGIC (Cash Outflow) =====
                    // Stock Policy determines when to purchase inventory:
                    // - Policy = 0 (JIT): Buy for current month (Just-In-Time)
                    // - Policy = 2 Months: Buy 2 months in advance
                    // - Policy = 3 Months: Buy 3 months in advance
                    //
                    // Example with Policy = 2 Months:
                    //   Month 1 buys stock for Month 3 (2 months ahead)
                    //   Month 2 buys stock for Month 4 (2 months ahead)
                    //   Month 3 buys stock for Month 5 (2 months ahead)
                    //
                    // This ensures sufficient inventory buffer for operations
                    // Target index in projectedRiceCosts array (0-based)
                    // If i=1 (Month 1), Stock Policy=2 ‚Üí Buy for Month 3 (Index 2)
                    let targetStockIndex = (i - 1) + stockPolicyMonths; 
                    let cashOutRice = 0;
                    if (targetStockIndex < projectedRiceCosts.length) {
                        // Use projected cost for target month
                        cashOutRice = projectedRiceCosts[targetStockIndex];
                    } else {
                        // Extrapolate if beyond 24 months: use last month's cost
                        cashOutRice = projectedRiceCosts[projectedRiceCosts.length-1]; 
                    }

                    // Other Variable Costs (Just in Time)
                    const mVatableVar = (packTotal + elecTotal + platformTotal + mktTotal) * volumeFactor;
                    const mSalary = salaryTotal;
                    const mVatableFixed = fixedCostItems; 
                    
                    // Total Cash Outflow
                    const mExpCash = cashOutRice + mVatableVar + mSalary + mVatableFixed; 
                    const mOpEx = mVatableVar + mSalary + mVatableFixed; // NEW: Track OpEx separately
                    
                    const mOutVat = totalVatOut * volumeFactor; 
                    const mInVatTotal = totalVatIn * volumeFactor; 

                    // ===== VAT SETTLEMENT & CREDIT CARRY-FORWARD =====
                    // VAT credit carry-forward (common in real VAT accounting)
                    // If input VAT > output VAT, we keep it as credit to offset future payable
                    // This follows Thai VAT regulations: excess input VAT can be carried forward
                    // 
                    // Calculation:
                    // 1. Net VAT this month = Output VAT - Input VAT
                    // 2. Add previous VAT credit carry-forward
                    // 3. If positive ‚Üí Pay VAT to government
                    // 4. If negative ‚Üí Keep as credit for future months
                    //
                    // Example:
                    // Month 1: Output VAT = 50,000, Input VAT = 70,000 ‚Üí Credit = -20,000 (carry forward)
                    // Month 2: Output VAT = 60,000, Input VAT = 40,000 ‚Üí Net = 20,000 - 20,000 credit = 0 (no payment)
                    let mVatSettlement = (mOutVat - mInVatTotal) + vatCarry;
                    let mVatCashOut = 0;
                    if (mVatSettlement > 0) {
                        // Net VAT payable: Pay to government
                        mVatCashOut = mVatSettlement;
                        vatCarry = 0; // Reset carry-forward
                    } else {
                        // Net VAT credit: Keep as carry-forward (negative value)
                        vatCarry = mVatSettlement; // Negative value stored
                        mVatSettlement = 0; // No payment this month
                    }
                    
                    const interestThisMonth = remainingLoanPrincipal * (data.loan.rate / 100 / 12);
                    const principalThisMonth = remainingLoanPrincipal > 0 ? monthlyPrincipalPayment : 0;
                    remainingLoanPrincipal -= principalThisMonth;

                    // ===== ACCOUNTING PROFIT CALCULATION =====
                    // Accounting Profit = Revenue (ex-VAT) - Costs (ex-VAT)
                    // Uses consumption cost (accountingRiceCost) not cash cost (cashOutRice)
                    // This follows accrual accounting: recognize costs when consumed, not when paid
                    // Formula: Profit = Revenue ex-VAT - (Rice Cost + Variable Costs + Salary + Fixed Costs) ex-VAT
                    const mNetOpProfit = (mRev - mOutVat) - ((accountingRiceCost + mVatableVar + mSalary + mVatableFixed) - mInVatTotal); 

                    annualOperatingCashProfit += mNetOpProfit;
                    annualFinanceCost += interestThisMonth;
                    annualPrincipalPaid += principalThisMonth;

                    const startOfMonthCash = runningCash;
                    
                    let monthlyTaxPayment = 0;
                    if (data.taxPaymentMode === 'monthly') {
                        // Simple annualized estimate: use current month run-rate and current interest run-rate.
                        const annualizedProfit = mNetOpProfit * 12; 
                        const estAnnualTax = calcTax(annualizedProfit - annualDepreciation - (interestThisMonth * 12));
                        monthlyTaxPayment = estAnnualTax / 12;
                    }

                    const netCashMovement = cashInflow - mExpCash - mVatCashOut - interestThisMonth - principalThisMonth - monthlyTaxPayment;
                    runningCash += netCashMovement;
                    if(runningCash < lowestCashBalance) lowestCashBalance = runningCash;

                    cf.push({ 
                        m: i, 
                        rev: mRev, 
                        revCashIn: cashInflow, 
                        expCash: mExpCash, 
                        netOpCash: mNetOpProfit, 
                        netCashFlow: netCashMovement,
                        interest: interestThisMonth, 
                        principal: principalThisMonth, 
                        cashStart: startOfMonthCash, 
                        cashPreTax: runningCash, 
                        vatPaid: mVatCashOut, 
                        vatCashOut: mVatCashOut,
                        taxPaidInMonth: monthlyTaxPayment,
                        cashFinal: runningCash,
                        stockAdvance: cashOutRice, // For UI display
                        opEx: mOpEx // NEW: Store OpEx
                    });
                }

                const taxableIncome = annualOperatingCashProfit - annualDepreciation - annualFinanceCost;
                let taxDetails = [];
                let totalTaxEst = calcTax(taxableIncome);
                
                if (taxableIncome > 0) {
                    if (taxableIncome > 300000) taxDetails.push({ tier: "300k-3M", rate: 15, amount: Math.min(taxableIncome - 300000, 2700000) * 0.15 });
                    if (taxableIncome > 3000000) taxDetails.push({ tier: "> 3M", rate: 20, amount: (taxableIncome - 3000000) * 0.20 });
                }
                
                const cfFinal = cf.map((item, index) => {
                    let mTax = 0;
                    let finalCumulativeCash = item.cashFinal;
                    if (data.taxPaymentMode === 'annual') { 
                        mTax = index === 11 ? totalTaxEst : 0;
                        if (index === 11) finalCumulativeCash -= totalTaxEst; 
                    }
                    else if (data.taxPaymentMode === 'monthly') mTax = item.taxPaidInMonth;
                    
                    if(finalCumulativeCash < lowestCashBalance) lowestCashBalance = finalCumulativeCash; 
                    return { ...item, tax: mTax, cashFinal: finalCumulativeCash };
                });

                const cfTotal = cfFinal.reduce((acc, cur) => ({
                    rev: acc.rev + cur.rev, 
                    revCashIn: (acc.revCashIn || 0) + cur.revCashIn,
                    expCash: acc.expCash + cur.expCash, netOpCash: acc.netOpCash + cur.netOpCash, 
                    netCashFlow: (acc.netCashFlow || 0) + cur.netCashFlow,
                    tax: acc.tax + cur.tax, interest: acc.interest + cur.interest, principal: acc.principal + cur.principal, 
                    vatPaid: acc.vatPaid + cur.vatPaid,
                    stockAdvance: (acc.stockAdvance || 0) + cur.stockAdvance, // Sum Stock
                    opEx: (acc.opEx || 0) + cur.opEx // Sum OpEx
                }), { rev: 0, revCashIn: 0, expCash: 0, netOpCash: 0, netCashFlow: 0, tax: 0, interest: 0, principal: 0, vatPaid: 0, stockAdvance: 0, opEx: 0 });
                cfTotal.cashFinal = cfFinal[11].cashFinal;

                // --- NEW CALC: Next Year Stock Affordability (CORRECTED) ---
                const cashEnd = cfFinal[11].cashFinal;
                const growthRate = data.growth / 100;
                // Year 2 projected cost (simplified: current cost + growth)
                // Use a realistic target for Year 2 based on growth
                const targetBagsY2 = data.targetBags * (1 + growthRate);
                const paddyTonsY2 = (targetBagsY2 * 5) / (data.yield/100) / 1000;
                // Inflation on paddy price
                const inflationRate = data.inflation / 100;
                const paddyPriceY2 = data.paddyPrice * (1 + inflationRate);
                
                // FIX: Calculate Monthly vs Annual correctly
                const monthlyRiceCostY2_Base = paddyTonsY2 * paddyPriceY2; // Cost per Month
                const totalRiceCostY2 = monthlyRiceCostY2_Base * 12; // Cost per Year (Annual)
                
                // Stock months capability = Cash / Monthly Cost
                const nextYearStockMonths = cashEnd > 0 ? (cashEnd / monthlyRiceCostY2_Base) : 0;

                const annualNetProfitAfterAll = taxableIncome - totalTaxEst; 
                const dividendTotal = annualNetProfitAfterAll > 0 ? annualNetProfitAfterAll * (data.dividend.payout / 100) : 0;
                const dividendPerPersonYear = data.dividend.founders > 0 ? dividendTotal / data.dividend.founders : 0;
                const dividendPerPersonMonth = dividendPerPersonYear / 12;
                const roi = totalSources > 0 ? (annualNetProfitAfterAll / totalSources) * 100 : 0;
                
                // ===== BREAK-EVEN POINT (BEP) CALCULATION =====
                // Break-even calculation: Use ex-VAT values for consistency with accounting standards
                // Break-even Point = Fixed Costs / (Revenue per unit - Variable Cost per unit)
                // At BEP: Total Revenue = Total Costs (Fixed + Variable)
                // 
                // Formula: BEP Units = Fixed Costs / Contribution Margin per unit
                //          BEP Sales = BEP Units √ó Revenue per unit
                //
                // Example: Fixed Costs = 100,000/month
                //          Revenue per bag = 350, Variable Cost per bag = 250
                //          Contribution Margin per bag = 100
                //          BEP Units = 100,000 / 100 = 1,000 bags/month
                //          BEP Sales = 1,000 √ó 350 = 350,000 THB/month
                const revenueTotalExVat = exVat(baseRev);
                const vcTotalExVat = riceTotal + (vatableExpenses - totalVatIn); // Variable costs ex-VAT
                const fcTotal = fixedCashTotal;
                const revPerBagExVat = data.targetBags > 0 ? revenueTotalExVat / data.targetBags : 0;
                const vcPerBagExVat = data.targetBags > 0 ? vcTotalExVat / data.targetBags : 0;
                const cmPerBagExVat = revPerBagExVat - vcPerBagExVat; // Contribution Margin per bag
                const bepUnits = cmPerBagExVat > 0 ? fcTotal / cmPerBagExVat : 0; // Break-even units
                const bepSales = bepUnits * revPerBagExVat; // Break-even sales (ex-VAT)
                
                // Legacy VAT-inclusive values for backward compatibility (if needed)
                const vcTotal = totalVar; 
                const revenueTotal = baseRev;
                const revPerBag = revenueTotal / data.targetBags;
                const vcPerBag = vcTotal / data.targetBags;
                const cmPerBag = revPerBag - vcPerBag;
                const bepData = [];
                [0, 0.5, 1.0, 1.5].forEach(s => {
                    const units = data.targetBags * s;
                    bepData.push({ units: units, revenue: units * revPerBagExVat, totalCost: fcTotal + (units * vcPerBagExVat), fixedCost: fcTotal });
                });
                if(bepUnits < data.targetBags * 1.5) bepData.push({ units: bepUnits, revenue: bepSales, totalCost: bepSales, fixedCost: fcTotal, isBep: true });
                bepData.sort((a,b) => a.units - b.units);

                // ===== NET MARGIN CALCULATION =====
                // Net Margin = (Net Profit / Revenue) √ó 100%
                // Use ex-VAT revenue for consistency with accounting standards
                // This shows profitability after all costs (variable, fixed, tax, interest)
                // Higher net margin = More profitable business
                const revenueExVat = exVat(cfTotal.rev);
                const netMargin = revenueExVat > 0 ? (annualNetProfitAfterAll / revenueExVat) * 100 : 0;

                // Executive Summary "Gross Margin" (ex-VAT, for real planning):
                // Treat as gross profit after key variable/direct costs (COGS + variable fulfillment/platform),
                // before ads & payroll/overhead. Revenue is VAT-inclusive in inputs, so convert to ex-VAT here.
                const riceRevExVat_forGM = exVat(riceRev);
                const grossCostsExVat_forGM = riceTotal + exVat(packTotal) + exVat(elecTotal) + exVat(platformTotal);
                const grossMargin = riceRevExVat_forGM > 0 ? ((riceRevExVat_forGM - grossCostsExVat_forGM) / riceRevExVat_forGM) * 100 : 0;

                // Contribution margin (ex-VAT): after platform + ads (still before payroll/overhead)
                const contribCostsExVat = grossCostsExVat_forGM + exVat(mktTotal);
                // Contribution Margin = (Revenue - Variable Costs including Marketing) / Revenue √ó 100%
                // Shows profitability after variable costs and marketing, before fixed costs
                const contributionMargin = riceRevExVat_forGM > 0 ? ((riceRevExVat_forGM - contribCostsExVat) / riceRevExVat_forGM) * 100 : 0;
                
                // ===== DEBT SERVICE COVERAGE RATIO (DSCR) =====
                // DSCR = Operating Cash Profit / Debt Service (Principal + Interest)
                // Measures ability to service debt from operating cash flow
                // DSCR > 1.0 = Can cover debt payments, DSCR < 1.0 = Cannot cover debt payments
                // Higher DSCR = Lower risk for lenders
                const debtService = annualPrincipalPaid + annualFinanceCost;
                const dscr = debtService > 0 ? annualOperatingCashProfit / debtService : (annualOperatingCashProfit > 0 ? 999 : 0);

                let paybackMonth = _t('paybackNotYet');
                const annualCashFlow = annualOperatingCashProfit - totalTaxEst - annualFinanceCost;
                if (annualCashFlow > 0) {
                      const monthsToPayback = totalSources / (annualCashFlow/12);
                      paybackMonth = `${Math.ceil(monthsToPayback)} ${_t('month')}`;
                }

                const vatBreakdown = { vatableExp: vatableExpenses, inputVat: totalVatIn, outputVat: totalVatOut, netVat: (totalVatOut - totalVatIn) };
                const revBreakdown = {
                    sales: riceRev, byProduct: totalByProductIncome, logistics: logIncome,
                    totalIn: baseRev, vat: totalVatOut,
                    // Ex-VAT operating cost:
                    // - Revenue ex-VAT = baseRev - totalVatOut
                    // - Variable cost ex-VAT = riceTotal (assumed non-VAT) + (vatableExpenses - totalVatIn)
                    opCost: (riceTotal + (vatableExpenses - totalVatIn)) + fixedCashTotal,
                    opVar: riceTotal + (vatableExpenses - totalVatIn),
                    opFixed: fixedCashTotal,
                    // Net cash EBITDA (ex-VAT): revenue ex-VAT - (var ex-VAT + fixed cash)
                    netCash: (baseRev - totalVatOut) - (riceTotal + (vatableExpenses - totalVatIn)) - fixedCashTotal,
                    riceCost: riceTotal, packCost: packTotal, feesCost: platformTotal + mktTotal,
                    elecCost: elecTotal, salaryCost: salaryTotal, otherFixed: fixedCostItems,
                    otherDetails: {
                        erp: data.fixedParams.erp, campaign: data.fixedParams.campaign, misc: data.fixedParams.other,
                        maintenance: (data.capex.machine * ((data.fixedParams.maintPercent || 2) / 100) / 12),
                        insurance: ((data.fixedParams.insurance || 60000) / 12), audit: data.fixedParams.audit, travel: data.fixedParams.travel
                    }
                };
                
                const utilizationPct = (data.targetBags / (data.maxCapacity || 30000)) * 100;
                const fixedCostPerUnit = data.targetBags > 0 ? fixedCashTotal / data.targetBags : 0;
                // Display var cost per unit (ex-VAT)
                const varCostPerUnitDisplay = data.targetBags > 0 ? (riceTotal + (vatableExpenses - totalVatIn)) / data.targetBags : 0;

                const monthlyDebtService = (annualFinanceCost + annualPrincipalPaid) / 12;
                const monthlyBurnRate = fixedCashTotal + monthlyDebtService;
                const cashRunwayMonths = monthlyBurnRate > 0 ? workingCap / monthlyBurnRate : 0;

                // --- MULTI-CHANNEL P&L BREAKDOWN (for scaling planning) ---
                const channelBreakdown = {};
                if (data.channelBreakdown?.enabled) {
                    // Calculate ex-VAT costs for packaging and electricity (used in channel breakdown)
                    const packExVat = exVat(packTotal);
                    const elecExVat = exVat(elecTotal);
                    
                    if (data.channelMix?.b2c || data.channelMix?.b2b) {
                        // New sub-channel structure
                        if (channelDetails && Object.keys(channelDetails).length > 0) {
                            // Use the already-calculated blendedMktPct and totalMixPct from earlier in the function
                            // This ensures consistency: totalMarketingBudget uses the same blendedMktPct
                            // totalWeightedMkt should equal blendedMktPct (already calculated above)
                            // Verify consistency: recalculate totalWeightedMkt from channelDetails
                            let totalWeightedMktVerify = 0;
                            Object.values(channelDetails).forEach(detail => {
                                totalWeightedMktVerify += (detail.mixPct * detail.mktPct) / 100;
                            });
                            // Use blendedMktPct (already calculated) for consistency, but verify it matches
                            const totalWeightedMkt = blendedMktPct > 0 ? blendedMktPct : totalWeightedMktVerify;
                            
                            Object.entries(channelDetails).forEach(([key, detail]) => {
                                const mixPct = detail.mixPct;
                                const feePct = detail.feePct;
                                const mktPct = detail.mktPct;
                                // Revenue: Channel mix % is % of netRiceSales
                                const chRev = netRiceSales * (mixPct / 100);
                                const chRevExVat = exVat(chRev);
                                // Fee: Platform fee % of channel revenue
                                const chFee = chRev * (feePct / 100);
                                const chFeeExVat = exVat(chFee);
                                // Marketing Spend: Allocate totalMarketingBudget proportionally by weighted marketing
                                // Formula: chMktSpend = totalMarketingBudget * (channelWeightedMkt / totalWeightedMkt)
                                // where channelWeightedMkt = (mixPct * mktPct) / 100
                                // This ensures: Œ£(chMktSpend) = totalMarketingBudget (sum of all channels equals total)
                                const channelWeightedMkt = (mixPct * mktPct) / 100;
                                const chMktSpend = totalWeightedMkt > 0 && totalMarketingBudget > 0
                                    ? totalMarketingBudget * (channelWeightedMkt / totalWeightedMkt)
                                    : baseRev * (mixPct / 100) * (mktPct / 100);
                                const chMktExVat = exVat(chMktSpend);
                                // Cost: Allocate variable costs (rice, packaging, electricity) by channel mix %
                                // These costs are proportional to sales volume (mixPct)
                                const chCostExVat = (riceTotal + packExVat + elecExVat) * (mixPct / 100);
                                // Gross Margin: Revenue - Cost - Fee (before marketing)
                                const chGrossMargin = chRevExVat - chCostExVat - chFeeExVat;
                                // Contribution Margin: Gross Margin - Marketing Spend (after marketing)
                                const chContributionMargin = chGrossMargin - chMktExVat;
                                // GM % (Gross Margin %) should include marketing cost according to accounting principles
                                // GM % = (Revenue - Cost - Fee - Marketing) / Revenue = Contribution Margin / Revenue
                                // This is consistent: GM % after marketing = Contribution Margin %
                                const chGrossMarginPct = chRevExVat > 0 ? (chContributionMargin / chRevExVat) * 100 : 0;
                                channelBreakdown[key] = {
                                    ...detail,
                                    rev: chRev, revExVat: chRevExVat,
                                    fee: chFee, feeExVat: chFeeExVat,
                                    mktSpend: chMktSpend, mktExVat: chMktExVat,
                                    costExVat: chCostExVat,
                                    grossMargin: chGrossMargin, grossMarginPct: chGrossMarginPct,
                                    contribMargin: chContributionMargin, contribMarginPct: chRevExVat > 0 ? (chContributionMargin / chRevExVat) * 100 : 0
                                };
                            });
                        }
                    } else if (data.channelMix && data.channelFees) {
                        // Legacy structure
                        const channels = ['tiktok', 'shopee', 'offline'];
                        channels.forEach(ch => {
                            const mixPct = data.channelMix[ch] || 0;
                            const feePct = data.channelFees[ch] || 0;
                            const chRev = netRiceSales * (mixPct / 100);
                            const chRevExVat = exVat(chRev);
                            const chFee = chRev * (feePct / 100);
                            const chFeeExVat = exVat(chFee);
                            // Marketing Spend: Use mktTotal proportionally by channel mix
                            // mktTotal is already calculated from baseRev * finalBlendedMktPct
                            // Allocate proportionally to ensure sum equals mktTotal
                            const chMktShare = mixPct;
                            const chMktSpend = mktTotal * (chMktShare / 100);
                            const chMktExVat = exVat(chMktSpend);
                            // Cost: Allocate variable costs (rice, packaging, electricity) by channel mix %
                            // packExVat and elecExVat are already calculated above
                            const chCostExVat = (riceTotal + packExVat + elecExVat) * (mixPct / 100);
                            const chGrossMargin = chRevExVat - chCostExVat - chFeeExVat;
                            const chContributionMargin = chGrossMargin - chMktExVat;
                            // GM % (Gross Margin %) should include marketing cost according to accounting principles
                            // GM % = (Revenue - Cost - Fee - Marketing) / Revenue = Contribution Margin / Revenue
                            // This is consistent with new sub-channel structure above
                            const chGrossMarginPct = chRevExVat > 0 ? (chContributionMargin / chRevExVat) * 100 : 0;
                            channelBreakdown[ch] = {
                                category: 'legacy', subChannel: ch, nestedChannel: null,
                                mixPct, feePct, mktPct: data.varParams.mktPercent,
                                rev: chRev, revExVat: chRevExVat,
                                fee: chFee, feeExVat: chFeeExVat,
                                mktSpend: chMktSpend, mktExVat: chMktExVat,
                                costExVat: chCostExVat,
                                grossMargin: chGrossMargin, grossMarginPct: chGrossMarginPct,
                                contribMargin: chContributionMargin, contribMarginPct: chRevExVat > 0 ? (chContributionMargin / chRevExVat) * 100 : 0
                            };
                        });
                    }
                }

                return {
                    totalCapex, totalSources, workingCap, dayTarget, hourTarget, paddyTons,
                    annualDepreciation, depFactory: data.capex.factory / data.depreciation.factoryYears, depMachine: data.capex.machine / data.depreciation.machineYears,
                    totalByProductIncome, byProductsCalc, riceCostUnit, matCostUnit, grossRev: riceRev,
                    riceTotal, packTotal, elecTotal, platformTotal, mktTotal, totalVar,
                    salaryTotal, fixedCashTotal, logIncome, hrCosts,
                    ebitda: annualOperatingCashProfit, annualProfitEst: taxableIncome, annualTax: totalTaxEst, taxDetails, 
                    netProfit: annualNetProfitAfterAll, roi, paybackMonth, netMargin, grossMargin, dscr,
                    contributionMargin,
                    bepUnits, bepSales, fcTotal, vcPerBag, revPerBag, vcPerBagExVat, revPerBagExVat, bepData,
                    cf: cfFinal, cfTotal, dividendTotal, revBreakdown, vatBreakdown, section7Total, elecTotal, platformTotal, mktTotal,
                    dividendPerPersonYear, dividendPerPersonMonth, annualFinanceCost, annualPrincipalPaid, lowestCashBalance, 
                    funnelMetrics, blendedFeePct, elasticityData, yrProj: null, refundTotal,
                    utilizationPct, fixedCostPerUnit, varCostPerUnitDisplay, mktTotal, cashRunwayMonths, monthlyBurnRate, initialStockAmount,
                    nextYearStockMonths, totalRiceCostY2, vatCarryEnd: vatCarry, // Return new metrics
                    unitEco: { revUnitExVat, varCostNoAdsUnitExVat, grossCmUnitExVat, adsUnitExVat, contribCmUnitExVat, cpaExVat },
                    // Scaling features
                    capexStepUp: { enabled: data.capexStepUp?.enabled || false, additionalCapex, effectiveMaxCapacity },
                    workingCapitalCycle: { arRequirement, apBenefit, inventoryRequirement, netWcRequirement, arDays: wc.arDays, apDays: wc.apDays, inventoryDays: wc.inventoryDays },
                    channelBreakdown,
                    channelDetails, // Sub-channel details for UI
                    blendedFeePct, // Calculated blended fee percentage
                    blendedMktPct: finalBlendedMktPct // Weighted average marketing % from channel mix
                };
            };

            const sensitivityData = useMemo(() => {
                const results = [];
                const priceSteps = [0.9, 1.0, 1.1]; 
                const volumeSteps = [0.9, 1.0, 1.1]; 
                priceSteps.forEach(pStep => {
                    const row = [];
                    volumeSteps.forEach(vStep => {
                        const tData = JSON.parse(JSON.stringify(d));
                        tData.targetBags = Math.round(d.targetBags * vStep);
                        tData.paddyPrice = Math.round(d.paddyPrice * pStep);
                        const financials = calculateFinancials(tData);
                        row.push({ vLabel: `${(vStep*100-100).toFixed(0)}%`, pLabel: `${(pStep*100-100).toFixed(0)}%`, profit: financials.netProfit });
                    });
                    results.push(row);
                });
                return results;
            }, [d, lang]);

            const spreadData = useMemo(() => {
                const results = [];
                const paddySteps = [0.9, 1.0, 1.1]; 
                const sellPriceSteps = [0.9, 1.0, 1.1]; 
                paddySteps.forEach(costStep => {
                    const row = [];
                    sellPriceSteps.forEach(priceStep => {
                        const tData = JSON.parse(JSON.stringify(d));
                        tData.paddyPrice = Math.round(d.paddyPrice * costStep);
                        tData.price = Math.round(d.price * priceStep);
                        const financials = calculateFinancials(tData);
                        row.push({ cLabel: `${(costStep*100-100).toFixed(0)}%`, pLabel: `${(priceStep*100-100).toFixed(0)}%`, profit: financials.netProfit });
                    });
                    results.push(row);
                });
                return results;
            }, [d, lang]);

            const scenarioComparison = useMemo(() => {
                const scenarios = ['worst', 'base', 'best'];
                return scenarios.map(type => {
                    let sData = JSON.parse(JSON.stringify(d)); 
                    if (type === 'worst') { sData.targetBags = 8000; sData.paddyPrice = 18000; sData.growth = 0; sData.varParams.mktPercent = 20; } 
                    else if (type === 'base') { sData.targetBags = 15000; sData.paddyPrice = 16000; sData.growth = 10; sData.varParams.mktPercent = 15; } 
                    else if (type === 'best') { sData.targetBags = 20000; sData.paddyPrice = 15000; sData.growth = 15; sData.varParams.mktPercent = 13; }
                    const res = calculateFinancials(sData);
                    return { type, netProfit: res.netProfit, cashFinal: res.cfTotal.cashFinal };
                });
            }, [d, lang]); 

            const adsMatrixData = useMemo(() => {
                if (!c) return [];
                const baseCPM = c.funnelMetrics.cpm || 150; 
                const basePrice = d.price;
                const baseBasket = d.mktFunnel.basketSize;
                const cvrSteps = [0.8, 1.0, 1.2]; 
                const ctrSteps = [0.8, 1.0, 1.2];
                const results = [];
                cvrSteps.forEach(cvrMult => {
                    const row = [];
                    ctrSteps.forEach(ctrMult => {
                        const simCVR = d.mktFunnel.cvr * cvrMult;
                        const simCTR = d.mktFunnel.ctr * ctrMult;
                        const simRoas = (baseBasket * basePrice * simCVR * simCTR) / (baseCPM / 10);
                        row.push({ cvrLabel: simCVR.toFixed(2) + '%', ctrLabel: simCTR.toFixed(2) + '%', roas: simRoas });
                    });
                    results.push(row);
                });
                return results;
            }, [d, c, lang]);

            // VAT Impact Analysis - Calculate scenario comparison
            const vatImpactAnalysis = useMemo(() => {
                if (!c) return null;
                
                // Calculate impact of VAT rate change
                const currentVatRate = d.vatRate !== undefined ? d.vatRate : 7;
                const scenarioVatRate = 10; // Scenario: VAT increases to 10%
                
                // Calculate current scenario (already calculated in c)
                const currentRevExVat = c.revBreakdown.totalIn - c.revBreakdown.vat;
                const currentCostsExVat = c.revBreakdown.opCost;
                const currentProfit = c.netProfit;
                const currentCashFlow = c.cfTotal.netCashFlow || 0;
                const currentMargin = c.netMargin;
                
                // Calculate scenario with different VAT rate
                const scenarioData = JSON.parse(JSON.stringify(d));
                scenarioData.vatRate = scenarioVatRate;
                const scenarioFinancials = calculateFinancials(scenarioData);
                
                if (!scenarioFinancials) return null;
                
                const scenarioRevExVat = scenarioFinancials.revBreakdown.totalIn - scenarioFinancials.revBreakdown.vat;
                const scenarioCostsExVat = scenarioFinancials.revBreakdown.opCost;
                const scenarioProfit = scenarioFinancials.netProfit;
                const scenarioCashFlow = scenarioFinancials.cfTotal.netCashFlow || 0;
                const scenarioMargin = scenarioFinancials.netMargin;
                
                // Calculate changes
                const revChange = scenarioRevExVat - currentRevExVat;
                const costsChange = scenarioCostsExVat - currentCostsExVat;
                const profitChange = scenarioProfit - currentProfit;
                const cashFlowChange = scenarioCashFlow - currentCashFlow;
                const marginChange = scenarioMargin - currentMargin;
                
                return {
                    currentVatRate,
                    scenarioVatRate,
                    currentRevExVat,
                    currentCostsExVat,
                    currentProfit,
                    currentCashFlow,
                    currentMargin,
                    scenarioRevExVat,
                    scenarioCostsExVat,
                    scenarioProfit,
                    scenarioCashFlow,
                    scenarioMargin,
                    revChange,
                    costsChange,
                    profitChange,
                    cashFlowChange,
                    marginChange
                };
            }, [c, d]);

            const monteCarloResults = useMemo(() => {
                if (!c) return null;
                
                // ===== BUSINESS DECISION ENGINE: BASE VALUES FROM UI INPUTS =====
                const baseCtr = d.mktFunnel?.ctr || 1.5; // CTR from UI (%)
                const baseCvr = d.mktFunnel?.cvr || 2.0; // CVR from UI (%)
                const baseCpm = c.funnelMetrics?.cpm || 150; // CPM (THB per 1000 impressions)
                const basePrice = d.price || 0; // Price per unit (THB, VAT-inclusive)
                const baseBasketSize = d.mktFunnel?.basketSize || 1; // Units per order
                // CRITICAL: baseImpressions comes from funnelMetrics.impressions which is calculated from targetBags
                // Formula: impressionsNeeded = (targetBags / basketSize) / (cvr / 100) / (ctr / 100)
                // This means baseImpressions changes when CTR/CVR changes, which is CORRECT for Monte Carlo
                // The Monte Carlo then randomizes CTR/CVR around these base values, creating proper sensitivity
                // The demandFactor (¬±15%) adds additional variance for market demand uncertainty
                const baseImpressions = c.funnelMetrics?.impressions || 1000000; // Base impressions (calculated from targetBags, CTR, CVR)
                const baseReturnRate = d.varParams?.returnRate || 0.5; // Return rate (%)
                const targetRoas = c.funnelMetrics?.beRoas || 2.5; // Breakeven ROAS
                const targetProfit = c.netProfit || 0; // Target profit (monthly, from current calculation)
                
                // ===== COST STRUCTURE (ex-VAT) =====
                const riceCostUnit = ((5 / (d.yield || 60) / 100) * (d.paddyPrice || 0) / 1000);
                const packUnitExVat = ((d.unit?.bag || 0) + (d.unit?.sticker || 0)) / (1 + (d.vatRate || 7) / 100);
                const productCostPerUnit = riceCostUnit + packUnitExVat;
                
                const elecUnitIncVat = d.varParams?.elecRate ? (d.varParams.elecRate * (5 / (d.yield || 60) / 100) / 1000) : 0;
                const elecUnitExVat = elecUnitIncVat / (1 + (d.vatRate || 7) / 100);
                const platformFeeUnitIncVat = basePrice * ((c.blendedFeePct || 0) / 100);
                const platformFeeUnitExVat = platformFeeUnitIncVat / (1 + (d.vatRate || 7) / 100);
                const variableCostPerUnit = elecUnitExVat + platformFeeUnitExVat;
                
                const monthlyFixedCash = c.fixedCashTotal || 0;
                const monthlyDepreciation = (c.annualDepreciation || 0) / 12;
                const monthlyFinance = (c.annualFinanceCost || 0) / 12;
                
                const vatRate = d.vatRate !== undefined ? d.vatRate : 7;
                const vatMultiplier = 1 + (vatRate / 100);
                const exVat = (amt) => amt / vatMultiplier;
                
                // ===== SIMULATION SETUP =====
                const iterations = 10000;
                const simulationResults = []; // Store full simulation data for analysis
                
                // Triangular distribution function
                const triangular = (min, max, mode) => {
                    const u = Math.random();
                    const c = (mode - min) / (max - min);
                    if (u < c) return min + Math.sqrt(u * (max - min) * (mode - min));
                    return max - Math.sqrt((1 - u) * (max - min) * (max - mode));
                };
                
                const calcTaxAnnual = (profitYear) => {
                    if(profitYear <= 300000) return 0;
                    let tax = 0;
                    if(profitYear > 300000) tax += Math.min(profitYear - 300000, 2700000) * 0.15;
                    if(profitYear > 3000000) tax += (profitYear - 3000000) * 0.20;
                    return tax;
                };
                
                // ===== SENSITIVITY ANALYSIS: Track variable impacts =====
                const sensitivityData = {
                    ctr: { values: [], profits: [] },
                    cvr: { values: [], profits: [] },
                    cpm: { values: [], profits: [] },
                    demand: { values: [], profits: [] },
                    basketSize: { values: [], profits: [] },
                    price: { values: [], profits: [] }
                };
                
                // ===== MONTE CARLO SIMULATION LOOP =====
                // Full Funnel: Impressions ‚Üí CTR ‚Üí Clicks ‚Üí CVR ‚Üí Orders ‚Üí Orders After Returns ‚Üí Revenue ‚Üí Profit
                for (let i = 0; i < iterations; i++) {
                    // ===== STEP 1: RANDOMIZE ALL VARIABLES =====
                    // CTR: ¬±25% (0.75x to 1.25x) - User requested range
                    const sCtr = triangular(baseCtr * 0.75, baseCtr * 1.25, baseCtr);
                    // CVR: ¬±30% (0.70x to 1.30x) - User requested range
                    const sCvr = triangular(baseCvr * 0.70, baseCvr * 1.30, baseCvr);
                    // CPM: Volatility based on market model
                    // Normal Market: ¬±60% (0.40x to 1.60x)
                    // High Competition: ¬±100% (0.00x to 2.00x)
                    // Extreme Shock: ¬±150% (0.00x to 2.50x, but min 0.10x for realism)
                    const cpmVolatilityModel = d.cpmVolatilityModel || 'normal';
                    let cpmMin, cpmMax;
                    if (cpmVolatilityModel === 'high') {
                        cpmMin = baseCpm * 0.00; // 0% (can drop to zero in high competition)
                        cpmMax = baseCpm * 2.00; // +100%
                    } else if (cpmVolatilityModel === 'extreme') {
                        cpmMin = Math.max(baseCpm * 0.10, baseCpm * 0.00); // Min 10% of base, but can go lower
                        cpmMax = baseCpm * 2.50; // +150%
                    } else {
                        // Normal Market: ¬±60%
                        cpmMin = baseCpm * 0.40; // -60%
                        cpmMax = baseCpm * 1.60; // +60%
                    }
                    const sCpm = triangular(cpmMin, cpmMax, baseCpm);
                    // Demand/Impressions: ¬±15% (0.85x to 1.15x) - User requested range
                    const demandFactor = triangular(0.85, 1.15, 1.0);
                    // Basket Size (AOV): ¬±10% (0.90x to 1.10x)
                    const sBasketSize = triangular(baseBasketSize * 0.90, baseBasketSize * 1.10, baseBasketSize);
                    // Return Rate: ¬±2% (absolute, not percentage)
                    const sReturnRate = Math.max(0, Math.min(100, triangular(baseReturnRate - 2, baseReturnRate + 2, baseReturnRate)));
                    // Platform Conversion Drop: ¬±10% (applies to CVR)
                    const platformDropFactor = triangular(0.90, 1.10, 1.0);
                    
                    // ===== STEP 2: CALCULATE IMPRESSIONS FROM DEMAND =====
                    // Impressions = Base Impressions √ó Demand Factor (¬±15%)
                    // NOTE: baseImpressions comes from targetBags calculation, but Demand Factor creates variance
                    // This ensures Monte Carlo sensitivity to CTR/CVR changes while allowing demand uncertainty
                    const sImpressions = baseImpressions * demandFactor;
                    
                    // ===== STEP 3: CALCULATE CLICKS =====
                    // Clicks = Impressions √ó CTR (%)
                    // CTR is randomized ¬±25% around baseCtr, so clicks will vary accordingly
                    const sClicks = sImpressions * (sCtr / 100);
                    
                    // ===== STEP 4: CALCULATE ORDERS =====
                    // Orders = Clicks √ó CVR (%) √ó Platform Conversion Drop Factor
                    // CVR is randomized ¬±30% around baseCvr, then adjusted by platform drop (¬±10%)
                    // This ensures orders are calculated purely from traffic, NOT from target orders
                    const adjustedCvr = sCvr * platformDropFactor;
                    const sOrders = sClicks * (adjustedCvr / 100);
                    
                    // ===== STEP 5: CALCULATE ORDERS AFTER RETURNS =====
                    // Orders After Returns = Orders √ó (1 - Return Rate)
                    // Return Rate is randomized ¬±2% (absolute) around baseReturnRate
                    const sOrdersAfterReturns = sOrders * (1 - sReturnRate / 100);
                    
                    // ===== STEP 6: CALCULATE REVENUE =====
                    // Revenue = Orders After Returns √ó Basket Size √ó Price
                    // Basket Size is randomized ¬±10% around baseBasketSize
                    const sUnits = sOrdersAfterReturns * sBasketSize;
                    const sRevenue = sUnits * basePrice; // VAT-inclusive
                    const sRevenueExVat = exVat(sRevenue);
                    
                    // ===== STEP 7: CALCULATE AD SPEND =====
                    // Ad Spend = (Impressions / 1000) √ó CPM
                    // CPM is randomized ¬±20% around baseCpm
                    // This is the key formula: Ad Spend is directly tied to Impressions and CPM
                    const sAdSpend = (sImpressions / 1000) * sCpm; // VAT-inclusive
                    const sAdSpendExVat = exVat(sAdSpend);
                    
                    // ===== STEP 8: CALCULATE ROAS =====
                    const sRoas = sAdSpendExVat > 0 ? sRevenueExVat / sAdSpendExVat : 0;
                    
                    // ===== STEP 9: CALCULATE COSTS =====
                    // Product Cost = Units √ó Product Cost per Unit (Rice + Packaging, ex-VAT)
                    const sProductCost = sUnits * productCostPerUnit;
                    // Variable Cost = Units √ó Variable Cost per Unit (Electricity + Platform Fees, ex-VAT)
                    const sVariableCost = sUnits * variableCostPerUnit;
                    
                    // ===== STEP 10: CALCULATE PROFIT =====
                    // Profit = Revenue - Product Cost - Variable Cost - Ad Spend - Fixed Cost
                    // This is the core profit calculation: all costs are subtracted from revenue
                    // Revenue comes from Orders (from Traffic), Ad Spend comes from Impressions √ó CPM
                    const sEbitda = sRevenueExVat - sProductCost - sVariableCost - sAdSpendExVat - monthlyFixedCash;
                    const sEbitMonthly = sEbitda - monthlyDepreciation - monthlyFinance;
                    const sEbitAnnual = sEbitMonthly * 12;
                    const sTaxAnnual = calcTaxAnnual(sEbitAnnual);
                    const sTaxMonthly = sTaxAnnual / 12;
                    const sNetProfitMonthly = sEbitMonthly - sTaxMonthly;
                    
                    // Store simulation result with all variables for analysis
                    simulationResults.push({
                        profit: sNetProfitMonthly,
                        revenue: sRevenueExVat,
                        adSpend: sAdSpendExVat,
                        roas: sRoas,
                        orders: sOrdersAfterReturns,
                        ctr: sCtr,
                        cvr: adjustedCvr,
                        cpm: sCpm,
                        demand: demandFactor,
                        basketSize: sBasketSize,
                        returnRate: sReturnRate
                    });
                    
                    // Collect data for sensitivity analysis
                    sensitivityData.ctr.values.push(sCtr);
                    sensitivityData.ctr.profits.push(sNetProfitMonthly);
                    sensitivityData.cvr.values.push(adjustedCvr);
                    sensitivityData.cvr.profits.push(sNetProfitMonthly);
                    sensitivityData.cpm.values.push(sCpm);
                    sensitivityData.cpm.profits.push(sNetProfitMonthly);
                    sensitivityData.demand.values.push(demandFactor);
                    sensitivityData.demand.profits.push(sNetProfitMonthly);
                    sensitivityData.basketSize.values.push(sBasketSize);
                    sensitivityData.basketSize.profits.push(sNetProfitMonthly);
                    sensitivityData.price.values.push(basePrice); // Price is not randomized, but track for completeness
                    sensitivityData.price.profits.push(sNetProfitMonthly);
                }
                
                // ===== RISK METRICS CALCULATION =====
                const profits = simulationResults.map(r => r.profit).sort((a, b) => a - b);
                const p5 = profits[Math.floor(iterations * 0.05)];
                const p10 = profits[Math.floor(iterations * 0.1)];
                const p50 = profits[Math.floor(iterations * 0.5)];
                const p90 = profits[Math.floor(iterations * 0.9)];
                const p95 = profits[Math.floor(iterations * 0.95)];
                
                // Probability of Loss
                const lossCount = profits.filter(p => p < 0).length;
                const probabilityOfLoss = (lossCount / iterations) * 100;
                
                // Probability of Hitting Target Profit
                const targetProfitCount = profits.filter(p => p >= targetProfit).length;
                const probabilityOfTargetProfit = (targetProfitCount / iterations) * 100;
                
                // Probability ROAS < Breakeven ROAS
                const roasBelowBreakeven = simulationResults.filter(r => r.roas < targetRoas).length;
                const probabilityRoasBelowBreakeven = (roasBelowBreakeven / iterations) * 100;
                
                // ===== SENSITIVITY ANALYSIS =====
                // Calculate impact contribution of each variable on profit volatility
                // Method: Use Elasticity (% change in profit per 1% change in variable)
                // This is more interpretable and avoids numerical issues with small stdVal
                const calculateImpact = (values, profits) => {
                    const n = values.length;
                    if (n === 0) return 0;
                    
                    // Calculate means
                    const meanVal = values.reduce((a, b) => a + b, 0) / n;
                    const meanProfit = profits.reduce((a, b) => a + b, 0) / n;
                    
                    // Avoid division by zero
                    if (meanVal === 0 || meanProfit === 0) return 0;
                    
                    // Calculate standard deviations
                    const stdVal = Math.sqrt(values.reduce((sum, v) => sum + Math.pow(v - meanVal, 2), 0) / n);
                    const stdProfit = Math.sqrt(profits.reduce((sum, p) => sum + Math.pow(p - meanProfit, 2), 0) / n);
                    
                    if (stdVal === 0 || stdProfit === 0) return 0;
                    
                    // Calculate correlation coefficient (Pearson correlation)
                    const covariance = values.reduce((sum, v, i) => sum + (v - meanVal) * (profits[i] - meanProfit), 0) / n;
                    const correlation = covariance / (stdVal * stdProfit);
                    
                    // Elasticity: % change in profit per 1% change in variable
                    // Formula: elasticity = correlation √ó (stdProfit / meanProfit) / (stdVal / meanVal)
                    // This shows: if variable increases by 1%, profit changes by elasticity%
                    // Example: elasticity = 2.5 means 1% increase in variable ‚Üí 2.5% increase in profit
                    const coefficientOfVariationVal = stdVal / meanVal; // CV of variable
                    const coefficientOfVariationProfit = stdProfit / meanProfit; // CV of profit
                    
                    if (coefficientOfVariationVal === 0) return 0;
                    
                    // Elasticity = correlation √ó (CV_profit / CV_variable)
                    const elasticity = Math.abs(correlation) * (coefficientOfVariationProfit / coefficientOfVariationVal);
                    
                    // Return as percentage
                    return elasticity * 100;
                };
                
                const sensitivityImpacts = {
                    ctr: calculateImpact(sensitivityData.ctr.values, sensitivityData.ctr.profits),
                    cvr: calculateImpact(sensitivityData.cvr.values, sensitivityData.cvr.profits),
                    cpm: calculateImpact(sensitivityData.cpm.values, sensitivityData.cpm.profits),
                    demand: calculateImpact(sensitivityData.demand.values, sensitivityData.demand.profits),
                    basketSize: calculateImpact(sensitivityData.basketSize.values, sensitivityData.basketSize.profits),
                    price: calculateImpact(sensitivityData.price.values, sensitivityData.price.profits)
                };
                
                // Rank by impact
                const rankedImpacts = Object.entries(sensitivityImpacts)
                    .map(([key, value]) => ({ variable: key, impact: value }))
                    .sort((a, b) => b.impact - a.impact);
                
                // ===== GROWTH / SCALE ANALYSIS =====
                // Analyze scaling scenarios when ROAS > Target ROAS
                const avgRoas = simulationResults.reduce((sum, r) => sum + r.roas, 0) / simulationResults.length;
                const scaleScenarios = [];
                
                if (avgRoas > targetRoas) {
                    const scaleFactors = [1.2, 1.5, 2.0]; // +20%, +50%, +100%
                    scaleFactors.forEach(scaleFactor => {
                        // Simulate scaled traffic using same randomization approach
                        // Re-run simulation with scaled impressions to estimate risk
                        const scaledSimulations = [];
                        const sampleSize = 1000; // Smaller sample for scale analysis
                        
                        for (let j = 0; j < sampleSize; j++) {
                            // Use same randomization ranges as main simulation
                            const sCtr = triangular(baseCtr * 0.75, baseCtr * 1.25, baseCtr);
                            const sCvr = triangular(baseCvr * 0.70, baseCvr * 1.30, baseCvr);
                            // CPM: Use same volatility model as main simulation
                            const cpmVolatilityModel = d.cpmVolatilityModel || 'normal';
                            let cpmMin, cpmMax;
                            if (cpmVolatilityModel === 'high') {
                                cpmMin = baseCpm * 0.00;
                                cpmMax = baseCpm * 2.00;
                            } else if (cpmVolatilityModel === 'extreme') {
                                cpmMin = Math.max(baseCpm * 0.10, baseCpm * 0.00);
                                cpmMax = baseCpm * 2.50;
                            } else {
                                cpmMin = baseCpm * 0.40;
                                cpmMax = baseCpm * 1.60;
                            }
                            const sCpm = triangular(cpmMin, cpmMax, baseCpm);
                            const demandFactor = triangular(0.85, 1.15, 1.0);
                            const sBasketSize = triangular(baseBasketSize * 0.90, baseBasketSize * 1.10, baseBasketSize);
                            const sReturnRate = Math.max(0, Math.min(100, triangular(baseReturnRate - 2, baseReturnRate + 2, baseReturnRate)));
                            const platformDropFactor = triangular(0.90, 1.10, 1.0);
                            
                            // Scale impressions
                            const scaledImpressions = baseImpressions * scaleFactor * demandFactor;
                            
                            // Calculate funnel
                            const scaledClicks = scaledImpressions * (sCtr / 100);
                            const adjustedCvr = sCvr * platformDropFactor;
                            const scaledOrders = scaledClicks * (adjustedCvr / 100);
                            const scaledOrdersAfterReturns = scaledOrders * (1 - sReturnRate / 100);
                            const scaledUnits = scaledOrdersAfterReturns * sBasketSize;
                            const scaledRevenue = exVat(scaledUnits * basePrice);
                            const scaledAdSpend = exVat((scaledImpressions / 1000) * sCpm);
                            const scaledProductCost = scaledUnits * productCostPerUnit;
                            const scaledVariableCost = scaledUnits * variableCostPerUnit;
                            
                            const scaledEbitda = scaledRevenue - scaledProductCost - scaledVariableCost - scaledAdSpend - monthlyFixedCash;
                            const scaledEbitMonthly = scaledEbitda - monthlyDepreciation - monthlyFinance;
                            const scaledEbitAnnual = scaledEbitMonthly * 12;
                            const scaledTaxAnnual = calcTaxAnnual(scaledEbitAnnual);
                            const scaledTaxMonthly = scaledTaxAnnual / 12;
                            const scaledNetProfitMonthly = scaledEbitMonthly - scaledTaxMonthly;
                            
                            scaledSimulations.push({
                                profit: scaledNetProfitMonthly,
                                revenue: scaledRevenue,
                                roas: scaledAdSpend > 0 ? scaledRevenue / scaledAdSpend : 0
                            });
                        }
                        
                        // Calculate metrics for scaled scenario
                        const scaledProfits = scaledSimulations.map(s => s.profit).sort((a, b) => a - b);
                        const scaledLossCount = scaledProfits.filter(p => p < 0).length;
                        const scaledLossRisk = (scaledLossCount / sampleSize) * 100;
                        const avgScaledProfit = scaledProfits.reduce((a, b) => a + b, 0) / scaledProfits.length;
                        const avgScaledRevenue = scaledSimulations.reduce((sum, s) => sum + s.revenue, 0) / scaledSimulations.length;
                        const avgScaledRoas = scaledSimulations.reduce((sum, s) => sum + s.roas, 0) / scaledSimulations.length;
                        
                        scaleScenarios.push({
                            scaleFactor: scaleFactor,
                            scalePercent: ((scaleFactor - 1) * 100).toFixed(0),
                            newRevenue: avgScaledRevenue,
                            newProfit: avgScaledProfit,
                            newRoas: avgScaledRoas,
                            risk: scaledLossRisk
                        });
                    });
                }
                
                // ===== HISTOGRAM =====
                const bucketCount = 20;
                const minVal = profits[0];
                const maxVal = profits[profits.length - 1];
                const range = maxVal - minVal;
                const step = range / bucketCount;
                const histogram = Array.from({length: bucketCount}, (_, i) => {
                    const start = minVal + (i * step);
                    const end = start + step;
                    const count = profits.filter(p => p >= start && p < end).length;
                    return { range: `${(start/1000).toFixed(0)}k`, val: start, count };
                });
                
                return {
                    // Percentiles
                    p5, p10, p50, p90, p95,
                    histogram,
                    samples: profits,
                    // Risk Metrics
                    riskMetrics: {
                        probabilityOfLoss,
                        probabilityOfTargetProfit,
                        probabilityRoasBelowBreakeven,
                        worstCase: p5,
                        bestCase: p95
                    },
                    // Sensitivity Analysis
                    sensitivityAnalysis: {
                        rankedImpacts,
                        impacts: sensitivityImpacts
                    },
                    // Growth/Scale Analysis
                    scaleAnalysis: scaleScenarios,
                    // Full simulation data
                    simulationData: simulationResults
                };
            }, [
                // ===== DEPENDENCY SYSTEM: Auto-rerun when any input changes =====
                // Funnel inputs
                c?.funnelMetrics?.impressions, // Base impressions (Demand)
                c?.funnelMetrics?.cpm, // Base CPM
                c?.funnelMetrics?.beRoas, // Breakeven ROAS (for risk analysis)
                d.mktFunnel?.ctr, // Base CTR
                d.mktFunnel?.cvr, // Base CVR
                d.mktFunnel?.basketSize, // Basket Size (AOV)
                d.price, // Price per unit
                // Return Rate
                d.varParams?.returnRate, // Return Rate
                // Cost structure
                d.paddyPrice, // Product Cost (Rice)
                d.yield, // Yield % for product cost calculation
                d.unit?.bag, // Product Cost (Packaging)
                d.unit?.sticker, // Product Cost (Packaging)
                d.varParams?.elecRate, // Variable Cost (Electricity)
                c?.blendedFeePct, // Variable Cost (Platform Fees)
                // Fixed costs
                c?.fixedCashTotal, // Fixed Cost
                c?.annualDepreciation, // Depreciation
                c?.annualFinanceCost, // Finance Cost
                // Target Profit (for probability calculation)
                c?.netProfit, // Target Profit
                // VAT
                d.vatRate, // VAT Rate
                // CPM Volatility Model
                d.cpmVolatilityModel // CPM Volatility Model
            ]);

            useEffect(() => { 
                try {
                    const financials = calculateFinancials(d);
                    setC(financials); 
                } catch (error) {
                    console.error("Error calculating financials:", error);
                    setC(null);
                }
            }, [d, lang]);

            const projection = useMemo(() => {
                if(!c) return { data: [], npv: 0 }; 
                const yrProj = [];
                let yCash = c.cfTotal.cashFinal;
                const y1TaxPaid = (d.taxPaymentMode === 'annual' || d.taxPaymentMode === 'monthly') ? c.annualTax : 0;

                // --- Projection basis ---
                // Use ex-VAT operating model (EBITDA) but keep CASH realistic by estimating VAT cash paid rate from Year 1.
                const vatRate = d.vatRate !== undefined ? d.vatRate : 7;
                const vatMultiplier = 1 + (vatRate / 100);
                const exVat = (amt) => amt / vatMultiplier;
                const y1RevExVat = exVat(c.cfTotal.rev || 0);
                const vatCashRate = y1RevExVat > 0 ? (c.cfTotal.vatPaid || 0) / y1RevExVat : 0; // cash VAT paid per ex-VAT revenue
                const y1VatCash = y1RevExVat * vatCashRate;

                // For the table "exp", we show cash outflows excluding dividends (kept separate in the div column)
                const y1ExpCash = (c.revBreakdown.opVar + c.revBreakdown.opFixed) + y1VatCash + y1TaxPaid + (c.annualFinanceCost || 0) + (c.annualPrincipalPaid || 0);
                yCash -= c.dividendTotal;
                let accumulatedLoss = 0;
                if (c.annualProfitEst < 0) accumulatedLoss = Math.abs(c.annualProfitEst);
                yrProj.push({ y: 1, rev: y1RevExVat, exp: y1ExpCash, ebitda: c.ebitda, dep: c.annualDepreciation, tax: c.annualTax, net: c.netProfit, div: c.dividendTotal, cash: yCash, taxSaving: 0 });

                let prevRevExVat = y1RevExVat;
                // Use Year-1 ex-VAT OpEx split from revBreakdown
                let prevVarExVat = c.revBreakdown.opVar;
                let prevFixedExVat = c.revBreakdown.opFixed;
                let prevTaxLiability = d.taxPaymentMode === 'deferred' ? c.annualTax : 0;
                let remainingLoan = d.loan.amount - c.annualPrincipalPaid;
                let npv = -c.totalSources; 
                const discountRate = (d.discountRate || 10) / 100;
                const calcTax = (profit) => {
                    if(profit <= 300000) return 0;
                    let tax = 0;
                    if(profit > 300000) tax += Math.min(profit - 300000, 2700000) * 0.15;
                    if(profit > 3000000) tax += (profit - 3000000) * 0.20;
                    return tax;
                };
                for(let y=2;y<=5;y++) {
                    const growthRate = d.growth / 100;
                    const inflationRate = d.inflation / 100;

                    // Ex-VAT operating projection
                    const yRevExVat = prevRevExVat * (1 + growthRate);
                    const yVarExVat = prevVarExVat * (1 + growthRate); 
                    const yFixedExVat = prevFixedExVat * (1 + inflationRate); 
                    const yEbitda = yRevExVat - yVarExVat - yFixedExVat;

                    // Estimate VAT cash paid based on Year-1 pattern (includes carry-forward behavior implicitly from Yr1 actuals)
                    const yVatCash = yRevExVat * vatCashRate;
                    const annualPrincipal = c.annualPrincipalPaid;
                    remainingLoan = Math.max(0, remainingLoan - annualPrincipal);
                    const yInterest = remainingLoan * (d.loan.rate / 100); 
                    const yPrincipal = remainingLoan > 0 ? annualPrincipal : 0;
                    const yTaxable = yEbitda - c.annualDepreciation - yInterest;
                    let taxableAfterShield = yTaxable;
                    let usedLoss = 0;
                    if (yTaxable > 0 && accumulatedLoss > 0) {
                        usedLoss = Math.min(yTaxable, accumulatedLoss);
                        taxableAfterShield = yTaxable - usedLoss;
                        accumulatedLoss -= usedLoss;
                    } else if (yTaxable < 0) {
                        accumulatedLoss += Math.abs(yTaxable);
                        taxableAfterShield = 0;
                    }
                    const taxNormal = calcTax(yTaxable > 0 ? yTaxable : 0);
                    const taxShielded = calcTax(taxableAfterShield);
                    const taxSaving = taxNormal - taxShielded;
                    const yTax = taxShielded;
                    let taxPaidThisYear = d.taxPaymentMode === 'deferred' ? prevTaxLiability : yTax;
                    if (d.taxPaymentMode === 'deferred') prevTaxLiability = yTax;
                    const yNetAcc = yTaxable - yTax; 
                    const yDiv = yNetAcc > 0 ? yNetAcc * (d.dividend.payout / 100) : 0;

                    yCash += (yEbitda - yVatCash - taxPaidThisYear - yDiv - yInterest - yPrincipal);
                    const yExpCash = (yVarExVat + yFixedExVat) + yVatCash + taxPaidThisYear + yInterest + yPrincipal;
                    yrProj.push({ y, rev: yRevExVat, exp: yExpCash, ebitda: yEbitda, dep: c.annualDepreciation, tax: yTax, net: yNetAcc, div: yDiv, cash: yCash, taxSaving });

                    prevRevExVat = yRevExVat;
                    prevVarExVat = yVarExVat;
                    prevFixedExVat = yFixedExVat;
                }
                yrProj.forEach((yr) => {
                      const cashFlow = yr.ebitda - yr.tax;
                      npv += cashFlow / Math.pow(1 + discountRate, yr.y);
                });
                return { data: yrProj, npv };
            }, [c, d.growth, d.inflation, d.dividend.payout, d.taxPaymentMode, d.discountRate, d.loan.amount, d.loan.rate, d.loan.term, lang]);

            if(c && projection.data.length > 0) {
                c.yrProj = projection;
            }

            if(!c) return <div className="p-10 text-center text-slate-500">Loading System...</div>;
            
            // Tooltip content function for Executive Summary metrics - must be after c is calculated
            const getTooltipContent = (metric, c) => {
                if (!c) return null;
                const content = {
                    netProfit: {
                        th: {
                            title: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Net Profit)",
                            meaning: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏£‡∏ß‡∏°‡∏†‡∏≤‡∏©‡∏µ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤",
                            advice: c.netProfit > 0 
                                ? `‚úÖ ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ ${fmt(c.netProfit)} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≥‡πÑ‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≥‡πÑ‡∏£`
                                : `‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô ${fmt(Math.abs(c.netProfit))} ‡∏ö‡∏≤‡∏ó\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£`
                        },
                        cn: {
                            title: "ÂáÄÂà©Ê∂¶ (Net Profit)",
                            meaning: "Êâ£Èô§ÊâÄÊúâË¥πÁî®ÔºàÂåÖÊã¨Á®éË¥πÂíåÊäòÊóßÔºâÂêéÁöÑÂáÄÂà©Ê∂¶",
                            advice: c.netProfit > 0 
                                ? `‚úÖ ÂæàÂ•ΩÔºÅÂáÄÂà©Ê∂¶ ${fmt(c.netProfit)} Ê≥∞Èì¢ÔºåË°®Êòé‰∏öÂä°ÁõàÂà©\nüí° Âª∫ËÆÆÔºöÂä™ÂäõÁª¥ÊåÅËøô‰∏™Âà©Ê∂¶Ê∞¥Âπ≥ÔºåÊàñÂ¢ûÂä†ÈîÄÂîÆÈ¢ù‰ª•ÊèêÈ´òÂà©Ê∂¶`
                                : `‚ö†Ô∏è ‰ªç‰∫èÊçü ${fmt(Math.abs(c.netProfit))} Ê≥∞Èì¢\nüí° Âª∫ËÆÆÔºöÈôç‰ΩéÊàêÊú¨ÊàñÂ¢ûÂä†ÈîÄÂîÆÈ¢ù‰ª•ÂÆûÁé∞ÁõàÂà©`
                        }
                    },
                    netMargin: {
                        th: {
                            title: "Net Margin (‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥)",
                            meaning: "‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£",
                            advice: c.netMargin > 10 
                                ? `‚úÖ ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! Net Margin ${(c.netMargin || 0).toFixed(1)}% ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 10% ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£‡∏î‡∏µ\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏° margin`
                                : c.netMargin > 5 
                                ? `‚ö†Ô∏è Net Margin ${(c.netMargin || 0).toFixed(1)}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏° margin ‡πÇ‡∏î‡∏¢‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢`
                                : `‚ùå Net Margin ${(c.netMargin || 0).toFixed(1)}% ‡∏ï‡πà‡∏≥‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô`
                        },
                        cn: {
                            title: "Net Margin (ÂáÄÂà©Ê∂¶Áéá)",
                            meaning: "ÂáÄÂà©Ê∂¶Âç†ÈîÄÂîÆÈ¢ùÁöÑÁôæÂàÜÊØîÔºåË°°ÈáèÁõàÂà©ËÉΩÂäõ",
                            advice: c.netMargin > 10 
                                ? `‚úÖ ÂæàÂ•ΩÔºÅNet Margin ${(c.netMargin || 0).toFixed(1)}% È´ò‰∫é 10%ÔºåË°®Êòé‰∏öÂä°ÁõàÂà©ËâØÂ•Ω\nüí° Âª∫ËÆÆÔºö‰øùÊåÅËøô‰∏™Ê∞¥Âπ≥ÔºåÊàñÊèêÈ´òÊïàÁéá‰ª•Â¢ûÂä†Âà©Ê∂¶Áéá`
                                : c.netMargin > 5 
                                ? `‚ö†Ô∏è Net Margin ${(c.netMargin || 0).toFixed(1)}% Â§Ñ‰∫é‰∏≠Á≠âÊ∞¥Âπ≥\nüí° Âª∫ËÆÆÔºöÈÄöËøáÈôç‰ΩéÊàêÊú¨ÊàñÊèêÈ´òÂîÆ‰ª∑Êù•Â¢ûÂä†Âà©Ê∂¶Áéá`
                                : `‚ùå Net Margin ${(c.netMargin || 0).toFixed(1)}% Â§™‰Ωé\nüí° Âª∫ËÆÆÔºöÈúÄË¶ÅÁ¥ßÊÄ•Èôç‰ΩéÊàêÊú¨ÊàñÊèêÈ´òÂîÆ‰ª∑`
                        }
                    },
                    grossMargin: {
                        th: {
                            title: "Gross Margin (‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô)",
                            meaning: "‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ ‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£, ‡∏ñ‡∏∏‡∏á, ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü, ‡πÅ‡∏•‡∏∞ Platform Fee",
                            advice: c.grossMargin > 30 
                                ? `‚úÖ ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! Gross Margin ${(c.grossMargin || 0).toFixed(1)}% ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 30%\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡∏µ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô Marketing ‡πÅ‡∏•‡∏∞ Fixed Cost`
                                : c.grossMargin > 20 
                                ? `‚ö†Ô∏è Gross Margin ${(c.grossMargin || 0).toFixed(1)}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢`
                                : `‚ùå Gross Margin ${(c.grossMargin || 0).toFixed(1)}% ‡∏ï‡πà‡∏≥‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢`
                        },
                        cn: {
                            title: "Gross Margin (ÊØõÂà©Áéá)",
                            meaning: "ÊØõÂà©ÁéáÂç†ÈîÄÂîÆÈ¢ùÁöÑÁôæÂàÜÊØîÔºåÊâ£Èô§Â§ßÁ±≥„ÄÅÂåÖË£Ö„ÄÅÁîµË¥πÂíåÂπ≥Âè∞Ë¥πÂêéÁöÑÂà©Ê∂¶",
                            advice: c.grossMargin > 30 
                                ? `‚úÖ ÂæàÂ•ΩÔºÅGross Margin ${(c.grossMargin || 0).toFixed(1)}% È´ò‰∫é 30%\nüí° Âª∫ËÆÆÔºöÊØõÂà©ÁéáËâØÂ•ΩÔºåÂèØ‰ª•Áî®‰∫éËê•ÈîÄÂíåÂõ∫ÂÆöÊàêÊú¨ÊîØÂá∫`
                                : c.grossMargin > 20 
                                ? `‚ö†Ô∏è Gross Margin ${(c.grossMargin || 0).toFixed(1)}% Â§Ñ‰∫é‰∏≠Á≠âÊ∞¥Âπ≥\nüí° Âª∫ËÆÆÔºöËÄÉËôëÈôç‰ΩéÊàêÊú¨ÊàñÊèêÈ´òÂîÆ‰ª∑`
                                : `‚ùå Gross Margin ${(c.grossMargin || 0).toFixed(1)}% Â§™‰Ωé\nüí° Âª∫ËÆÆÔºöÂøÖÈ°ªÈôç‰ΩéÁîü‰∫ßÊàêÊú¨ÊàñÊèêÈ´òÂîÆ‰ª∑`
                        }
                    },
                    contributionMargin: {
                        th: {
                            title: "Contribution Margin (‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤)",
                            meaning: "‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Marketing) ‡πÅ‡∏•‡πâ‡∏ß ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏•‡∏±‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î",
                            advice: c.contributionMargin > 20 
                                ? `‚úÖ ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! Contribution Margin ${(c.contributionMargin || 0).toFixed(1)}% ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 20%\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ Fixed Cost ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£`
                                : c.contributionMargin > 10 
                                ? `‚ö†Ô∏è Contribution Margin ${(c.contributionMargin || 0).toFixed(1)}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î`
                                : `‚ùå Contribution Margin ${(c.contributionMargin || 0).toFixed(1)}% ‡∏ï‡πà‡∏≥‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢`
                        },
                        cn: {
                            title: "Contribution Margin (Êâ£Èô§ÂπøÂëäÂêéÁöÑÂà©Ê∂¶Áéá)",
                            meaning: "Êâ£Èô§ÂπøÂëäË¥πÁî®ÂêéÁöÑÂà©Ê∂¶ÁéáÁôæÂàÜÊØîÔºåË°°ÈáèÊîØ‰ªòÂπøÂëäË¥πÁî®ÂêéÁöÑÁõàÂà©ËÉΩÂäõ",
                            advice: c.contributionMargin > 20 
                                ? `‚úÖ ÂæàÂ•ΩÔºÅContribution Margin ${(c.contributionMargin || 0).toFixed(1)}% È´ò‰∫é 20%\nüí° Âª∫ËÆÆÔºöÊâ£Èô§ÂπøÂëäË¥πÁî®Âêé‰ªçÊúâÂà©Ê∂¶ÔºåÂèØ‰ª•Áî®‰∫éÂõ∫ÂÆöÊàêÊú¨ÂíåÁõàÂà©`
                                : c.contributionMargin > 10 
                                ? `‚ö†Ô∏è Contribution Margin ${(c.contributionMargin || 0).toFixed(1)}% Â§Ñ‰∫é‰∏≠Á≠âÊ∞¥Âπ≥\nüí° Âª∫ËÆÆÔºöËÄÉËôëÈôç‰ΩéÂπøÂëäË¥πÁî®ÊàñÊèêÈ´òËê•ÈîÄÊïàÁéá`
                                : `‚ùå Contribution Margin ${(c.contributionMargin || 0).toFixed(1)}% Â§™‰Ωé\nüí° Âª∫ËÆÆÔºöÂπøÂëäË¥πÁî®ËøáÈ´òÔºåÂøÖÈ°ªÈôç‰ΩéÂπøÂëäË¥πÁî®ÊàñÊèêÈ´òÂîÆ‰ª∑`
                        }
                    },
                    dscr: {
                        th: {
                            title: "DSCR (Debt Service Coverage Ratio)",
                            meaning: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô EBITDA ‡∏ï‡πà‡∏≠‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏õ‡∏µ ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ",
                            advice: c.dscr >= 1.25 
                                ? `‚úÖ ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! DSCR ${(c.dscr || 0).toFixed(2)} ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 1.25 ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏à‡∏∞‡∏ä‡∏≠‡∏ö\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å`
                                : c.dscr >= 1 
                                ? `‚ö†Ô∏è DSCR ${(c.dscr || 0).toFixed(2)} ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡πà‡∏≥ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 1.25\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏° EBITDA ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ DSCR ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô`
                                : `‚ùå DSCR ${(c.dscr || 0).toFixed(2)} ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 1 ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô`
                        },
                        cn: {
                            title: "DSCR (ÂÄ∫Âä°ÂÅøËøòË¶ÜÁõñÁéá)",
                            meaning: "EBITDA ‰∏éÂπ¥Â∫¶ÂÄ∫Âä°ÂÅøËøòÈ¢ùÁöÑÊØîÁéáÔºåË°°ÈáèÂÅøËøòÂÄ∫Âä°ÁöÑËÉΩÂäõ",
                            advice: c.dscr >= 1.25 
                                ? `‚úÖ ÂæàÂ•ΩÔºÅDSCR ${(c.dscr || 0).toFixed(2)} È´ò‰∫é 1.25ÔºåÈì∂Ë°å‰ºöÂñúÊ¨¢\nüí° Âª∫ËÆÆÔºöÂÅøËøòÂÄ∫Âä°ÁöÑËÉΩÂäõÈùûÂ∏∏Â•Ω`
                                : c.dscr >= 1 
                                ? `‚ö†Ô∏è DSCR ${(c.dscr || 0).toFixed(2)} Â§Ñ‰∫éËæÉ‰ΩéÊ∞¥Âπ≥ÔºåÂ∫îÊèêÈ´òÂà∞ 1.25 ‰ª•‰∏ä\nüí° Âª∫ËÆÆÔºöÂä™ÂäõÂ¢ûÂä† EBITDA ÊàñÂáèÂ∞ëÂÄ∫Âä°‰ª•ÊèêÈ´ò DSCR`
                                : `‚ùå DSCR ${(c.dscr || 0).toFixed(2)} ‰Ωé‰∫é 1ÔºåÊó†Ê≥ïÂÅøËøòÂÄ∫Âä°\nüí° Âª∫ËÆÆÔºöÂøÖÈ°ªÁ¥ßÊÄ•Â¢ûÂä†ÈîÄÂîÆÈ¢ùÊàñÈôç‰ΩéÊàêÊú¨`
                        }
                    },
                    priceExVat: {
                        th: {
                            title: t('priceExVat') + " - ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á",
                            meaning: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏´‡∏±‡∏Å VAT ‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á",
                            advice: `üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á: ${fmtDec(c.unitEco?.revUnitExVat || 0)} ‡∏ö‡∏≤‡∏ó\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏Ñ‡∏ß‡∏£‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏° (Variable + Fixed) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£`
                        },
                        cn: {
                            title: t('priceExVat') + " - ÊØèË¢ãÂîÆ‰ª∑",
                            meaning: "Êâ£Èô§Â¢ûÂÄºÁ®éÂêéÁöÑÊØèË¢ãÂîÆ‰ª∑ÔºåÁî®‰∫éËÆ°ÁÆóÁúüÂÆûÂà©Ê∂¶",
                            advice: `üí∞ ÊØèË¢ãÂîÆ‰ª∑: ${fmtDec(c.unitEco?.revUnitExVat || 0)} Ê≥∞Èì¢\nüí° Âª∫ËÆÆÔºöÊ≠§‰ª∑Ê†ºÂ∫îÈ´ò‰∫éÊÄªÊàêÊú¨ÔºàÂèòÂä®+Âõ∫ÂÆöÔºâ‰ª•ÂÆûÁé∞ÁõàÂà©`
                        }
                    },
                    varCostNoAds: {
                        th: {
                            title: "Var/Bag (no ads) - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏±‡∏ô‡πÅ‡∏õ‡∏£‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤)",
                            meaning: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏±‡∏ô‡πÅ‡∏õ‡∏£‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ ‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£, ‡∏ñ‡∏∏‡∏á, ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü, Platform Fee",
                            advice: `üìä ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏±‡∏ô‡πÅ‡∏õ‡∏£‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á: ${fmtDec(c.unitEco?.varCostNoAdsUnitExVat || 0)} ‡∏ö‡∏≤‡∏ó\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏ß‡∏£‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏ß‡πà‡∏≤ 60-70% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ Gross Margin ‡∏ó‡∏µ‡πà‡∏î‡∏µ`
                        },
                        cn: {
                            title: "Var/Bag (no ads) - ÊØèË¢ãÂèòÂä®ÊàêÊú¨Ôºà‰∏çÂê´ÂπøÂëäÔºâ",
                            meaning: "Êâ£Èô§ÂπøÂëäË¥πÁî®ÂâçÁöÑÊØèË¢ãÂèòÂä®ÊàêÊú¨ÔºåÂåÖÊã¨Â§ßÁ±≥„ÄÅÂåÖË£Ö„ÄÅÁîµË¥πÂíåÂπ≥Âè∞Ë¥π",
                            advice: `üìä ÊØèË¢ãÂèòÂä®ÊàêÊú¨: ${fmtDec(c.unitEco?.varCostNoAdsUnitExVat || 0)} Ê≥∞Èì¢\nüí° Âª∫ËÆÆÔºöÊ≠§ÊàêÊú¨Â∫î‰Ωé‰∫éÂîÆ‰ª∑ÁöÑ 60-70% ‰ª•Ëé∑ÂæóËâØÂ•ΩÁöÑÊØõÂà©Áéá`
                        }
                    },
                    grossCmBag: {
                        th: {
                            title: t('grossCmBag') + " - ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á",
                            meaning: "‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á (‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏±‡∏ô‡πÅ‡∏õ‡∏£) ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤",
                            advice: `üíµ ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á: ${fmtDec(c.unitEco?.grossCmUnitExVat || 0)} ‡∏ö‡∏≤‡∏ó\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏Å‡∏≥‡πÑ‡∏£‡∏ô‡∏µ‡πâ‡∏Ñ‡∏ß‡∏£‡∏™‡∏π‡∏á‡∏û‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡∏∞ Fixed Cost ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥`
                        },
                        cn: {
                            title: t('grossCmBag') + " - ÊØèË¢ãÊØõÂà©Ê∂¶",
                            meaning: "ÊØèË¢ãÊØõÂà©Ê∂¶ÔºàÂîÆ‰ª∑ - ÂèòÂä®ÊàêÊú¨ÔºâÔºåÊâ£Èô§ÂπøÂëäË¥πÁî®Ââç",
                            advice: `üíµ ÊØèË¢ãÊØõÂà©Ê∂¶: ${fmtDec(c.unitEco?.grossCmUnitExVat || 0)} Ê≥∞Èì¢\nüí° Âª∫ËÆÆÔºöÊ≠§Âà©Ê∂¶Â∫îË∂≥Â§üÈ´ò‰ª•Ë¶ÜÁõñÂπøÂëäË¥πÁî®ÂíåÂõ∫ÂÆöÊàêÊú¨ÔºåÂπ∂‰ªçÊúâÂáÄÂà©Ê∂¶`
                        }
                    },
                    adsBag: {
                        th: {
                            title: t('adsBag') + " - ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á",
                            meaning: "‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Marketing) ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á ‡∏°‡∏≤‡∏à‡∏≤‡∏Å Marketing % √ó ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢",
                            advice: `üì¢ ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á: ${fmtDec(c.unitEco?.adsUnitExVat || 0)} ‡∏ö‡∏≤‡∏ó\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Ñ‡∏ß‡∏£‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 15-20% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ Contribution Margin ‡∏ó‡∏µ‡πà‡∏î‡∏µ`
                        },
                        cn: {
                            title: t('adsBag') + " - ÊØèË¢ãÂπøÂëäË¥πÁî®",
                            meaning: "ÊØèË¢ãÂπøÂëäË¥πÁî®ÔºàËê•ÈîÄÔºâÔºåÊù•Ëá™Ëê•ÈîÄÁôæÂàÜÊØî √ó ÂîÆ‰ª∑",
                            advice: `üì¢ ÊØèË¢ãÂπøÂëäË¥πÁî®: ${fmtDec(c.unitEco?.adsUnitExVat || 0)} Ê≥∞Èì¢\nüí° Âª∫ËÆÆÔºöÂπøÂëäË¥πÁî®‰∏çÂ∫îË∂ÖËøáÂîÆ‰ª∑ÁöÑ 15-20% ‰ª•Ëé∑ÂæóËâØÂ•ΩÁöÑË¥°ÁåÆÂà©Ê∂¶Áéá`
                        }
                    },
                    cacOrder: {
                        th: {
                            title: "CAC/Order - Customer Acquisition Cost ‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå",
                            meaning: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå)",
                            advice: `üéØ CAC ‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå: ${fmtDec(c.unitEco?.cpaExVat || 0)} ‡∏ö‡∏≤‡∏ó\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: CAC ‡∏Ñ‡∏ß‡∏£‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ LTV (Customer Lifetime Value) ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡πÄ‡∏ó‡πà‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô`
                        },
                        cn: {
                            title: "CAC/Order - ÊØè‰∏™ËÆ¢ÂçïÁöÑÂÆ¢Êà∑Ëé∑ÂèñÊàêÊú¨",
                            meaning: "ÊØè‰∏™ËÆ¢ÂçïÁöÑÂÆ¢Êà∑Ëé∑ÂèñÊàêÊú¨ÔºàÊØè‰∏™ËÆ¢ÂçïÁöÑÂπøÂëäË¥πÁî®Ôºâ",
                            advice: `üéØ ÊØè‰∏™ËÆ¢ÂçïÁöÑ CAC: ${fmtDec(c.unitEco?.cpaExVat || 0)} Ê≥∞Èì¢\nüí° Âª∫ËÆÆÔºöCAC Â∫î‰Ωé‰∫é LTVÔºàÂÆ¢Êà∑ÁªàË∫´‰ª∑ÂÄºÔºâËá≥Â∞ë 3 ÂÄçÔºå‰ª•‰Ωø‰∏öÂä°ÂèØÊåÅÁª≠ÂèëÂ±ï`
                        }
                    }
                };
                return content[metric] || null;
            };

            // Cost Structure: Use VAT-inclusive values for Marketing and Platform to match Expenses and Channel Mix display
            // Note: Expenses section shows c.mktTotal (VAT-inclusive) and c.blendedMktPct (percentage of sales)
            // Channel Mix shows c.blendedMktPct and c.blendedFeePct (percentages of sales)
            // Pie Chart should show VAT-inclusive values for Marketing and Platform to match these displays
            const vatRate = d.vatRate !== undefined ? d.vatRate : 7;
            const vatMultiplier = 1 + (vatRate / 100);
            const exVat = (amt) => amt / vatMultiplier;
            const packExVat = exVat(c.revBreakdown.packCost || 0);
            const elecExVat = exVat(c.elecTotal || 0);
            // Use VAT-inclusive for Marketing and Platform to match Expenses/Channel Mix
            const platformTotalVatInclusive = c.platformTotal || 0;
            const mktTotalVatInclusive = c.mktTotal || 0;
            // vatableFixed = fixedCostItems * (vatableFixedPercent / 100)
            const vatableFixedPercent = d.fixedParams?.vatablePercent || 0;
            const vatableFixed = (c.revBreakdown.otherFixed || 0) * (vatableFixedPercent / 100);
            const vatableFixedExVat = exVat(vatableFixed);
            // Non-vatable fixed = fixedCostItems - vatableFixed
            const nonVatableFixed = (c.revBreakdown.otherFixed || 0) - vatableFixed;
            
            // Calculate costData: Use ex-VAT for all vatable expenses to match revBreakdown.opCost
            // Note: Pie Chart shows ex-VAT costs, but percentages displayed elsewhere may show VAT-inclusive % of sales
            const mktTotalExVat = exVat(c.mktTotal || 0);
            const platformTotalExVat = exVat(c.platformTotal || 0);
            const costData = [
                { name: t('rice'), value: c.revBreakdown.riceCost }, // No VAT
                { name: t('bag'), value: packExVat }, // ex-VAT
                { name: t('marketing'), value: mktTotalExVat }, // ex-VAT to match opCost
                { name: t('platform'), value: platformTotalExVat }, // ex-VAT to match opCost
                { name: t('elec'), value: elecExVat }, // ex-VAT
                { name: t('salary'), value: c.salaryTotal }, // No VAT
                { name: t('misc'), value: nonVatableFixed + vatableFixedExVat }, // nonVatableFixed + vatableFixedExVat (both ex-VAT)
            ];
            
            // Verify: costData total should equal revBreakdown.opCost
            // costDataTotal = riceTotal + packExVat + mktExVat + platformExVat + elecExVat + salaryTotal + nonVatableFixed + vatableFixedExVat
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + salaryTotal + (fixedCostItems - vatableFixed) + vatableFixed/1.07
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal + vatableFixed)/1.07 + salaryTotal + fixedCostItems - vatableFixed
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems - vatableFixed*(1 - 1/1.07)
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems - vatableFixed*(7/107)
            // But revBreakdown.opCost = riceTotal + vatableExpenses/1.07 + fixedCashTotal
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems
            // Difference = vatableFixed*(7/107) which is the VAT portion of vatableFixed
            // This is expected: costData shows ex-VAT costs, but vatableFixed in opCost is already ex-VAT via vatableExpenses
            // So costData should match opCost exactly ‚úì
            
            // Additional verification: Ensure costData total matches opCost (with small rounding tolerance)
            const costDataTotal = costData.reduce((sum, item) => sum + (item.value || 0), 0);
            const opCostFromRevBreakdown = c.revBreakdown?.opCost || 0;
            // If there's a significant difference (> 1 THB), log for debugging
            if (Math.abs(costDataTotal - opCostFromRevBreakdown) > 1) {
                console.warn('Cost Structure mismatch:', {
                    costDataTotal,
                    opCostFromRevBreakdown,
                    difference: costDataTotal - opCostFromRevBreakdown,
                    costDataBreakdown: costData.map(item => ({ name: item.name, value: item.value }))
                });
            }
            
            // Verify: costData total should equal revBreakdown.opCost (within rounding)
            // costDataTotal = riceTotal + packExVat + mktExVat + platformExVat + elecExVat + salaryTotal + nonVatableFixed + vatableFixedExVat
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal + vatableFixed)/1.07 + salaryTotal + (fixedCostItems - vatableFixed)
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + vatableFixed/1.07 + salaryTotal + fixedCostItems - vatableFixed
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + salaryTotal + fixedCostItems - vatableFixed*(1 - 1/1.07)
            // = riceTotal + (vatableExpenses - vatableFixed)/1.07 + salaryTotal + fixedCostItems - vatableFixed*(7/107)
            // = riceTotal + (vatableExpenses - vatableFixed)/1.07 + salaryTotal + fixedCostItems - vatableFixed*(7/107)
            // = riceTotal + vatableExpenses/1.07 - vatableFixed/1.07 + salaryTotal + fixedCostItems - vatableFixed*(7/107)
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems - vatableFixed*(7/107 + 7/107)
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems - vatableFixed*(14/107)
            // But revBreakdown.opCost = riceTotal + vatableExpenses/1.07 + fixedCashTotal
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems
            // So we need: fixedCostItems - vatableFixed*(14/107) = fixedCostItems
            // Which means: vatableFixed*(14/107) = 0, which is only true if vatableFixed = 0
            
            // Actually, let me recalculate more carefully:
            // revBreakdown.opCost = riceTotal + (vatableExpenses - totalVatIn) + fixedCashTotal
            // = riceTotal + vatableExpenses/1.07 + fixedCashTotal
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal + vatableFixed)/1.07 + salaryTotal + fixedCostItems
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal)/1.07 + vatableFixed/1.07 + salaryTotal + fixedCostItems
            
            // costData total = riceTotal + packExVat + mktExVat + platformExVat + elecExVat + salaryTotal + nonVatableFixed + vatableFixedExVat
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + salaryTotal + (fixedCostItems - vatableFixed) + vatableFixed/1.07
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + salaryTotal + fixedCostItems - vatableFixed + vatableFixed/1.07
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + salaryTotal + fixedCostItems - vatableFixed*(1 - 1/1.07)
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + salaryTotal + fixedCostItems - vatableFixed*(7/107)
            
            // The difference is: vatableFixed/1.07 vs -vatableFixed*(7/107)
            // vatableFixed/1.07 = vatableFixed * 100/107
            // -vatableFixed*(7/107) = -vatableFixed * 7/107
            // Difference = vatableFixed * (100/107 + 7/107) = vatableFixed * 107/107 = vatableFixed
            
            // So costData total = revBreakdown.opCost - vatableFixed
            // We need to add vatableFixed back, but as ex-VAT: vatableFixed/1.07
            // Wait, that's already included as vatableFixedExVat...
            
            // Let me recalculate:
            // costData = riceTotal + packExVat + mktExVat + platformExVat + elecExVat + salaryTotal + nonVatableFixed + vatableFixedExVat
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + salaryTotal + (fixedCostItems - vatableFixed) + vatableFixed/1.07
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal + vatableFixed)/1.07 + salaryTotal + fixedCostItems - vatableFixed
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems - vatableFixed
            // = revBreakdown.opCost - vatableFixed
            
            // So we're missing vatableFixed! But vatableFixed is VAT-inclusive, so we should add vatableFixedExVat which we already have...
            // The issue is: we subtract vatableFixed (VAT-inclusive) but add vatableFixedExVat (ex-VAT)
            // So: -vatableFixed + vatableFixedExVat = -vatableFixed + vatableFixed/1.07 = -vatableFixed*(1 - 1/1.07) = -vatableFixed*(7/107)
            
            // So costData total = revBreakdown.opCost - vatableFixed*(7/107)
            // To fix: we should NOT subtract vatableFixed from nonVatableFixed, or we should add the VAT portion back
            
            // Actually, the correct way:
            // fixedCostItems = nonVatableFixed + vatableFixed (VAT-inclusive)
            // In opCost: fixedCostItems is included as-is (no VAT deduction for non-vatable part)
            // But vatableFixed is included in vatableExpenses which gets converted to ex-VAT
            // So: opCost includes: nonVatableFixed + vatableFixed/1.07
            
            // So costData should be:
            // riceTotal + packExVat + mktExVat + platformExVat + elecExVat + salaryTotal + nonVatableFixed + vatableFixedExVat
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal + vatableFixed)/1.07 + salaryTotal + (fixedCostItems - vatableFixed) + vatableFixed/1.07
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems - vatableFixed + vatableFixed/1.07
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems - vatableFixed*(1 - 1/1.07)
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems - vatableFixed*(7/107)
            
            // But opCost = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems
            // So we're short by vatableFixed*(7/107)
            
            // The fix: nonVatableFixed should be fixedCostItems (not fixedCostItems - vatableFixed)
            // Because vatableFixed is already converted to ex-VAT in vatableFixedExVat
            // So: nonVatableFixed + vatableFixedExVat = (fixedCostItems - vatableFixed) + vatableFixed/1.07
            // But we need: fixedCostItems = (fixedCostItems - vatableFixed) + vatableFixed
            // So we need to add back: vatableFixed - vatableFixed/1.07 = vatableFixed*(7/107)
            
            // Actually, let me think differently:
            // opCost = riceTotal + (vatableExpenses - totalVatIn) + fixedCashTotal
            // = riceTotal + vatableExpenses/1.07 + fixedCashTotal
            // vatableExpenses = packTotal + elecTotal + platformTotal + mktTotal + vatableFixed
            // fixedCashTotal = salaryTotal + fixedCostItems
            
            // So opCost = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal + vatableFixed)/1.07 + salaryTotal + fixedCostItems
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal)/1.07 + vatableFixed/1.07 + salaryTotal + fixedCostItems
            
            // costData should match this:
            // riceTotal + packExVat + mktExVat + platformExVat + elecExVat + salaryTotal + fixedCostItems representation
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + salaryTotal + (nonVatableFixed + vatableFixedExVat)
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal)/1.07 + salaryTotal + (fixedCostItems - vatableFixed) + vatableFixed/1.07
            // = riceTotal + (packTotal + mktTotal + platformTotal + elecTotal + vatableFixed)/1.07 + salaryTotal + fixedCostItems - vatableFixed
            // = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems - vatableFixed
            
            // So we're missing vatableFixed! The issue is we subtract vatableFixed but only add vatableFixed/1.07
            // We need: fixedCostItems = nonVatableFixed + vatableFixed
            // But we have: nonVatableFixed + vatableFixedExVat = (fixedCostItems - vatableFixed) + vatableFixed/1.07
            // = fixedCostItems - vatableFixed + vatableFixed/1.07
            // = fixedCostItems - vatableFixed*(1 - 1/1.07)
            // = fixedCostItems - vatableFixed*(7/107)
            
            // To fix: we should use fixedCostItems directly for non-vatable part, and vatableFixedExVat for vatable part
            // But fixedCostItems includes both vatableFixed and nonVatableFixed
            // So: nonVatableFixed = fixedCostItems - vatableFixed
            // And we need: nonVatableFixed + vatableFixedExVat = fixedCostItems
            // So: (fixedCostItems - vatableFixed) + vatableFixed/1.07 = fixedCostItems
            // Which means: -vatableFixed + vatableFixed/1.07 = 0
            // Which means: vatableFixed*(1/1.07 - 1) = 0
            // Which is false unless vatableFixed = 0
            
            // The correct approach:
            // opCost includes fixedCostItems as-is (no VAT conversion for the whole thing)
            // But vatableFixed is included in vatableExpenses which gets converted
            // So in opCost: fixedCostItems = nonVatableFixed + vatableFixed (but vatableFixed is converted via vatableExpenses)
            // Actually no: fixedCashTotal = salaryTotal + fixedCostItems (no conversion)
            // And vatableFixed is in vatableExpenses which gets converted
            // So: opCost = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal + vatableFixed)/1.07 + salaryTotal + fixedCostItems
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal)/1.07 + vatableFixed/1.07 + salaryTotal + fixedCostItems
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal)/1.07 + vatableFixed/1.07 + salaryTotal + (nonVatableFixed + vatableFixed)
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal)/1.07 + salaryTotal + nonVatableFixed + vatableFixed/1.07 + vatableFixed
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal)/1.07 + salaryTotal + nonVatableFixed + vatableFixed*(1 + 1/1.07)
            
            // This doesn't match either...
            
            // Let me re-read the code:
            // vatableExpenses = packTotal + elecTotal + platformTotal + mktTotal + vatableFixed
            // totalVatIn = vatableExpenses - (vatableExpenses / 1.07)
            // opVar = riceTotal + (vatableExpenses - totalVatIn) = riceTotal + vatableExpenses/1.07
            // opFixed = fixedCashTotal = salaryTotal + fixedCostItems
            // opCost = opVar + opFixed = riceTotal + vatableExpenses/1.07 + salaryTotal + fixedCostItems
            
            // So opCost = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal + vatableFixed)/1.07 + salaryTotal + fixedCostItems
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal)/1.07 + vatableFixed/1.07 + salaryTotal + fixedCostItems
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal)/1.07 + vatableFixed/1.07 + salaryTotal + (nonVatableFixed + vatableFixed)
            // = riceTotal + (packTotal + elecTotal + platformTotal + mktTotal)/1.07 + salaryTotal + nonVatableFixed + vatableFixed/1.07 + vatableFixed
            
            // So we need: nonVatableFixed + vatableFixed/1.07 + vatableFixed = fixedCostItems + vatableFixed/1.07
            // = (nonVatableFixed + vatableFixed) + vatableFixed/1.07
            // = fixedCostItems + vatableFixed/1.07
            
            // But we have: nonVatableFixed + vatableFixedExVat = (fixedCostItems - vatableFixed) + vatableFixed/1.07
            // = fixedCostItems - vatableFixed + vatableFixed/1.07
            // = fixedCostItems - vatableFixed*(1 - 1/1.07)
            // = fixedCostItems - vatableFixed*(7/107)
            
            // So we're missing: vatableFixed*(7/107) + vatableFixed = vatableFixed*(1 + 7/107) = vatableFixed*(114/107)
            
            // Wait, I think I'm overcomplicating this. Let me use the actual values from revBreakdown:
            // We should use revBreakdown values directly to ensure consistency
            const revenueData = [ { name: t('rice'), value: c.grossRev }, { name: t('item'), value: c.totalByProductIncome }, { name: 'Logistics', value: c.logIncome } ];
            const getHeatmapColor = (profit) => {
                if (profit < 0) return 'bg-red-100 text-red-700';
                if (profit < c.netProfit * 0.5) return 'bg-orange-100 text-orange-700';
                if (profit < c.netProfit * 0.8) return 'bg-yellow-100 text-yellow-700';
                return 'bg-green-100 text-green-700';
            };

            return (
                <div className="app-container font-sans text-slate-800">
                    <header className="header-bar sticky top-0 z-50 flex flex-col md:flex-row justify-between items-center gap-4">
                        <div>
                            <h1 className="text-xl font-bold tracking-tight">{t('title')}</h1>
                            <p className="text-xs text-slate-400">{t('subtitle')}</p>
                        </div>
                        <div className="flex items-center gap-2 header-controls">
                            <span className="text-xs text-slate-400 font-bold mr-1">{t('scenario')}</span>
                            <button onClick={()=>applyScenario('worst')} className={`scenario-btn ${d.scenario==='worst'?'bg-red-100 text-red-700 active ring-2 ring-red-500':'bg-slate-700 text-slate-300'}`}>{t('scenWorst')}</button>
                            <button onClick={()=>applyScenario('base')} className={`scenario-btn ${d.scenario==='base'?'bg-blue-100 text-blue-700 active ring-2 ring-blue-500':'bg-slate-700 text-slate-300'}`}>{t('scenBase')}</button>
                            <button onClick={()=>applyScenario('best')} className={`scenario-btn ${d.scenario==='best'?'bg-green-100 text-green-700 active ring-2 ring-green-500':'bg-slate-700 text-slate-300'}`}>{t('scenBest')}</button>
                            
                            <div className="h-6 w-px bg-slate-600 mx-2"></div>
                            
                            <button onClick={() => setLang(lang === 'th' ? 'cn' : 'th')} className="scenario-btn bg-yellow-500 text-white hover:bg-yellow-600 flex items-center gap-1 font-bold">
                                <span>üåê</span> {lang === 'th' ? 'TH | CN' : 'CN | TH'}
                            </button>

                            <button onClick={resetToDefault} className="scenario-btn bg-slate-600 text-slate-200 ml-2 hover:bg-slate-500">{t('reset')}</button>
                            <button onClick={handleShare} className="scenario-btn bg-purple-600 text-white ml-2 hover:bg-purple-500 flex items-center gap-1"><span>üîó</span> {t('share')}</button>
                            <button onClick={handleExport} className="scenario-btn bg-emerald-600 text-white ml-2 hover:bg-emerald-500 flex items-center gap-1"><span>üì•</span> CSV</button>
                            <button onClick={handlePrint} className="scenario-btn bg-white text-slate-800 ml-2 hover:bg-slate-100 flex items-center gap-1 font-bold border border-slate-300"><span>üñ®Ô∏è</span> {t('print')}</button>
                        </div>
                    </header>
                    
                    {/* RISK SIMULATION CENTER */}
                    <div className="risk-sim-section bg-white border-b border-slate-200 p-4 sticky top-[70px] z-40 shadow-sm">
                         <div className="max-w-[1800px] mx-auto">
                            <div className="flex justify-between items-center mb-2">
                                <div className="text-sm font-bold text-slate-700 flex items-center gap-2">
                                    <span>{t('riskTitle')}</span>
                                    {activeSim && <span className="bg-red-100 text-red-600 text-xs px-2 py-0.5 rounded-full animate-pulse">{t('simActive')} {SCENARIOS[activeSim].label[lang]}</span>}
                                </div>
                                {activeSim && (
                                    <button onClick={() => handleSimulate(activeSim)} className="text-xs bg-slate-200 hover:bg-slate-300 px-3 py-1 rounded text-slate-600 font-bold transition">
                                        ‚Ü∫ {t('stopSim')}
                                    </button>
                                )}
                            </div>
                            
                            <div className="grid grid-cols-4 gap-4">
                                {/* Cat 1: Market */}
                                <div className="space-y-1">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{t('riskLabelMarket')}</div>
                                    <div className="grid grid-cols-2 gap-1">
                                        {['price_war', 'new_competitor', 'algo_change', 'negative_viral'].map(k => (
                                            <button key={k} onClick={() => handleSimulate(k)} className={`risk-btn cat-1 ${activeSim === k ? 'active' : ''}`}>
                                                {SCENARIOS[k].label[lang]}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                                {/* Cat 2: Supply */}
                                <div className="space-y-1">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{t('riskLabelSupply')}</div>
                                    <div className="grid grid-cols-2 gap-1">
                                        {['drought', 'machine_break', 'pack_cost', 'energy_crisis'].map(k => (
                                            <button key={k} onClick={() => handleSimulate(k)} className={`risk-btn cat-2 ${activeSim === k ? 'active' : ''}`}>
                                                {SCENARIOS[k].label[lang]}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                                {/* Cat 3: Financial */}
                                <div className="space-y-1">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{t('riskLabelFin')}</div>
                                    <div className="grid grid-cols-2 gap-1">
                                        {['rate_hike', 'credit_crunch', 'tax_fine', 'inflation'].map(k => (
                                            <button key={k} onClick={() => handleSimulate(k)} className={`risk-btn cat-3 ${activeSim === k ? 'active' : ''}`}>
                                                {SCENARIOS[k].label[lang]}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                                {/* Cat 4: Ops */}
                                <div className="space-y-1">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{t('riskLabelOps')}</div>
                                    <div className="grid grid-cols-2 gap-1">
                                        {['staff_turnover', 'fraud', 'warehouse_pest', 'platform_ban'].map(k => (
                                            <button key={k} onClick={() => handleSimulate(k)} className={`risk-btn cat-4 ${activeSim === k ? 'active' : ''}`}>
                                                {SCENARIOS[k].label[lang]}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            {/* Analysis Result Box */}
                            {activeSim && (
                                <div className="mt-3 bg-slate-50 border border-slate-200 rounded p-3 text-sm animate-fade-in">
                                    <h4 className="font-bold text-slate-700 mb-2 flex items-center gap-2">
                                        {t('riskAnalTitle')} <span className="text-xs font-normal text-slate-400">({SCENARIOS[activeSim].label[lang]})</span>
                                    </h4>
                                    
                                    <div className="mb-3 p-2 bg-yellow-50 text-yellow-800 text-xs rounded border border-yellow-200">
                                        <strong>{t('simLogic')}</strong> {SCENARIOS[activeSim].math_desc[lang]}
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div className="text-red-600">
                                            <div className="font-bold text-xs uppercase mb-1">{t('impact')}</div>
                                            {SCENARIOS[activeSim].analysis[lang].impact}
                                        </div>
                                        <div className="text-slate-600">
                                            <div className="font-bold text-xs uppercase mb-1">{t('cause')}</div>
                                            {SCENARIOS[activeSim].analysis[lang].cause}
                                        </div>
                                        <div className="text-blue-600 bg-blue-50 p-2 rounded">
                                            <div className="font-bold text-xs uppercase mb-1">{t('strategy')}</div>
                                            {SCENARIOS[activeSim].analysis[lang].strategy}
                                        </div>
                                    </div>
                                </div>
                            )}
                         </div>
                    </div>

                    {toast && (
                        <div className="fixed top-20 right-4 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-[100] animate-bounce">
                            {toast}
                        </div>
                    )}

                    <main className="p-4 max-w-[1800px] mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">
                        
                        {/* --- LEFT: Production & Cost --- */}
                        <div className="lg:col-span-3 space-y-4">
                            <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">{t('section1')}</h2>
                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('capexTitle')}</div><div className="text-red-500 font-bold text-sm">{fmt(c.totalCapex)}</div></div>
                                <div className="card-body">
                                    <div className="input-group"><label className="input-label">{t('regCapital')}</label><input type="number" className="input-field border-blue-200 bg-blue-50 text-blue-800" value={d.regCapital} onChange={e=>up('regCapital',null,e.target.value)} /></div>
                                    <div className="p-2 border border-dashed rounded mb-3 bg-yellow-50/50"><div className="text-xs font-bold text-slate-500 mb-1">{t('bankLoan')}</div><div className="flex gap-2 mb-1"><div className="flex-1"><label className="text-[10px]">{t('loanAmount')}</label><input type="number" className="input-field" value={d.loan.amount} onChange={e=>up('loan','amount',e.target.value)}/></div><div className="w-16"><label className="text-[10px]">{t('interestRate')}</label><input type="number" className="input-field text-center" value={d.loan.rate} onChange={e=>up('loan','rate',e.target.value)}/></div></div><div className="flex gap-2"><div className="flex-1 text-[10px] text-slate-400 pt-1">{t('loanTerm')} {d.loan.term} {t('year')}</div><div className="text-[10px] text-red-400 font-bold pt-1">{t('interestPerYear')} {fmt(c.annualFinanceCost)}</div></div></div>
                                    <div className="grid grid-cols-2 gap-2 mb-2"><div><label className="input-label">{t('factory')}</label><input type="number" className="input-field" value={d.capex.factory} onChange={e=>up('capex','factory',e.target.value)}/></div><div><label className="input-label">{t('machine')}</label><input type="number" className="input-field" value={d.capex.machine} onChange={e=>up('capex','machine',e.target.value)}/></div></div>
                                    <div className="input-group"><label className="input-label">{t('license')}</label><input type="number" className="input-field" value={d.capex.license} onChange={e=>up('capex','license',e.target.value)} /></div>
                                    
                                    {/* MODIFIED: Stock Logic */}
                                    <div className="input-group bg-orange-50 p-2 rounded border border-orange-100">
                                        <div className="flex justify-between items-center mb-1">
                                            <label className="input-label text-orange-800 font-bold">{t('stockPolicy')}</label>
                                            <input type="number" className="input-field w-12 text-center h-6 text-sm" value={d.stockMonths} onChange={e=>up('stockMonths',null,e.target.value)} min="0" max="12"/>
                                        </div>
                                        <div className="flex justify-between items-center">
                                            <div className="text-[10px] text-orange-600">{t('stockMoneyAuto')}</div>
                                            <div className="font-bold text-orange-700">{fmt(c.initialStockAmount)}</div>
                                        </div>
                                    </div>

                                    <div className="flex justify-between text-xs text-green-600 mt-2 bg-green-50 p-2 rounded"><span>{t('workingCap')}</span><span className="font-bold">{fmt(c.workingCap)}</span></div>
                                    
                                    {/* CAPEX Step-up for Scaling */}
                                    <div className="mt-3 pt-3 border-t border-slate-200">
                                        <div className="flex items-center gap-2 mb-2">
                                            <input type="checkbox" className="w-4 h-4" checked={d.capexStepUp?.enabled || false} onChange={e=>upNew('capexStepUp', 'enabled', e.target.checked)}/>
                                            <span className="text-xs font-bold text-purple-700">{t('enableCapexStepUp')}</span>
                                        </div>
                                        <div className={`space-y-2 text-xs ${!d.capexStepUp?.enabled && 'opacity-50 pointer-events-none'}`}>
                                            <div><label className="text-[10px] text-slate-500">{t('thresholdBags')}</label><input type="number" className="input-field" value={d.capexStepUp?.thresholdBags || 30000} onChange={e=>upNew('capexStepUp', 'thresholdBags', e.target.value)}/></div>
                                            <div className="grid grid-cols-2 gap-2">
                                                <div><label className="text-[10px] text-slate-500">{t('factoryExpansion')}</label><input type="number" className="input-field" value={d.capexStepUp?.factoryExpansion || 5000000} onChange={e=>upNew('capexStepUp', 'factoryExpansion', e.target.value)}/></div>
                                                <div><label className="text-[10px] text-slate-500">{t('machineExpansion')}</label><input type="number" className="input-field" value={d.capexStepUp?.machineExpansion || 2000000} onChange={e=>upNew('capexStepUp', 'machineExpansion', e.target.value)}/></div>
                                            </div>
                                            <div><label className="text-[10px] text-slate-500">{t('capacityIncrease')}</label><input type="number" className="input-field" value={d.capexStepUp?.capacityIncrease || 50000} onChange={e=>upNew('capexStepUp', 'capacityIncrease', e.target.value)}/></div>
                                            {c.capexStepUp?.enabled && c.capexStepUp?.additionalCapex > 0 && (
                                                <div className="bg-purple-50 p-2 rounded border border-purple-200">
                                                    <div className="text-[10px] text-purple-700 font-bold">CAPEX ‡πÄ‡∏û‡∏¥‡πà‡∏°: {fmt(c.capexStepUp.additionalCapex)}</div>
                                                    <div className="text-[9px] text-purple-600">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡πÉ‡∏´‡∏°‡πà: {fmt(c.capexStepUp.effectiveMaxCapacity)} ‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Seasonal Shock Simulator */}
                            <div className="card border-red-100">
                                <div className="card-header bg-red-50"><div className="card-title text-red-700">{t('seasonalTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="flex items-center gap-2 mb-3">
                                        <input type="checkbox" className="w-4 h-4" checked={d.seasonalShock.active} onChange={e=>upNew('seasonalShock', 'active', e.target.checked)}/>
                                        <span className="text-sm font-bold text-slate-700">{t('enableShock')}</span>
                                    </div>
                                    <div className={`space-y-2 ${!d.seasonalShock.active && 'opacity-50 pointer-events-none'}`}>
                                        <div className="flex gap-2">
                                            <div><label className="text-[10px] text-slate-500">{t('shockMonthStart')}</label><input type="number" className="input-field" min="1" max="12" value={d.seasonalShock.startM} onChange={e=>upNew('seasonalShock', 'startM', e.target.value)}/></div>
                                            <div><label className="text-[10px] text-slate-500">{t('shockMonthEnd')}</label><input type="number" className="input-field" min="1" max="12" value={d.seasonalShock.endM} onChange={e=>upNew('seasonalShock', 'endM', e.target.value)}/></div>
                                        </div>
                                        <div><label className="text-[10px] text-slate-500">{t('shockCostImpact')}</label><input type="number" className="input-field border-red-300" value={d.seasonalShock.costImpact} onChange={e=>upNew('seasonalShock', 'costImpact', e.target.value)}/></div>
                                        <div className="text-[9px] text-slate-400 mt-1">{t('shockDesc')}</div>
                                    </div>
                                </div>
                            </div>

                            <div className="card"><div className="card-header"><div className="card-title">{t('productionTitle')}</div></div><div className="card-body"><div className="input-group mb-4"><label className="input-label flex justify-between"><span>{t('yieldRice')}</span><span className="font-bold text-blue-600">{d.yield}%</span></label><input type="range" className="w-full" min="40" max="70" value={d.yield} onChange={handleYieldChange}/></div><div className="input-group"><label className="input-label">{t('paddyPrice')}</label><input type="number" className="input-field" value={d.paddyPrice} onChange={e=>up('paddyPrice',null,e.target.value)}/></div><div className="text-xs text-slate-500 mt-2 text-right">{t('paddyUsed')} <b>{fmtDec(c.paddyTons)}</b> {t('ton')}</div><div className="text-xs text-right text-orange-600 font-bold">{t('riceBudget')} {fmt(c.riceTotal)}</div></div></div>
                            <div className="card"><div className="card-header"><div className="card-title">{t('unitCostTitle')}</div><div className="text-red-600 font-bold">{fmtDec(c.matCostUnit)}</div></div><div className="card-body"><div className="grid grid-cols-3 gap-2 text-center text-xs mb-2"><div className="bg-slate-100 p-1 rounded"><div>{t('rice')}</div><b>{fmtDec(c.riceCostUnit)}</b><div className="text-[10px] text-slate-500 mt-1 border-t border-slate-200 pt-1">{fmt(c.riceTotal)}</div></div><div className="bg-slate-100 p-1 rounded"><div>{t('bag')}</div><input className="w-full text-center bg-transparent font-bold" value={d.unit.bag} onChange={e=>up('unit','bag',e.target.value)}/><div className="text-[10px] text-slate-500 mt-1 border-t border-slate-200 pt-1">{fmt(d.unit.bag * d.targetBags)}</div></div><div className="bg-slate-100 p-1 rounded"><div>{t('sticker')}</div><input className="w-full text-center bg-transparent font-bold" value={d.unit.sticker} onChange={e=>up('unit','sticker',e.target.value)}/><div className="text-[10px] text-slate-500 mt-1 border-t border-slate-200 pt-1">{fmt(d.unit.sticker * d.targetBags)}</div></div></div><div className="text-xs text-right text-red-600 font-bold border-t border-slate-100 pt-2">{t('totalUnitCost')} {fmt(c.riceTotal + c.packTotal)}</div></div></div>
                            <div className="card"><div className="card-header"><div className="card-title">{t('hrTitle')}</div><div className="text-blue-600 font-bold text-sm">{fmt(c.salaryTotal)}</div></div><div className="card-body"><table className="w-full hr-table"><thead><tr><th>{t('role')}</th><th className="w-10 text-center">{t('count')}</th><th className="w-20 text-right">{t('salary')}</th><th className="w-16 text-right text-xs text-slate-500">{t('sso')}</th><th className="w-20 text-right font-bold">{t('total')}</th></tr></thead><tbody>{c.hrCosts.map((h,i)=>(<tr key={i}><td>{h.role}</td><td><input type="number" className="hr-input text-center" value={h.count} onChange={e=>upArr('hr',i,'count',e.target.value)}/></td><td><input type="number" className="hr-input" value={h.salary} onChange={e=>upArr('hr',i,'salary',e.target.value)}/></td><td className="text-right text-xs text-slate-500">{fmt(h.ssoTotalRole)}</td><td className="text-right font-bold text-slate-700">{fmt(h.totalPerRole)}</td></tr>))}</tbody></table></div></div>
                            <div className="card">
                                <div className="card-header">
                                    <div className="card-title">{t('expenseTitle')}</div>
                                    <div className="text-red-500 font-bold text-sm">{fmt(c.section7Total)}</div>
                                </div>
                                <div className="card-body space-y-3">
                                <div>
                                    <div className="text-xs font-bold text-slate-500 mb-1">{t('varParamTitle')}</div>
                                    <div className="input-row"><span className="text-sm">{t('elec')} ({d.varParams.elecRate} /{t('ton')})</span><div className="flex items-center gap-2"><input type="number" className="input-field w-16" value={d.varParams.elecRate} onChange={e=>up('varParams','elecRate',e.target.value)}/><span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">{fmt(c.elecTotal)}</span></div></div>
                                    <div className="input-row">
                                        <span className="text-sm flex flex-col">
                                            <span>{t('platform')} (%)</span>
                                            <span className="text-[9px] text-slate-400 italic">({t('autoChannel')})</span>
                                        </span>
                                        <div className="flex items-center gap-2">
                                            <input type="number" className="input-field w-16 bg-slate-100 text-slate-500 cursor-not-allowed" value={(c.blendedFeePct || 0).toFixed(2)} disabled />
                                            <span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">{fmt(c.platformTotal)}</span>
                                        </div>
                                    </div>
                                    <div className="input-row">
                                        <span className="text-sm flex flex-col">
                                            <span>{t('marketing')} (%)</span>
                                            {d.channelMix?.b2c || d.channelMix?.b2b ? (
                                                <span className="text-[9px] text-slate-400 italic">({t('autoChannel')}: {(c?.blendedMktPct || 0).toFixed(2)}%)</span>
                                            ) : null}
                                        </span>
                                        <div className="flex items-center gap-2">
                                            <input 
                                                type="number" 
                                                className={`input-field w-16 ${(d.channelMix?.b2c || d.channelMix?.b2b) ? 'bg-slate-100 text-slate-500 cursor-not-allowed' : ''}`} 
                                                value={(d.channelMix?.b2c || d.channelMix?.b2b) ? (c?.blendedMktPct || 0).toFixed(2) : d.varParams.mktPercent} 
                                                onChange={e=>{
                                                    if (!(d.channelMix?.b2c || d.channelMix?.b2b)) {
                                                        up('varParams','mktPercent',e.target.value);
                                                    }
                                                }}
                                                disabled={!!(d.channelMix?.b2c || d.channelMix?.b2b)}
                                            />
                                            <span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">{fmt(c.mktTotal)}</span>
                                        </div>
                                    </div>
                                    <div className="input-row"><span className="text-sm">{t('returnRate')}</span><div className="flex items-center gap-2"><input type="number" className="input-field w-16" value={d.varParams.returnRate} onChange={e=>up('varParams','returnRate',e.target.value)}/><span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">-{fmt(c.refundTotal)}</span></div></div>
                                </div>
                                <div>
                                    <div className="text-xs font-bold text-slate-500 mb-1">{t('fixedParamTitle')}</div>
                                    <div className="input-row"><span className="text-sm">{t('maintenance')}</span><input type="number" className="input-field w-24" value={d.fixedParams.maintPercent} onChange={e=>up('fixedParams','maintPercent',e.target.value)} placeholder="% Machine"/></div>
                                    <div className="input-row">
                                        <span className="text-sm">{t('vatableFixedPercent')}</span>
                                        <input type="number" className="input-field w-24" value={d.fixedParams.vatablePercent ?? 0} onChange={e=>up('fixedParams','vatablePercent',e.target.value)} placeholder="0-100"/>
                                    </div>
                                    <div className="input-row"><span className="text-sm">{t('erp')}</span><input type="number" className="input-field w-24" value={d.fixedParams.erp} onChange={e=>up('fixedParams','erp',e.target.value)}/></div>
                                    <div className="input-row"><span className="text-sm">{t('insurance')}</span><input type="number" className="input-field w-24" value={d.fixedParams.insurance} onChange={e=>up('fixedParams','insurance',e.target.value)}/></div>
                                    <div className="input-row"><span className="text-sm">{t('misc')}</span><input type="number" className="input-field w-24" value={d.fixedParams.other} onChange={e=>up('fixedParams','other',e.target.value)}/></div>
                                    
                                    <div className="text-xs font-bold text-slate-500 mt-2 mb-1 pt-2 border-t border-slate-100">{t('operationTitle')}</div>
                                    <div className="input-row"><span className="text-sm">{t('audit')}</span><input type="number" className="input-field w-24" value={d.fixedParams.audit} onChange={e=>up('fixedParams','audit',e.target.value)}/></div>
                                    <div className="input-row"><span className="text-sm">{t('travel')}</span><input type="number" className="input-field w-24" value={d.fixedParams.travel} onChange={e=>up('fixedParams','travel',e.target.value)}/></div>
                                    
                                    <div className="input-row bg-yellow-50 p-1 rounded border border-yellow-100 mt-2"><span className="text-sm font-bold text-yellow-800">{t('campaign')}</span><div className="font-bold text-yellow-700">{fmt(d.fixedParams.campaign)}</div></div>
                                </div>
                                
                                {/* Campaign Details Breakdown */}
                                <div className="mt-2 border-t border-slate-200 pt-2">
                                    <div className="text-[10px] font-bold text-slate-400 mb-1">{t('campaignBreakdown')}</div>
                                    <table className="w-full text-[10px]">
                                        <thead>
                                            <tr className="bg-yellow-50 text-yellow-800">
                                                <th className="text-left p-1 rounded-l">{t('reward')}</th>
                                                <th className="text-center p-1">{t('qty')}</th>
                                                <th className="text-right p-1">{t('costPerUnit')}</th>
                                                <th className="text-right p-1 rounded-r">{t('total')}</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {(d.campaignDetails || []).map((item, i) => (
                                                <tr key={i} className="border-b border-slate-100">
                                                    <td className="p-1"><input className="w-full bg-transparent outline-none focus:text-blue-600" value={item.name || ''} onChange={e=>upCampaign(i,'name',e.target.value)}/></td>
                                                    <td className="p-1"><input type="number" className="w-8 text-center bg-slate-50 border rounded p-0.5 outline-none focus:border-blue-300" value={item.qty || 0} onChange={e=>upCampaign(i,'qty',e.target.value)}/></td>
                                                    <td className="p-1"><input type="number" className="w-12 text-right bg-slate-50 border rounded p-0.5 outline-none focus:border-blue-300" value={item.costPerUnit || 0} onChange={e=>upCampaign(i,'costPerUnit',e.target.value)}/></td>
                                                    <td className="p-1 text-right font-medium text-slate-600">{fmt((item.qty || 0) * (item.costPerUnit || 0))}</td>
                                                </tr>
                                            ))}
                                            <tr className="font-bold text-yellow-900 border-t border-yellow-200">
                                                <td colSpan="3" className="p-1 text-right">Total Campaign</td>
                                                <td className="p-1 text-right">{fmt(d.fixedParams.campaign || 0)}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            </div>
                            
                            {/* Working Capital Cycle */}
                            <div className="card border-indigo-100">
                                <div className="card-header bg-indigo-50"><div className="card-title text-indigo-700 text-sm">{t('workingCapitalTitle')}</div></div>
                                <div className="card-body p-3 space-y-2 text-xs">
                                    <div className="input-row"><span className="text-sm">{t('arDays')}</span><input type="number" className="input-field w-20" value={d.workingCapital?.arDays || 0} onChange={e=>upNew('workingCapital', 'arDays', e.target.value)}/></div>
                                    <div className="input-row"><span className="text-sm">{t('apDays')}</span><input type="number" className="input-field w-20" value={d.workingCapital?.apDays || 30} onChange={e=>upNew('workingCapital', 'apDays', e.target.value)}/></div>
                                    <div className="input-row"><span className="text-sm">{t('inventoryDays')}</span><input type="number" className="input-field w-20" value={d.workingCapital?.inventoryDays || 60} onChange={e=>upNew('workingCapital', 'inventoryDays', e.target.value)}/></div>
                                    {c.workingCapitalCycle && (
                                        <div className="mt-2 pt-2 border-t border-indigo-100 space-y-1 text-[10px]">
                                            <div className="flex justify-between"><span className="text-slate-500">AR Requirement:</span><span className="font-bold text-blue-600">{fmt(c.workingCapitalCycle.arRequirement)}</span></div>
                                            <div className="flex justify-between"><span className="text-slate-500">AP Benefit:</span><span className="font-bold text-green-600">-{fmt(c.workingCapitalCycle.apBenefit)}</span></div>
                                            <div className="flex justify-between"><span className="text-slate-500">Inventory:</span><span className="font-bold text-orange-600">{fmt(c.workingCapitalCycle.inventoryRequirement)}</span></div>
                                            <div className="flex justify-between pt-1 border-t font-bold"><span className="text-indigo-700">Net WC Need:</span><span className={`${c.workingCapitalCycle.netWcRequirement > 0 ? 'text-red-600' : 'text-green-600'}`}>{fmt(c.workingCapitalCycle.netWcRequirement)}</span></div>
                                        </div>
                                    )}
                                </div>
                            </div>
                            
                            {/* Hiring Recommendation */}
                            <div className="card border-green-100">
                                <div className="card-header bg-green-50"><div className="card-title text-green-700 text-sm">{t('hiringRecommendationTitle')}</div></div>
                                <div className="card-body p-3 space-y-2 text-xs">
                                    {(() => {
                                        // Calculate current staff count
                                        const totalStaff = c.hrCosts ? c.hrCosts.reduce((sum, h) => sum + (h.count || 0), 0) : 0;
                                        const currentCapacity = d.maxCapacity || 0;
                                        const currentSales = d.targetBags || 0;
                                        const capacityPerPerson = totalStaff > 0 ? currentCapacity / totalStaff : 0;
                                        const utilizationRate = currentCapacity > 0 ? (currentSales / currentCapacity) * 100 : 0;
                                        
                                        // Calculate average cost per employee per month
                                        const totalSalary = c.salaryTotal || 0;
                                        const avgSalaryPerPerson = totalStaff > 0 ? totalSalary / totalStaff : 0;
                                        
                                        // Calculate profit per bag (after variable costs, before fixed costs allocation)
                                        const revPerBag = d.price || 0;
                                        const varCostPerBag = c.unitEco?.varCostNoAdsUnitExVat || 0;
                                        const adsPerBag = c.unitEco?.adsUnitExVat || 0;
                                        const grossProfitPerBag = revPerBag - varCostPerBag - adsPerBag;
                                        
                                        // Calculate fixed cost per bag (for reference)
                                        const totalFixedCost = c.revBreakdown?.opFixed || 0;
                                        const fixedCostPerBag = currentSales > 0 ? totalFixedCost / currentSales : 0;
                                        
                                        // Net profit per bag (approximate)
                                        const netProfitPerBag = grossProfitPerBag - fixedCostPerBag;
                                        
                                        // Calculate hiring threshold
                                        // If utilization is high (>80%), consider hiring
                                        // Need to sell enough bags to cover new employee cost
                                        const bagsNeededForHiring = avgSalaryPerPerson > 0 && netProfitPerBag > 0 
                                            ? Math.ceil(avgSalaryPerPerson / netProfitPerBag) 
                                            : 0;
                                        
                                        // Hiring recommendation
                                        let recommendation = '';
                                        let recommendationColor = 'text-slate-600';
                                        let thresholdBags = 0;
                                        
                                        if (utilizationRate < 80) {
                                            recommendation = lang === 'th' 
                                                ? `‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏à‡πâ‡∏≤‡∏á: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á ${utilizationRate.toFixed(1)}% ‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å`
                                                : `Ëøò‰∏çÂ∫îËØ•ÊãõËÅòÔºö‰∫ßËÉΩÂà©Áî®Áéá‰ªÖ ${utilizationRate.toFixed(1)}%Ôºå‰ªçÊúâÂ¢ûÂä†ÈîÄÂîÆÈ¢ùÁöÑÁ©∫Èó¥`;
                                            recommendationColor = 'text-blue-600';
                                        } else if (utilizationRate >= 80 && utilizationRate < 95) {
                                            // Ready to hire when sales reach current capacity
                                            thresholdBags = currentCapacity;
                                            recommendation = lang === 'th'
                                                ? `‡∏Ñ‡∏ß‡∏£‡∏à‡πâ‡∏≤‡∏á: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á ${fmt(thresholdBags)} ‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï ${utilizationRate.toFixed(1)}%)`
                                                : `Â∫îËØ•ÊãõËÅòÔºöÂΩìÈîÄÂîÆÈ¢ùËææÂà∞ ${fmt(thresholdBags)} Ë¢ã/ÊúàÊó∂Ôºà‰∫ßËÉΩÂà©Áî®Áéá ${utilizationRate.toFixed(1)}%Ôºâ`;
                                            recommendationColor = 'text-green-600';
                                        } else if (utilizationRate >= 95) {
                                            recommendation = lang === 'th'
                                                ? `‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï: ‡πÉ‡∏ä‡πâ ${utilizationRate.toFixed(1)}% ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏Å‡πà‡∏≠‡∏ô`
                                                : `Ë∂ÖËøá‰∫ßËÉΩÔºö‰ΩøÁî® ${utilizationRate.toFixed(1)}%ÔºåÈúÄË¶ÅÂÖàÊâ©Âª∫Â∑•ÂéÇÊàñÂ¢ûÂä†‰∫ßËÉΩ`;
                                            recommendationColor = 'text-red-600';
                                        }
                                        
                                        // Calculate benefit of hiring
                                        const newCapacityIfHire = capacityPerPerson > 0 ? (totalStaff + 1) * capacityPerPerson : currentCapacity;
                                        const additionalCapacity = newCapacityIfHire - currentCapacity;
                                        const additionalProfit = additionalCapacity * netProfitPerBag;
                                        const netBenefit = additionalProfit - avgSalaryPerPerson;
                                        
                                        return (
                                            <>
                                                <div className="grid grid-cols-2 gap-2 mb-3">
                                                    <div className="bg-blue-50 p-2 rounded border border-blue-100">
                                                        <div className="text-[10px] text-blue-600 mb-1">{t('currentStaff')}</div>
                                                        <div className="font-bold text-blue-700">{totalStaff} {lang === 'th' ? '‡∏Ñ‡∏ô' : '‰∫∫'}</div>
                                                    </div>
                                                    <div className="bg-purple-50 p-2 rounded border border-purple-100">
                                                        <div className="text-[10px] text-purple-600 mb-1">{t('currentCapacity')}</div>
                                                        <div className="font-bold text-purple-700">{fmt(currentCapacity)} {lang === 'th' ? '‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' : 'Ë¢ã/Êúà'}</div>
                                                    </div>
                                                    <div className="bg-indigo-50 p-2 rounded border border-indigo-100">
                                                        <div className="text-[10px] text-indigo-600 mb-1">{t('capacityPerPerson')}</div>
                                                        <div className="font-bold text-indigo-700">{capacityPerPerson > 0 ? fmt(Math.round(capacityPerPerson)) : '-'} {lang === 'th' ? '‡∏ñ‡∏∏‡∏á/‡∏Ñ‡∏ô' : 'Ë¢ã/‰∫∫'}</div>
                                                    </div>
                                                    <div className={`p-2 rounded border ${
                                                        utilizationRate >= 95 ? 'bg-red-50 border-red-100' :
                                                        utilizationRate >= 80 ? 'bg-yellow-50 border-yellow-100' :
                                                        'bg-green-50 border-green-100'
                                                    }`}>
                                                        <div className="text-[10px] text-slate-600 mb-1">{t('utilizationRate')}</div>
                                                        <div className={`font-bold ${
                                                            utilizationRate >= 95 ? 'text-red-600' :
                                                            utilizationRate >= 80 ? 'text-yellow-600' :
                                                            'text-green-600'
                                                        }`}>{utilizationRate.toFixed(1)}%</div>
                                                    </div>
                                                </div>
                                                
                                                <div className="mt-3 pt-3 border-t border-green-100 space-y-2">
                                                    <div className="flex justify-between text-[10px]">
                                                        <span className="text-slate-500">{t('hiringCost')}</span>
                                                        <span className="font-bold text-slate-700">{fmt(Math.round(avgSalaryPerPerson))}</span>
                                                    </div>
                                                    <div className="flex justify-between text-[10px]">
                                                        <span className="text-slate-500">{lang === 'th' ? '‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì)' : 'ÊØèË¢ãÂà©Ê∂¶ÔºàÁ∫¶Ôºâ'}</span>
                                                        <span className={`font-bold ${netProfitPerBag > 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {fmtDec(netProfitPerBag)}
                                                        </span>
                                                    </div>
                                                    {bagsNeededForHiring > 0 && netProfitPerBag > 0 && (
                                                        <div className="flex justify-between text-[10px]">
                                                            <span className="text-slate-500">{t('bagsNeededForHiring')}</span>
                                                            <span className="font-bold text-blue-600">{fmt(bagsNeededForHiring)} {lang === 'th' ? '‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' : 'Ë¢ã/Êúà'}</span>
                                                        </div>
                                                    )}
                                                    {utilizationRate >= 80 && utilizationRate < 95 && (
                                                        <>
                                                            <div className="flex justify-between text-[10px]">
                                                                <span className="text-slate-500">{t('hiringThreshold')}</span>
                                                                <span className="font-bold text-green-600">{fmt(thresholdBags)} {lang === 'th' ? '‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' : 'Ë¢ã/Êúà'}</span>
                                                            </div>
                                                            {netBenefit > 0 && (
                                                                <div className="flex justify-between text-[10px] bg-green-50 p-2 rounded border border-green-200">
                                                                    <span className="text-green-700 font-bold">{t('hiringBenefit')}</span>
                                                                    <span className="font-bold text-green-600">+{fmt(Math.round(netBenefit))} {lang === 'th' ? '‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' : 'Ê≥∞Èì¢/Êúà'}</span>
                                                                </div>
                                                            )}
                                                        </>
                                                    )}
                                                </div>
                                                
                                                <div className={`mt-3 pt-3 border-t border-green-100 p-2 rounded ${
                                                    utilizationRate >= 95 ? 'bg-red-50 border-red-200' :
                                                    utilizationRate >= 80 ? 'bg-yellow-50 border-yellow-200' :
                                                    'bg-blue-50 border-blue-200'
                                                }`}>
                                                    <div className="text-[10px] font-bold mb-1 text-slate-700">{t('hiringRecommendation')}</div>
                                                    <div className={`text-xs ${recommendationColor} font-semibold`}>
                                                        {recommendation}
                                                    </div>
                                                </div>
                                            </>
                                        );
                                    })()}
                                </div>
                            </div>
                        </div>

                        {/* --- CENTER: Strategy & Dashboard --- */}
                        <div className="lg:col-span-5 space-y-4">
                            <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">{t('section2')}</h2>
                            
                            <div className="bg-slate-800 rounded-xl p-4 text-white shadow-lg mb-4 relative">
                                <div className="flex justify-between items-start mb-4">
                                    <h3 className="font-bold text-lg flex items-center gap-2"><span className="text-yellow-400">‚òÖ</span> {t('execSummary')}</h3>
                                    <div 
                                        className="text-right cursor-help hover:bg-slate-700/50 rounded p-1 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'netProfit')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'netProfit')}
                                    >
                                        <div className="text-xs text-slate-400">{t('netProfitYear1')}</div>
                                        <div className={`text-2xl font-bold ${c.netProfit>0?'text-green-400':'text-red-400'}`}>{fmt(c.netProfit)} ‡∏ø</div>
                                    </div>
                                </div>
                                <div className="grid grid-cols-4 gap-2 text-center">
                                    <div 
                                        className="bg-slate-700/50 rounded p-2 border border-slate-600 cursor-help hover:bg-slate-700/70 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'netMargin')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'netMargin')}
                                    >
                                        <div className="text-[10px] text-slate-400">Net Margin</div>
                                        <div className="font-bold text-md text-green-300">{(c.netMargin || 0).toFixed(1)}%</div>
                                    </div>
                                    <div 
                                        className="bg-slate-700/50 rounded p-2 border border-slate-600 cursor-help hover:bg-slate-700/70 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'grossMargin')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'grossMargin')}
                                    >
                                        <div className="text-[10px] text-slate-400">Gross Margin</div>
                                        <div className="font-bold text-md text-blue-300">{(c.grossMargin || 0).toFixed(1)}%</div>
                                    </div>
                                    <div 
                                        className="bg-slate-700/50 rounded p-2 border border-slate-600 cursor-help hover:bg-slate-700/70 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'contributionMargin')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'contributionMargin')}
                                    >
                                        <div className="text-[10px] text-slate-400">Contrib. Margin</div>
                                        <div className="font-bold text-md text-cyan-300">{(c.contributionMargin || 0).toFixed(1)}%</div>
                                    </div>
                                    <div 
                                        className="bg-slate-700/50 rounded p-2 border border-slate-600 cursor-help hover:bg-slate-700/70 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'dscr')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'dscr')}
                                    >
                                        <div className="text-[10px] text-slate-400">DSCR</div>
                                        <div className={`font-bold text-md ${c.dscr>=1.25?'text-green-300':c.dscr>=1?'text-yellow-300':'text-red-400'}`}>{(c.dscr || 0).toFixed(2)}</div>
                                    </div>
                                </div>
                                
                                {/* Tooltip */}
                                {tooltip && tooltip.isCustom && tooltip.content && (
                                    <div 
                                        className="fixed z-[9999] bg-white text-slate-800 rounded-lg shadow-2xl p-3 max-w-xs border-2 border-indigo-400 pointer-events-auto"
                                        style={{
                                            left: `${tooltip.x}px`,
                                            top: `${tooltip.y}px`,
                                            transform: 'translate(-50%, -100%)',
                                            marginTop: '-10px',
                                            position: 'fixed'
                                        }}
                                        onMouseEnter={(e) => e.stopPropagation()}
                                        onMouseLeave={hideTooltip}
                                    >
                                        <div className="text-sm whitespace-pre-line text-slate-700">{tooltip.content}</div>
                                    </div>
                                )}
                                {tooltip && tooltip.metric && c && !tooltip.isCustom && (() => {
                                    const content = getTooltipContent(tooltip.metric, c);
                                    if (!content || !content[lang]) {
                                        console.log('Tooltip content missing:', { metric: tooltip.metric, hasContent: !!content, hasLang: content ? !!content[lang] : false });
                                        return null;
                                    }
                                    return (
                                        <div 
                                            className="fixed z-[9999] bg-white text-slate-800 rounded-lg shadow-2xl p-4 max-w-sm border-2 border-blue-400 pointer-events-auto"
                                            style={{
                                                left: `${tooltip.x}px`,
                                                top: `${tooltip.y}px`,
                                                transform: 'translate(-50%, -100%)',
                                                marginTop: '-10px',
                                                position: 'fixed'
                                            }}
                                            onMouseEnter={(e) => e.stopPropagation()}
                                            onMouseLeave={hideTooltip}
                                        >
                                            <div className="font-bold text-lg mb-2 text-blue-700">{content[lang].title}</div>
                                            <div className="text-sm mb-2 text-slate-600">{content[lang].meaning}</div>
                                            <div className="text-sm whitespace-pre-line text-slate-700 bg-blue-50 p-2 rounded border border-blue-200">{content[lang].advice}</div>
                                            <div className="text-xs text-slate-400 mt-2 text-right">{lang === 'th' ? '‡∏Ñ‡∏•‡∏¥‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏≠‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î' : 'ÁÇπÂáªÊàñÁßªÂºÄÈº†Ê†áÂÖ≥Èó≠'}</div>
                                        </div>
                                    );
                                })()}
                                <div className="mt-2 grid grid-cols-2 md:grid-cols-5 gap-2 text-center text-xs">
                                    <div 
                                        className="bg-slate-700/30 rounded p-2 border border-slate-600/50 cursor-help hover:bg-slate-700/50 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'priceExVat')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'priceExVat')}
                                    >
                                        <div className="text-[10px] text-slate-400">{t('priceExVat')}</div>
                                        <div className="font-bold text-slate-100">{fmtDec(c.unitEco?.revUnitExVat || 0)}</div>
                                    </div>
                                    <div 
                                        className="bg-slate-700/30 rounded p-2 border border-slate-600/50 cursor-help hover:bg-slate-700/50 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'varCostNoAds')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'varCostNoAds')}
                                    >
                                        <div className="text-[10px] text-slate-400">Var/Bag (no ads)</div>
                                        <div className="font-bold text-slate-100">{fmtDec(c.unitEco?.varCostNoAdsUnitExVat || 0)}</div>
                                    </div>
                                    <div 
                                        className="bg-slate-700/30 rounded p-2 border border-slate-600/50 cursor-help hover:bg-slate-700/50 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'grossCmBag')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'grossCmBag')}
                                    >
                                        <div className="text-[10px] text-slate-400">{t('grossCmBag')}</div>
                                        <div className="font-bold text-blue-200">{fmtDec(c.unitEco?.grossCmUnitExVat || 0)}</div>
                                    </div>
                                    <div 
                                        className="bg-slate-700/30 rounded p-2 border border-slate-600/50 cursor-help hover:bg-slate-700/50 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'adsBag')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'adsBag')}
                                    >
                                        <div className="text-[10px] text-slate-400">{t('adsBag')}</div>
                                        <div className="font-bold text-pink-200">{fmtDec(c.unitEco?.adsUnitExVat || 0)}</div>
                                    </div>
                                    <div 
                                        className="bg-slate-700/30 rounded p-2 border border-slate-600/50 cursor-help hover:bg-slate-700/50 transition-colors"
                                        onMouseEnter={(e) => handleTooltip(e, 'cacOrder')}
                                        onMouseLeave={hideTooltip}
                                        onClick={(e) => handleTooltip(e, 'cacOrder')}
                                    >
                                        <div className="text-[10px] text-slate-400">CAC/Order</div>
                                        <div className="font-bold text-yellow-200">{fmtDec(c.unitEco?.cpaExVat || 0)}</div>
                                    </div>
                                </div>
                                
                                {/* Scenario Comparison Table */}
                                <div className="mt-3 pt-3 border-t border-slate-600">
                                    <div className="text-xs text-slate-400 mb-2 font-bold">{t('scenComp')}</div>
                                    <div className="grid grid-cols-4 text-xs gap-1 text-center">
                                        <div className="text-slate-500">Metric</div>
                                        <div className="text-red-300">{t('scenWorst')}</div>
                                        <div className="text-blue-300">{t('scenBase')}</div>
                                        <div className="text-green-300">{t('scenBest')}</div>
                                        
                                        <div className="text-left text-slate-300 pl-1">{t('scenProfit')}</div>
                                        {scenarioComparison.map((s, i) => (
                                            <div key={i} className={`font-bold ${s.netProfit > 0 ? 'text-white' : 'text-red-400'}`}>{fmt(s.netProfit/1000)}k</div>
                                        ))}
                                        
                                        <div className="text-left text-slate-300 pl-1">{t('scenCash')}</div>
                                        {scenarioComparison.map((s, i) => (
                                            <div key={i} className={`font-bold ${s.cashFinal > 0 ? 'text-white' : 'text-red-400'}`}>{fmt(s.cashFinal/1000)}k</div>
                                        ))}
                                    </div>
                                </div>

                                <div className="mt-2 text-center text-xs text-slate-400">
                                    {t('payback')} <span className="text-white font-bold">{c.paybackMonth}</span> | 
                                    BEP: <span className="text-white font-bold">{fmt(c.bepUnits)}</span> {t('bag')}/{t('month')}
                                </div>
                            </div>

                            <div className="card border-blue-200">
                                <div className="card-header bg-blue-50/50"><div className="card-title text-blue-800">{t('salesTargetTitle')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="input-group"><label className="input-label">{t('targetBags')}</label><input type="number" className="input-field text-lg font-bold text-blue-700 border-blue-300" value={d.targetBags} onChange={e=>up('targetBags',null,e.target.value)}/></div>
                                        <div className="input-group"><label className="input-label">{t('sellPrice')}</label><input type="number" className="input-field text-lg" value={d.price} onChange={e=>up('price',null,e.target.value)}/></div>
                                    </div>
                                    <div className="input-group bg-yellow-50 p-2 rounded border border-yellow-200"><label className="input-label text-yellow-800 font-bold">{t('creditTerm')}</label><select className="input-field bg-white text-yellow-900" value={d.creditTerm} onChange={e=>up('creditTerm',null,e.target.value)}><option value="0">{t('cash')}</option><option value="15">TikTok Shop (15 {t('day')})</option><option value="20">{t('credit')} 20</option><option value="30">{t('credit')} 30</option><option value="60">{t('credit')} 60</option></select><div className="text-[10px] text-yellow-600 mt-1">{t('creditWarning')}</div></div>
                                    <div className="flex justify-between bg-slate-50 p-3 rounded mt-2 border border-slate-100">
                                        <div className="text-center"><div className="text-xs text-slate-500">{t('totalSales')}</div><div className="font-bold text-slate-700">{fmt(c.grossRev)}</div></div>
                                        <div className="text-center"><div className="text-xs text-slate-500">{t('targetPerDay')}</div><div className="font-bold text-slate-700">{fmt(c.dayTarget)}</div></div>
                                        <div className="text-center"><div className="text-xs text-slate-500">{t('targetPerHour')}</div><div className="font-bold text-slate-700">{fmtDec(c.hourTarget)}</div></div>
                                    </div>
                                </div>
                            </div>
                            
                            {/* NEW: Capacity Utilization Engine */}
                            <div className="card border-slate-300">
                                <div className="card-header bg-slate-100"><div className="card-title text-slate-700">{t('capTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="input-group mb-2">
                                        <label className="input-label">{t('maxCapInput')}</label>
                                        <input type="number" className="input-field text-right font-bold" value={d.maxCapacity} onChange={e=>up('maxCapacity',null,e.target.value)} />
                                    </div>
                                    
                                    <div className="mb-2">
                                        <div className="flex justify-between text-xs mb-1">
                                            <span>{t('utilRate')}</span>
                                            <span className={`font-bold ${c.utilizationPct > 100 ? 'text-red-600' : (c.utilizationPct < 50 ? 'text-orange-500' : 'text-green-600')}`}>
                                                {c.utilizationPct.toFixed(1)}%
                                            </span>
                                        </div>
                                        <div className="w-full bg-gray-200 rounded-full h-2.5">
                                            <div className={`h-2.5 rounded-full ${c.utilizationPct > 100 ? 'bg-red-600' : (c.utilizationPct > 80 ? 'bg-green-500' : 'bg-blue-500')}`} style={{width: `${Math.min(c.utilizationPct, 100)}%`}}></div>
                                        </div>
                                        <div className="text-[10px] text-right mt-1 text-slate-500">
                                            {c.utilizationPct > 100 ? t('capWarning') : (c.utilizationPct >= 70 ? t('capOptimal') : t('capWaste'))}
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-2 gap-2 mt-3 pt-3 border-t border-dashed">
                                        <div className="text-center p-2 bg-slate-50 rounded">
                                            <div className="text-[10px] text-slate-500">Fixed Cost / Unit</div>
                                            <div className="text-sm font-bold text-slate-700">{fmtDec(c.fixedCostPerUnit)} ‡∏ø</div>
                                        </div>
                                        <div className="text-center p-2 bg-slate-50 rounded">
                                            <div className="text-[10px] text-slate-500">Var Cost / Unit</div>
                                            <div className="text-sm font-bold text-slate-700">{fmtDec(c.varCostPerUnitDisplay)} ‡∏ø</div>
                                        </div>
                                    </div>
                                    <div className="text-center mt-2 p-1 bg-green-50 rounded border border-green-100">
                                        <div className="text-[10px] text-green-600">Total Cost / Unit</div>
                                        <div className="font-bold text-green-800">{fmtDec(c.fixedCostPerUnit + c.varCostPerUnitDisplay)} ‡∏ø</div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Channel Mix Calculator with Sub-Channels */}
                            <div className="card border-purple-200">
                                <div className="card-header bg-purple-50"><div className="card-title text-purple-800">{t('channelMixTitle')}</div></div>
                                <div className="card-body p-2">
                                    {d.channelMix?.b2c || d.channelMix?.b2b ? (
                                        // New sub-channel structure
                                        <>
                                            {/* B2C Section */}
                                            <div className="mb-3 pb-2 border-b border-purple-200">
                                                <div className="text-xs font-bold text-purple-800 mb-2 bg-purple-100 px-2 py-1 rounded">{t('b2c')}</div>
                                                
                                                {/* TikTok Shop */}
                                                <div className="mb-2 pl-2 border-l-2 border-purple-300 bg-purple-50/30 rounded-r p-2">
                                                    <div className="text-xs font-semibold text-purple-700 mb-1">{t('tiktokShop')}</div>
                                                    <div className="overflow-x-auto">
                                                        <table className="w-full text-xs">
                                                            <thead>
                                                                <tr className="bg-purple-100 text-purple-900">
                                                                    <th className="p-1 text-left font-bold">{t('channelMixTable')}</th>
                                                                    <th className="p-1 text-center font-bold">{t('channelPct')}</th>
                                                                    <th className="p-1 text-center font-bold">{t('platformFeePct')}</th>
                                                                    <th className="p-1 text-center font-bold">{t('mktPct')}</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                {['ads', 'organic', 'live', 'affiliate'].map((key, idx) => (
                                                                    <tr key={key} className={`border-b border-purple-100 ${idx % 2 === 0 ? 'bg-white' : 'bg-purple-50/20'} hover:bg-purple-100/50`}>
                                                                        <td className="p-1 text-left">{t(key)}</td>
                                                                        <td className="p-1">
                                                                            <input type="number" className="w-16 border rounded px-1 py-0.5 text-center text-xs focus:border-purple-400" 
                                                                                value={d.channelMix?.b2c?.tiktokShop?.[key] || 0} 
                                                                                onChange={e=>upChannel('channelMix', 'b2c', 'tiktokShop', key, e.target.value)}/>
                                                                        </td>
                                                                        <td className="p-1">
                                                                            <input type="number" className="w-16 border rounded px-1 py-0.5 text-center text-xs text-slate-600 focus:border-slate-400" 
                                                                                value={d.channelFees?.b2c?.tiktokShop?.[key] || 0} 
                                                                                onChange={e=>upChannel('channelFees', 'b2c', 'tiktokShop', key, e.target.value)}/>
                                                                        </td>
                                                                        <td className="p-1">
                                                                            <input type="number" className="w-16 border rounded px-1 py-0.5 text-center text-xs text-blue-600 focus:border-blue-400" 
                                                                                value={d.channelMktPercent?.b2c?.tiktokShop?.[key] || 0} 
                                                                                onChange={e=>upChannel('channelMktPercent', 'b2c', 'tiktokShop', key, e.target.value)}/>
                                                                        </td>
                                                                    </tr>
                                                                ))}
                                                                <tr className="border-t border-purple-300 bg-purple-100 font-bold">
                                                                    <td className="p-1 text-left text-purple-800">{t('totalMix')}</td>
                                                                    <td className="p-1 text-center text-purple-800">
                                                                        {(() => {
                                                                            const total = ['ads', 'organic', 'live', 'affiliate'].reduce((sum, key) => sum + (d.channelMix?.b2c?.tiktokShop?.[key] || 0), 0);
                                                                            return total.toFixed(1);
                                                                        })()}%
                                                                    </td>
                                                                    <td className="p-1 text-center text-purple-800">
                                                                        {(() => {
                                                                            const totalMix = ['ads', 'organic', 'live', 'affiliate'].reduce((sum, key) => sum + (d.channelMix?.b2c?.tiktokShop?.[key] || 0), 0);
                                                                            const weightedFee = ['ads', 'organic', 'live', 'affiliate'].reduce((sum, key) => {
                                                                                const mix = d.channelMix?.b2c?.tiktokShop?.[key] || 0;
                                                                                const fee = d.channelFees?.b2c?.tiktokShop?.[key] || 0;
                                                                                return sum + (mix * fee / 100);
                                                                            }, 0);
                                                                            return totalMix > 0 ? (weightedFee / totalMix * 100).toFixed(2) : '0.00';
                                                                        })()}%
                                                                    </td>
                                                                    <td className="p-1 text-center text-purple-800">
                                                                        {(() => {
                                                                            const totalMix = ['ads', 'organic', 'live', 'affiliate'].reduce((sum, key) => sum + (d.channelMix?.b2c?.tiktokShop?.[key] || 0), 0);
                                                                            const weightedMkt = ['ads', 'organic', 'live', 'affiliate'].reduce((sum, key) => {
                                                                                const mix = d.channelMix?.b2c?.tiktokShop?.[key] || 0;
                                                                                const mkt = d.channelMktPercent?.b2c?.tiktokShop?.[key] || 0;
                                                                                return sum + (mix * mkt / 100);
                                                                            }, 0);
                                                                            return totalMix > 0 ? (weightedMkt / totalMix * 100).toFixed(2) : '0.00';
                                                                        })()}%
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                
                                                {/* Line Shop */}
                                                <div className="mb-2 pl-2 border-l-2 border-purple-300 bg-purple-50/30 rounded-r p-2">
                                                    <div className="text-xs font-semibold text-purple-700 mb-1">{t('lineShop')}</div>
                                                    <div className="overflow-x-auto">
                                                        <table className="w-full text-xs">
                                                            <thead>
                                                                <tr className="bg-purple-100 text-purple-900">
                                                                    <th className="p-1 text-left font-bold">{t('channelMixTable')}</th>
                                                                    <th className="p-1 text-center font-bold">{t('channelPct')}</th>
                                                                    <th className="p-1 text-center font-bold">{t('platformFeePct')}</th>
                                                                    <th className="p-1 text-center font-bold">{t('mktPct')}</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                {['member', 'normal'].map((key, idx) => (
                                                                    <tr key={key} className={`border-b border-purple-100 ${idx % 2 === 0 ? 'bg-white' : 'bg-purple-50/20'} hover:bg-purple-100/50`}>
                                                                        <td className="p-1 text-left">{t(key)}</td>
                                                                        <td className="p-1">
                                                                            <input type="number" className="w-16 border rounded px-1 py-0.5 text-center text-xs focus:border-purple-400" 
                                                                                value={d.channelMix?.b2c?.lineShop?.[key] || 0} 
                                                                                onChange={e=>upChannel('channelMix', 'b2c', 'lineShop', key, e.target.value)}/>
                                                                        </td>
                                                                        <td className="p-1">
                                                                            <input type="number" className="w-16 border rounded px-1 py-0.5 text-center text-xs text-slate-600 focus:border-slate-400" 
                                                                                value={d.channelFees?.b2c?.lineShop?.[key] || 0} 
                                                                                onChange={e=>upChannel('channelFees', 'b2c', 'lineShop', key, e.target.value)}/>
                                                                        </td>
                                                                        <td className="p-1">
                                                                            <input type="number" className="w-16 border rounded px-1 py-0.5 text-center text-xs text-blue-600 focus:border-blue-400" 
                                                                                value={d.channelMktPercent?.b2c?.lineShop?.[key] || 0} 
                                                                                onChange={e=>upChannel('channelMktPercent', 'b2c', 'lineShop', key, e.target.value)}/>
                                                                        </td>
                                                                    </tr>
                                                                ))}
                                                                <tr className="border-t border-purple-300 bg-purple-100 font-bold">
                                                                    <td className="p-1 text-left text-purple-800">{t('totalMix')}</td>
                                                                    <td className="p-1 text-center text-purple-800">
                                                                        {(() => {
                                                                            const total = ['member', 'normal'].reduce((sum, key) => sum + (d.channelMix?.b2c?.lineShop?.[key] || 0), 0);
                                                                            return total.toFixed(1);
                                                                        })()}%
                                                                    </td>
                                                                    <td className="p-1 text-center text-purple-800">
                                                                        {(() => {
                                                                            const totalMix = ['member', 'normal'].reduce((sum, key) => sum + (d.channelMix?.b2c?.lineShop?.[key] || 0), 0);
                                                                            const weightedFee = ['member', 'normal'].reduce((sum, key) => {
                                                                                const mix = d.channelMix?.b2c?.lineShop?.[key] || 0;
                                                                                const fee = d.channelFees?.b2c?.lineShop?.[key] || 0;
                                                                                return sum + (mix * fee / 100);
                                                                            }, 0);
                                                                            return totalMix > 0 ? (weightedFee / totalMix * 100).toFixed(2) : '0.00';
                                                                        })()}%
                                                                    </td>
                                                                    <td className="p-1 text-center text-purple-800">
                                                                        {(() => {
                                                                            const totalMix = ['member', 'normal'].reduce((sum, key) => sum + (d.channelMix?.b2c?.lineShop?.[key] || 0), 0);
                                                                            const weightedMkt = ['member', 'normal'].reduce((sum, key) => {
                                                                                const mix = d.channelMix?.b2c?.lineShop?.[key] || 0;
                                                                                const mkt = d.channelMktPercent?.b2c?.lineShop?.[key] || 0;
                                                                                return sum + (mix * mkt / 100);
                                                                            }, 0);
                                                                            return totalMix > 0 ? (weightedMkt / totalMix * 100).toFixed(2) : '0.00';
                                                                        })()}%
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            {/* B2B Section */}
                                            <div className="mb-3 pt-2 border-t border-purple-200">
                                                <div className="text-xs font-bold text-purple-800 mb-2 bg-purple-100 px-2 py-1 rounded">{t('b2b')}</div>
                                                <div className="overflow-x-auto">
                                                    <table className="w-full text-xs">
                                                        <thead>
                                                            <tr className="bg-purple-100 text-purple-900">
                                                                <th className="p-1 text-left font-bold">{t('channelMixTable')}</th>
                                                                <th className="p-1 text-center font-bold">{t('channelPct')}</th>
                                                                <th className="p-1 text-center font-bold">{t('platformFeePct')}</th>
                                                                <th className="p-1 text-center font-bold">{t('mktPct')}</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            {['hotel', 'export', 'modernTrade'].map((key, idx) => (
                                                                <tr key={key} className={`border-b border-purple-100 ${idx % 2 === 0 ? 'bg-white' : 'bg-purple-50/20'} hover:bg-purple-100/50`}>
                                                                    <td className="p-1 text-left">{t(key)}</td>
                                                                    <td className="p-1">
                                                                        <input type="number" className="w-16 border rounded px-1 py-0.5 text-center text-xs focus:border-purple-400" 
                                                                            value={d.channelMix?.b2b?.[key] || 0} 
                                                                            onChange={e=>upChannel('channelMix', 'b2b', key, null, e.target.value)}/>
                                                                    </td>
                                                                    <td className="p-1">
                                                                        <input type="number" className="w-16 border rounded px-1 py-0.5 text-center text-xs text-slate-600 focus:border-slate-400" 
                                                                            value={d.channelFees?.b2b?.[key] || 0} 
                                                                            onChange={e=>upChannel('channelFees', 'b2b', key, null, e.target.value)}/>
                                                                    </td>
                                                                    <td className="p-1">
                                                                        <input type="number" className="w-16 border rounded px-1 py-0.5 text-center text-xs text-blue-600 focus:border-blue-400" 
                                                                            value={d.channelMktPercent?.b2b?.[key] || 0} 
                                                                            onChange={e=>upChannel('channelMktPercent', 'b2b', key, null, e.target.value)}/>
                                                                    </td>
                                                                </tr>
                                                            ))}
                                                            <tr className="border-t border-purple-300 bg-purple-100 font-bold">
                                                                <td className="p-1 text-left text-purple-800">{t('totalMix')}</td>
                                                                <td className="p-1 text-center text-purple-800">
                                                                    {(() => {
                                                                        const total = ['hotel', 'export', 'modernTrade'].reduce((sum, key) => sum + (d.channelMix?.b2b?.[key] || 0), 0);
                                                                        return total.toFixed(1);
                                                                    })()}%
                                                                </td>
                                                                <td className="p-1 text-center text-purple-800">
                                                                    {(() => {
                                                                        const totalMix = ['hotel', 'export', 'modernTrade'].reduce((sum, key) => sum + (d.channelMix?.b2b?.[key] || 0), 0);
                                                                        const weightedFee = ['hotel', 'export', 'modernTrade'].reduce((sum, key) => {
                                                                            const mix = d.channelMix?.b2b?.[key] || 0;
                                                                            const fee = d.channelFees?.b2b?.[key] || 0;
                                                                            return sum + (mix * fee / 100);
                                                                        }, 0);
                                                                        return totalMix > 0 ? (weightedFee / totalMix * 100).toFixed(2) : '0.00';
                                                                    })()}%
                                                                </td>
                                                                <td className="p-1 text-center text-purple-800">
                                                                    {(() => {
                                                                        const totalMix = ['hotel', 'export', 'modernTrade'].reduce((sum, key) => sum + (d.channelMix?.b2b?.[key] || 0), 0);
                                                                        const weightedMkt = ['hotel', 'export', 'modernTrade'].reduce((sum, key) => {
                                                                            const mix = d.channelMix?.b2b?.[key] || 0;
                                                                            const mkt = d.channelMktPercent?.b2b?.[key] || 0;
                                                                            return sum + (mix * mkt / 100);
                                                                        }, 0);
                                                                        return totalMix > 0 ? (weightedMkt / totalMix * 100).toFixed(2) : '0.00';
                                                                    })()}%
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            
                                            {/* Summary */}
                                            <div className="mt-2 pt-2 border-t border-purple-300 bg-purple-50 rounded p-2">
                                                <div className="grid grid-cols-4 gap-2 text-xs font-bold text-purple-800 mb-1">
                                                    <div className="text-left">{t('totalMix')}</div>
                                                    <div className="text-center">{(() => {
                                                        let total = 0;
                                                        if (d.channelMix?.b2c?.tiktokShop) total += Object.values(d.channelMix.b2c.tiktokShop).reduce((a,b)=>a+b,0);
                                                        if (d.channelMix?.b2c?.lineShop) total += Object.values(d.channelMix.b2c.lineShop).reduce((a,b)=>a+b,0);
                                                        if (d.channelMix?.b2b) total += Object.values(d.channelMix.b2b).reduce((a,b)=>a+b,0);
                                                        return total.toFixed(1);
                                                    })()}%</div>
                                                    <div className="text-center">{t('weightedFee')}</div>
                                                    <div className="text-center">{t('mktPct')}</div>
                                                </div>
                                                <div className="grid grid-cols-4 gap-2 text-xs text-purple-700">
                                                    <div className="text-left">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</div>
                                                    <div className="text-center font-bold">{(() => {
                                                        let total = 0;
                                                        if (d.channelMix?.b2c?.tiktokShop) total += Object.values(d.channelMix.b2c.tiktokShop).reduce((a,b)=>a+b,0);
                                                        if (d.channelMix?.b2c?.lineShop) total += Object.values(d.channelMix.b2c.lineShop).reduce((a,b)=>a+b,0);
                                                        if (d.channelMix?.b2b) total += Object.values(d.channelMix.b2b).reduce((a,b)=>a+b,0);
                                                        return total.toFixed(1);
                                                    })()}%</div>
                                                    <div className="text-center font-bold">{(c?.blendedFeePct || 0).toFixed(2)}%</div>
                                                    <div className="text-center font-bold text-blue-600">{(() => {
                                                        // Calculate weighted marketing % from all channels (same logic as weightedFee)
                                                        let totalMix = 0;
                                                        let weightedMkt = 0;
                                                        
                                                        // B2C - TikTok Shop
                                                        if (d.channelMix?.b2c?.tiktokShop) {
                                                            ['ads', 'organic', 'live', 'affiliate'].forEach(key => {
                                                                const mix = d.channelMix.b2c.tiktokShop[key] || 0;
                                                                const mkt = d.channelMktPercent?.b2c?.tiktokShop?.[key] || 0;
                                                                totalMix += mix;
                                                                weightedMkt += (mix * mkt / 100);
                                                            });
                                                        }
                                                        
                                                        // B2C - Line Shop
                                                        if (d.channelMix?.b2c?.lineShop) {
                                                            ['member', 'normal'].forEach(key => {
                                                                const mix = d.channelMix.b2c.lineShop[key] || 0;
                                                                const mkt = d.channelMktPercent?.b2c?.lineShop?.[key] || 0;
                                                                totalMix += mix;
                                                                weightedMkt += (mix * mkt / 100);
                                                            });
                                                        }
                                                        
                                                        // B2B
                                                        if (d.channelMix?.b2b) {
                                                            ['hotel', 'export', 'modernTrade'].forEach(key => {
                                                                const mix = d.channelMix.b2b[key] || 0;
                                                                const mkt = d.channelMktPercent?.b2b?.[key] || 0;
                                                                totalMix += mix;
                                                                weightedMkt += (mix * mkt / 100);
                                                            });
                                                        }
                                                        
                                                        return totalMix > 0 ? (weightedMkt / totalMix * 100).toFixed(2) : '0.00';
                                                    })()}%</div>
                                                </div>
                                            </div>
                                        </>
                                    ) : (
                                        // Legacy structure (backward compatibility)
                                        <>
                                            <div className="flex justify-between text-xs font-bold text-slate-500 mb-2 px-2">
                                                <span>Channel</span>
                                                <span>{t('channelPct')}</span>
                                                <span>{t('platformFeePct')}</span>
                                            </div>
                                            {['tiktok', 'shopee', 'offline'].map(ch => (
                                                <div key={ch} className="flex items-center justify-between mb-2 text-sm">
                                                    <span className="capitalize w-20">{ch === 'offline' ? t('offline') : ch}</span>
                                                    <input type="number" className="w-12 border rounded text-center" value={d.channelMix?.[ch] || 0} onChange={e=>upNew('channelMix', ch, e.target.value)}/>
                                                    <input type="number" className="w-12 border rounded text-center text-slate-500" value={d.channelFees?.[ch] || 0} onChange={e=>upNew('channelFees', ch, e.target.value)}/>
                                                </div>
                                            ))}
                                            <div className="mt-2 pt-2 border-t flex justify-between text-sm font-bold text-purple-700">
                                                <span>{t('weightedFee')}</span>
                                                <span>{(c?.blendedFeePct || 0).toFixed(2)}%</span>
                                            </div>
                                        </>
                                    )}
                                </div>
                            </div>

                            {/* NEW: Pricing Elasticity */}
                            <div className="card border-blue-200">
                                <div className="card-header bg-blue-50"><div className="card-title text-blue-800">{t('elasticityTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="flex items-center justify-between mb-4">
                                        <div className="text-xs text-slate-500">{t('elasticityCoef')}</div>
                                        <input type="number" className="w-16 border rounded text-right font-bold text-blue-600" step="0.1" value={d.elasticityParams.coefficient} onChange={e=>upNew('elasticityParams', 'coefficient', e.target.value)}/>
                                    </div>
                                    <div className="text-[10px] text-slate-400 mb-3 text-center">
                                        {typeof t('elasticityDesc') === 'function' ? t('elasticityDesc')(d.elasticityParams.coefficient) : t('elasticityDesc')}
                                    </div>
                                    
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-xs text-right">
                                            <thead>
                                                <tr className="bg-slate-100 text-slate-600">
                                                    <th className="p-1 text-center">{t('change')}</th>
                                                    <th className="p-1">{t('optPrice')}</th>
                                                    <th className="p-1">{t('estVol')}</th>
                                                    <th className="p-1">{t('estRev')}</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {(c?.elasticityData || []).map((row, i) => (
                                                    <tr key={i} className={`border-b ${row.pct === '+0%' ? 'bg-blue-50 font-bold' : ''}`}>
                                                        <td className="p-1 text-center">{row.pct}</td>
                                                        <td className="p-1">{fmt(row.price)}</td>
                                                        <td className="p-1">{fmt(row.vol)}</td>
                                                        <td className={`p-1 ${row.rev > (c?.grossRev || 0) ? 'text-green-600' : 'text-slate-600'}`}>{fmt(row.rev)}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div className="card border-orange-200">
                                <div className="card-header bg-orange-50"><div className="card-title text-orange-800">{t('byProductTitle')}</div></div>
                                <div className="card-body p-2">
                                    <table className="w-full text-xs">
                                        <thead><tr className="border-b border-orange-100 text-orange-600"><th className="p-1 text-left">{t('item')}</th><th className="p-1 text-center">%</th><th className="p-1 text-right">{t('ton')}</th><th className="p-1 text-right">{t('pricePerTon')}</th><th className="p-1 text-right">{t('totalIncome')}</th></tr></thead>
                                        <tbody>
                                            {c.byProductsCalc.map((item, i) => (
                                                <tr key={i} className="border-b border-dashed border-slate-100 hover:bg-orange-50/30">
                                                    <td className="p-1">{item.id ? t(item.id) : item.name}</td>
                                                    <td className="p-1 text-center text-slate-400">
                                                        <input type="number" className="input-field text-xs p-1 h-6 w-full text-center" value={item.percent} onChange={e=>upArr('byProducts',i,'percent',e.target.value)}/>
                                                    </td>
                                                    <td className="p-1 text-right font-medium">{fmtDec(item.weight)}</td>
                                                    <td className="p-1"><input type="number" className="input-field text-xs p-1 h-6 w-full text-right" value={item.price} onChange={e=>upArr('byProducts',i,'price',e.target.value)}/></td>
                                                    <td className="p-1 text-right font-bold text-orange-700">{fmt(item.revenue)}</td>
                                                </tr>
                                            ))}
                                            <tr className="bg-orange-50 font-bold border-t border-orange-200"><td colSpan="4" className="p-2 text-right text-orange-800">{t('totalByProductIncome')}</td><td className="p-2 text-right text-orange-800">{fmt(c.totalByProductIncome)}</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title text-sm">{t('logisticsTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="input-group"><label className="input-label">{t('ownDeliveryPercent')}</label><input type="number" className="input-field" value={d.logistics.percent} onChange={e=>up('logistics','percent',e.target.value)}/></div>
                                        <div className="input-group"><label className="input-label">{t('dropOffProfit')}</label><input type="number" className="input-field" value={d.logistics.profit} onChange={e=>up('logistics','profit',e.target.value)}/></div>
                                    </div>
                                    <div className="text-right text-sm text-green-600 font-bold mt-2 border-t pt-2">{t('extraIncome')} +{fmt(c.logIncome)}</div>
                                </div>
                            </div>

                            {/* NEW: VAT Refund Section */}
                            <div className="card border-blue-100">
                                <div className="card-header bg-blue-50"><div className="card-title text-blue-800">{t('vatRefundTitle')}</div></div>
                                <div className="card-body p-3 text-xs">
                                    <div className="flex justify-between mb-1 text-slate-500"><span>{t('vatableExp')}</span><span>{fmt(c.vatBreakdown.vatableExp)}</span></div>
                                    <div className="text-[10px] text-slate-400 pl-2 mb-2">{t('vatNote')}</div>
                                    <div className="flex justify-between border-t border-dashed pt-2">
                                        <span>{t('outputVat')}</span>
                                        <span className="text-red-500 font-bold">{fmt(c.vatBreakdown.outputVat)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>{t('inputVat')}</span>
                                        <span className="text-green-500 font-bold">-{fmt(c.vatBreakdown.inputVat)}</span>
                                    </div>
                                    <div className="text-[10px] text-slate-500 bg-blue-50 p-2 rounded mb-2 border border-blue-100">
                                        <div className="font-bold mb-1">{t('vatExplanationTitle')}</div>
                                        <div className="mb-1">{t('vatExplanation1')}</div>
                                        <div className="mb-1">{t('vatExplanation2')}</div>
                                        <div>{t('vatExplanation3')}</div>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>{t('vatCashPaid')}</span>
                                        <span className="text-slate-700 font-bold">{fmt(c.cfTotal.vatPaid)}</span>
                                    </div>
                                    <div className="text-[9px] text-slate-400 mb-1 pl-2">{t('vatCashPaidDesc')}</div>
                                    <div className="flex justify-between">
                                        <span>{t('vatCreditCarry')}</span>
                                        <span className={`font-bold ${(c.vatCarryEnd || 0) < 0 ? 'text-green-600' : 'text-slate-500'}`}>
                                            {fmt(Math.abs(Math.min(0, c.vatCarryEnd || 0)))}
                                        </span>
                                    </div>
                                    <div className="text-[9px] text-slate-400 mb-1 pl-2">{t('vatCreditCarryDesc')}</div>
                                    <div className={`flex justify-between mt-2 pt-2 border-t font-bold text-sm ${c.vatBreakdown.netVat > 0 ? 'text-red-600' : 'text-green-600'}`}>
                                        <span>{c.vatBreakdown.netVat > 0 ? t('payMore') : t('refund')}</span>
                                        <span>{fmt(Math.abs(c.vatBreakdown.netVat))}</span>
                                    </div>
                                    <div className="text-[9px] text-slate-500 mt-1 pl-2">
                                        {c.vatBreakdown.netVat > 0 ? t('payMoreDesc') : t('refundDesc')}
                                    </div>
                                </div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title text-indigo-700">{t('monthlyFlowTitle')}</div></div>
                                <div className="card-body">
                                    <div className="flow-row"><span className="text-indigo-600 font-bold">{t('cashInflow')}</span><span>{fmt(c.revBreakdown.totalIn)}</span></div>
                                    <div className="flow-row flow-sub"><span>{t('salesGross')}</span><span>{fmt(c.revBreakdown.sales)}</span></div>
                                    <div className="flow-row flow-sub"><span>{t('refundDeduction')}</span><span className="text-red-400">-{fmt(c.refundTotal)}</span></div>
                                    <div className="flow-row flow-sub"><span>- {t('byProductTitle')}</span><span>{fmt(c.revBreakdown.byProduct)}</span></div>
                                    <div className="flow-row flow-sub"><span>- Logistics</span><span>{fmt(c.revBreakdown.logistics)}</span></div>
                                    <div className="flow-row mt-2"><span className="text-red-600 font-bold">{t('vatObligation')}</span><span>-{fmt(c.revBreakdown.vat)}</span></div>
                                    <div className="flow-row flow-sub text-xs"><span>{t('vatNote2')}</span></div>
                                    <div className="flow-row mt-2"><span className="text-orange-600 font-bold">{t('opOutflow')}</span><span>-{fmt(c.revBreakdown.opCost)}</span></div>
                                    <div className="flow-row flow-sub font-bold text-slate-600">{t('varExclVat')}<span>{fmt(c.revBreakdown.opVar)}</span></div>
                                    <div className="flow-row flow-sub pl-6 text-xs text-slate-500">- {t('labelRice')} {fmt(c.revBreakdown.riceCost)} | {t('labelPack')} {fmt(c.revBreakdown.packCost)}<br/>- {t('labelFees')} {fmt(c.revBreakdown.feesCost)} | {t('labelElec')} {fmt(c.revBreakdown.elecCost)}</div>
                                    <div className="flow-row flow-sub font-bold text-slate-600 mt-1">{t('fixedCost')}<span>{fmt(c.revBreakdown.opFixed)}</span></div>
                                    <div className="flow-row flow-sub pl-6 text-xs text-slate-500">- {t('labelSalary')} {fmt(c.revBreakdown.salaryCost)}</div>
                                    
                                    {/* Expanded Other Fixed Breakdown */}
                                    <div className="flow-row flow-sub pl-6 text-xs text-slate-500">- {t('labelOtherFixed')} {fmt(c.revBreakdown.otherFixed)}</div>
                                    <div className="bg-slate-50 rounded p-2 ml-6 my-1 border border-slate-100">
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ {t('labelCampaign')}</span><span>{fmt(c.revBreakdown.otherDetails.campaign)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ {t('labelErp')}</span><span>{fmt(c.revBreakdown.otherDetails.erp)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ {t('labelInsurance')}</span><span>{fmt(c.revBreakdown.otherDetails.insurance)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ {t('labelAudit')}</span><span>{fmt(c.revBreakdown.otherDetails.audit)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ {t('labelTravel')}</span><span>{fmt(c.revBreakdown.otherDetails.travel)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ {t('labelMisc')}</span><span>{fmt(c.revBreakdown.otherDetails.misc)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ {t('labelMaintenance')}</span><span>{fmt(c.revBreakdown.otherDetails.maintenance)}</span></div>
                                    </div>

                                    <div className="flow-row total text-lg bg-green-50 p-2 rounded mt-2"><span className="text-green-700">{t('netCashEbitda')}</span><span className="text-green-700">{fmt(c.revBreakdown.netCash)}</span></div>
                                </div>
                            </div>
                        </div>

                        {/* --- RIGHT: Analysis --- */}
                        <div className="lg:col-span-4 space-y-4">
                            <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">{t('section3')}</h2>
                            
                            <div className="card print-btn-hide">
                                <div className="card-header"><div className="card-title">{t('cumCashflow')}</div></div>
                                <div className="card-body h-[200px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <AreaChart data={c.cf}><CartesianGrid strokeDasharray="3 3" vertical={false} /><XAxis dataKey="m" tick={{fontSize: 10}} /><YAxis tick={{fontSize: 10}} tickFormatter={(val)=>`${val/1000000}M`} /><Tooltip formatter={(value) => fmt(value)} labelFormatter={(l)=>`Month ${l}`} /><Area type="monotone" dataKey="cashFinal" stroke="#10b981" fill="#dcfce7" strokeWidth={2} /></AreaChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>

                            {/* --- NEW: Future Stock Strategy --- */}
                            <div className="card border-blue-300 shadow-md">
                                <div className="card-header bg-blue-100">
                                    <div className="card-title text-blue-900">{t('futureStockTitle')}</div>
                                </div>
                                <div className="card-body p-4">
                                    <div className="flex justify-between items-center mb-2">
                                        <span className="text-sm text-slate-600">{t('cashAvailable')}</span>
                                        <span className="text-lg font-bold text-green-600">{fmt(c.cfTotal.cashFinal)}</span>
                                    </div>
                                    <div className="flex justify-between items-center mb-4 border-b border-blue-100 pb-2">
                                        <span className="text-sm text-slate-600">{t('estRiceCostY2')}</span>
                                        <span className="text-md font-bold text-slate-700">{fmt(c.totalRiceCostY2)}</span>
                                    </div>
                                    
                                    <div className="text-center">
                                        <div className="text-xs text-slate-500 mb-1">{t('canStock')}</div>
                                        <div className="text-4xl font-bold text-blue-700 mb-1">
                                            {c.nextYearStockMonths.toFixed(1)} <span className="text-lg text-slate-500">{t('months')}</span>
                                        </div>
                                        <div className={`text-xs font-bold px-2 py-1 rounded inline-block ${c.nextYearStockMonths >= 12 ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'}`}>
                                            {c.nextYearStockMonths >= 12 ? t('fullYearAble') : t('partialYear')}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Break-even Chart - FIXED */}
                            <div className="card">
                                <div className="card-header"><div className="card-title text-sm">{t('bepTitle')}</div></div>
                                <div className="card-body h-[200px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <ComposedChart data={c.bepData}>
                                            <CartesianGrid strokeDasharray="3 3" />
                                            <XAxis dataKey="units" type="number" tickFormatter={(val)=>`${val/1000}k`} label={{ value: 'Units (Bags)', position: 'insideBottom', offset: -5, fontSize: 10 }} />
                                            <YAxis tickFormatter={(val)=>`${val/1000}k`} tick={{fontSize: 10}} />
                                            <Tooltip formatter={(value) => fmt(value)} labelFormatter={(l)=>`Units: ${fmt(l)}`} />
                                            <Line type="monotone" dataKey="revenue" stroke="#10b981" name="Revenue" strokeWidth={2} dot={false} />
                                            <Line type="monotone" dataKey="totalCost" stroke="#ef4444" name="Total Cost" strokeWidth={2} dot={false} />
                                            <Line type="monotone" dataKey="fixedCost" stroke="#94a3b8" name="Fixed Cost" strokeDasharray="5 5" dot={false} />
                                        </ComposedChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                            
                            {/* Revenue Structure */}
                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('revStruct')}</div></div>
                                <div className="card-body h-[300px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart><Pie data={revenueData} cx="50%" cy="45%" innerRadius={40} outerRadius={70} paddingAngle={5} dataKey="value" label={({percent}) => `${(percent * 100).toFixed(0)}%`}>{revenueData.map((entry, index) => <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />)}</Pie><Tooltip formatter={(value) => fmt(value)} /><Legend iconSize={10} layout="horizontal" verticalAlign="bottom" align="center" wrapperStyle={{fontSize:'11px'}}/></PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                            
                            {/* Cost Structure - Resized */}
                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('costStruct')}</div></div>
                                <div className="card-body h-[300px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart><Pie data={costData} cx="50%" cy="45%" innerRadius={40} outerRadius={70} paddingAngle={2} dataKey="value" label={({percent}) => `${(percent * 100).toFixed(0)}%`}>{costData.map((entry, index) => <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />)}</Pie><Tooltip formatter={(value) => fmt(value)} /><Legend iconSize={10} layout="horizontal" verticalAlign="bottom" align="center" wrapperStyle={{fontSize:'11px'}}/></PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>

                            {/* Multi-Channel P&L Breakdown */}
                            {c.channelBreakdown && Object.keys(c.channelBreakdown).length > 0 && (
                                <div className="card border-purple-200">
                                    <div className="card-header bg-purple-50">
                                        <div className="card-title text-purple-800 text-sm font-bold">{t('channelPandLTitle')}</div>
                                    </div>
                                    <div className="card-body p-2">
                                        <div className="overflow-x-auto custom-scroll">
                                            <table className="w-full text-xs border-collapse">
                                                <thead>
                                                    <tr className="bg-purple-100 text-purple-900">
                                                        <th className="p-2 text-left font-bold border-r border-purple-200">{t('tableChannel')}</th>
                                                        <th className="p-2 text-right font-bold border-r border-purple-200">{t('tableMixPct')}</th>
                                                        <th className="p-2 text-right font-bold border-r border-purple-200">{t('tableRevenue')}</th>
                                                        <th className="p-2 text-right font-bold border-r border-purple-200">{t('tableFee')}</th>
                                                        <th className="p-2 text-right font-bold border-r border-purple-200">{t('tableAds')}</th>
                                                        <th className="p-2 text-right font-bold border-r border-purple-200">{t('tableGrossCM')}</th>
                                                        <th className="p-2 text-right font-bold border-r border-purple-200">{t('tableContribCM')}</th>
                                                        <th className="p-2 text-right font-bold">{t('tableGMPct')}</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {(() => {
                                                        // Group channels by category and sub-channel
                                                        if (!c.channelBreakdown || Object.keys(c.channelBreakdown).length === 0) {
                                                            return null;
                                                        }
                                                        const grouped = {};
                                                        Object.entries(c.channelBreakdown).forEach(([key, data]) => {
                                                            const cat = data.category || 'legacy';
                                                            const subCh = data.subChannel || key;
                                                            const nested = data.nestedChannel;
                                                            if (!grouped[cat]) grouped[cat] = {};
                                                            if (!grouped[cat][subCh]) grouped[cat][subCh] = [];
                                                            grouped[cat][subCh].push({ key, data, nested });
                                                        });
                                                        
                                                        const rows = [];
                                                        Object.entries(grouped).forEach(([cat, subChannels]) => {
                                                            Object.entries(subChannels).forEach(([subCh, items]) => {
                                                                // Category header
                                                                if (rows.length === 0 || rows[rows.length - 1].type !== 'category' || rows[rows.length - 1].cat !== cat) {
                                                                    rows.push({ type: 'category', cat, label: t(cat) });
                                                                }
                                                                // Sub-channel header (if nested)
                                                                if (items.length > 0 && items[0].nested) {
                                                                    rows.push({ type: 'subchannel', subCh, label: t(subCh) });
                                                                }
                                                                // Channel rows
                                                                items.forEach(({ key, data, nested }) => {
                                                                    const label = nested ? t(nested) : (subCh === key ? key : t(subCh));
                                                                    rows.push({ type: 'data', key, data, label, indent: nested ? true : false });
                                                                });
                                                            });
                                                        });
                                                        
                                                        let rowIndex = 0;
                                                        return rows.map((row, idx) => {
                                                            if (row.type === 'category') {
                                                                return (
                                                                    <tr key={`cat-${idx}`} className="bg-purple-200 border-b border-purple-300">
                                                                        <td colSpan="8" className="p-2 font-bold text-purple-900 text-xs">{row.label}</td>
                                                                    </tr>
                                                                );
                                                            }
                                                            if (row.type === 'subchannel') {
                                                                return (
                                                                    <tr key={`sub-${idx}`} className="bg-purple-50 border-b border-purple-100">
                                                                        <td colSpan="8" className="p-1 pl-4 font-semibold text-purple-700 text-xs">{row.label}</td>
                                                                    </tr>
                                                                );
                                                            }
                                                            rowIndex++;
                                                            return (
                                                                <tr key={row.key} className={`border-b border-purple-50 ${rowIndex % 2 === 0 ? 'bg-white' : 'bg-purple-50/20'} hover:bg-purple-100/50 ${row.indent ? 'bg-purple-50/30' : ''}`}>
                                                                    <td className={`p-2 font-medium border-r border-purple-50 ${row.indent ? 'pl-6' : ''}`}>{row.label}</td>
                                                                    <td className="p-2 text-right border-r border-purple-50">{(row.data.mixPct || 0).toFixed(0)}%</td>
                                                                    <td className="p-2 text-right border-r border-purple-50 font-semibold">{fmt(row.data.revExVat || 0)}</td>
                                                                    <td className="p-2 text-right border-r border-purple-50 font-semibold text-red-600">-{fmt(row.data.feeExVat || 0)}</td>
                                                                    <td className="p-2 text-right border-r border-purple-50 font-semibold text-orange-600">-{fmt(row.data.mktExVat || 0)}</td>
                                                                    <td className="p-2 text-right border-r border-purple-50 font-bold text-blue-600">{fmt(row.data.grossMargin || 0)}</td>
                                                                    <td className="p-2 text-right border-r border-purple-50 font-bold text-green-600">{fmt(row.data.contribMargin || 0)}</td>
                                                                    <td className={`p-2 text-right font-bold ${(row.data.grossMarginPct || 0) > 30 ? 'text-green-600' : (row.data.grossMarginPct || 0) > 15 ? 'text-yellow-600' : 'text-red-600'}`}>
                                                                        {(row.data.grossMarginPct || 0).toFixed(1)}%
                                                                    </td>
                                                                </tr>
                                                            );
                                                        });
                                                    })()}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Sensitivity Analysis with Heatmap */}
                            <div className="card mt-4">
                                <div className="card-header"><div className="card-title text-sm">{t('sensitivity')}</div></div>
                                <div className="card-body p-2">
                                    <div className="text-[10px] text-center mb-1 text-slate-400">Y: Price | X: Vol</div>
                                    <table className="w-full matrix-table">
                                        <thead>
                                            <tr>
                                                <th className="bg-slate-100">Price \ Vol</th>
                                                <th className="matrix-header">-10%</th>
                                                <th className="matrix-header">Base</th>
                                                <th className="matrix-header">+10%</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {sensitivityData.map((row, rI) => (
                                                <tr key={rI}>
                                                    <td className="matrix-header">{row[0].pLabel}</td>
                                                    {row.map((cell, cI) => (
                                                        <td key={cI} className={`font-bold ${getHeatmapColor(cell.profit)}`}>{fmt(cell.profit/1000)}k</td>
                                                    ))}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            {/* Spread Sensitivity */}
                            <div className="card mt-4">
                                <div className="card-header"><div className="card-title text-sm">{t('spreadAnalysis')}</div></div>
                                <div className="card-body p-2">
                                    <div className="text-[10px] text-center mb-1 text-slate-400">Y: {t('paddyLabel')} | X: {t('priceLabel')}</div>
                                    <table className="w-full matrix-table">
                                        <thead>
                                            <tr>
                                                <th className="bg-slate-100">Cost \ Price</th>
                                                <th className="matrix-header">-10%</th>
                                                <th className="matrix-header">Base</th>
                                                <th className="matrix-header">+10%</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {spreadData.map((row, rI) => (
                                                <tr key={rI}>
                                                    <td className="matrix-header">{row[0].cLabel}</td>
                                                    {row.map((cell, cI) => (
                                                        <td key={cI} className={`font-bold ${getHeatmapColor(cell.profit)}`}>{fmt(cell.profit/1000)}k</td>
                                                    ))}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            {/* Marketing Funnel & Budget Allocation */}
                            <div className="card mt-4 border-indigo-200">
                                <div className="card-header bg-indigo-50"><div className="card-title text-indigo-800">{t('tiktokAdsTitle')}</div></div>
                                <div className="card-body p-3">
                                    {/* Top Row: Budget & ROAS (The most important for GMV Max) */}
                                    <div className="grid grid-cols-4 gap-2 mb-4 border-b border-indigo-100 pb-3">
                                        <div className="text-center col-span-1">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('totalBudget')}</div>
                                            <div className="text-lg font-bold text-indigo-700">{fmt(c.funnelMetrics.budget)}</div>
                                            <div className="text-[9px] text-slate-400">{t('budgetNote')}</div>
                                        </div>
                                        <div className="text-center bg-indigo-50 rounded border border-indigo-100 p-1 col-span-1">
                                            <div className="text-[10px] text-indigo-800 uppercase font-bold">{t('targetRoas')}</div>
                                            <div className="text-xl font-bold text-indigo-600">{(c.funnelMetrics.roas || 0).toFixed(2)}x</div>
                                            <div className="text-[9px] text-indigo-400">{t('minRoasNote')}</div>
                                        </div>
                                        
                                        {/* NEW: Breakeven ROAS */}
                                        <div className="text-center bg-red-50 rounded border border-red-100 p-1 col-span-1" title={t('beRoasDesc')}>
                                            <div className="text-[10px] text-red-800 uppercase font-bold">{t('beRoas')}</div>
                                            <div className="text-xl font-bold text-red-600">{(c.funnelMetrics.beRoas || 0).toFixed(2)}x</div>
                                            <div className="text-[9px] text-red-400 truncate">{t('beRoasNote')}</div>
                                            <div className="text-[8px] text-red-300 mt-1 hidden md:block">{t('beRoasDesc')}</div>
                                        </div>

                                         <div className="text-center col-span-1">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('acos')}</div>
                                            <div className="text-lg font-bold text-slate-600">{(c.funnelMetrics.acos || 0).toFixed(1)}%</div>
                                            <div className="text-[9px] text-slate-400">{t('acosNote')}</div>
                                        </div>
                                    </div>

                                    {/* Middle Row: Manual Bidding Reference (CPA/CPC) */}
                                    <div className="grid grid-cols-2 gap-4 mb-3">
                                        <div>
                                            <div className="text-[10px] text-slate-400 uppercase font-bold">{t('maxCpa')}</div>
                                            <div className="text-xl font-bold text-pink-600">{fmt(c.funnelMetrics.cpa)} ‡∏ø</div>
                                            <div className="text-[9px] text-slate-400">{t('maxCpaNote')}</div>
                                        </div>
                                        <div>
                                            <div className="text-[10px] text-slate-400 uppercase font-bold">{t('maxCpc')}</div>
                                            <div className="text-xl font-bold text-blue-600">{(c.funnelMetrics.cpc || 0).toFixed(2)} ‡∏ø</div>
                                            <div className="text-[9px] text-slate-400">{t('maxCpcNote')}</div>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-slate-50 rounded p-2 border border-slate-200 space-y-2">
                                        <div className="text-xs font-bold text-slate-700 mb-1 border-b pb-1">{t('funnelInput')}</div>
                                        <div className="flex justify-between items-center text-xs">
                                            <span>{t('basketSize')}</span>
                                            <input type="number" className="w-16 border rounded text-right px-1" step="0.1" value={d.mktFunnel.basketSize} onChange={e=>upFunnel('basketSize', e.target.value)} />
                                        </div>
                                        <div className="flex justify-between items-center text-xs">
                                            <span>Conversion Rate (%)</span>
                                            <input type="number" className="w-16 border rounded text-right px-1" step="0.1" value={d.mktFunnel.cvr} onChange={e=>upFunnel('cvr', e.target.value)} />
                                        </div>
                                        <div className="flex justify-between items-center text-xs">
                                            <span>CTR (%)</span>
                                            <input type="number" className="w-16 border rounded text-right px-1" step="0.1" value={d.mktFunnel.ctr} onChange={e=>upFunnel('ctr', e.target.value)} />
                                        </div>
                                    </div>

                                    <div className="mt-3 space-y-1">
                                        <div className="flex justify-between text-xs">
                                            <span className="text-slate-500">{t('impressionsNeeded')}</span>
                                            <span className="font-medium">{fmt(c.funnelMetrics.impressions)}</span>
                                        </div>
                                        <div className="flex justify-between text-xs">
                                            <span className="text-slate-500">{t('clicksTraffic')}</span>
                                            <span className="font-medium">{fmt(c.funnelMetrics.visitors)}</span>
                                        </div>
                                        <div className="flex justify-between text-xs font-bold text-indigo-700 bg-indigo-50 p-1 rounded">
                                            <span>{t('ordersTarget')}</span>
                                            <span>{fmt(c.funnelMetrics.orders)}</span>
                                        </div>
                                    </div>

                                    {/* Ads Efficiency Matrix */}
                                    <div className="mt-4 pt-3 border-t border-indigo-200">
                                        <div className="flex justify-between items-center mb-2">
                                            <div className="text-xs font-bold text-indigo-800">{t('adsMatrixTitle')}</div>
                                            <div className="text-[9px] text-slate-500">Y: {t('adsMatY')} | X: {t('adsMatX')}</div>
                                        </div>
                                        <table className="w-full matrix-table">
                                            <thead>
                                                <tr>
                                                    <th className="bg-indigo-50 text-[9px] text-indigo-900">{t('tableCvrCtr')}</th>
                                                    {adsMatrixData[0] && adsMatrixData[0].map((cell, i) => (
                                                        <th key={i} className="matrix-header text-[9px]">{cell.ctrLabel}</th>
                                                    ))}
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {adsMatrixData.map((row, i) => (
                                                    <tr key={i}>
                                                        <td className="matrix-header text-[9px]">{row[0].cvrLabel}</td>
                                                        {row.map((cell, j) => (
                                                            <td key={j} className={`text-[10px] font-bold ${cell.roas < c.funnelMetrics.beRoas ? 'bg-red-100 text-red-600' : 'bg-green-100 text-green-700'}`}>
                                                                {cell.roas.toFixed(1)}x
                                                            </td>
                                                        ))}
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                        <div className="text-[9px] text-center mt-1 text-slate-400">*‡∏™‡∏µ‡πÅ‡∏î‡∏á = ‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô (‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ Breakeven {(c.funnelMetrics.beRoas || 0).toFixed(1)}x)</div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Customer Lifetime Value (CLV) */}
                            <div className="card mt-4 border-teal-200">
                                <div className="card-header bg-teal-50"><div className="card-title text-teal-800">{t('clvTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="grid grid-cols-2 gap-3 mb-3">
                                        <div>
                                            <label className="text-[10px] text-slate-500">{t('freqPerYear')}</label>
                                            <input type="number" className="input-field text-center" value={d.clvParams.freq} onChange={e=>upNew('clvParams', 'freq', e.target.value)}/>
                                        </div>
                                        <div>
                                            <label className="text-[10px] text-slate-500">{t('retentionRate')}</label>
                                            <input type="number" className="input-field text-center" value={d.clvParams.retention} onChange={e=>upNew('clvParams', 'retention', e.target.value)}/>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-3 text-center mb-3">
                                        <div className="p-2 border rounded bg-teal-50/50">
                                            <div className="text-[9px] text-slate-400">{t('ltv1')}</div>
                                            <div className="font-bold text-teal-700">{fmt(c.funnelMetrics.ltv1)} ‡∏ø</div>
                                        </div>
                                        <div className="p-2 border rounded bg-teal-50/50">
                                            <div className="text-[9px] text-slate-400">{t('ltv3')}</div>
                                            <div className="font-bold text-teal-700">{fmt(c.funnelMetrics.ltv3)} ‡∏ø</div>
                                        </div>
                                    </div>
                                    <div className="flex justify-between items-center text-xs border-t pt-2">
                                        <span className="font-bold text-slate-600">{t('ltvCacRatio')}</span>
                                        <span className={`font-bold ${c.funnelMetrics.ltvCacRatio >= 3 ? 'text-green-600' : 'text-orange-500'}`}>{(c.funnelMetrics.ltvCacRatio || 0).toFixed(1)}x</span>
                                    </div>
                                    <div className="text-[9px] text-right text-slate-400 mt-1">{t('ltvDesc')}</div>
                                </div>
                            </div>

                        </div>

                        {/* --- BOTTOM --- */}
                        <div className="lg:col-span-12 space-y-6">
                            {/* --- Monte Carlo Simulation --- (Moved above Detailed Monthly Cashflow) */}
                            {monteCarloResults && (
                            <div className="card border-indigo-200 shadow-md">
                                <div className="card-header bg-indigo-50">
                                    <div className="card-title text-indigo-800">{t('mcTitle')}</div>
                                    <div className="text-[10px] text-indigo-500 bg-white px-2 py-1 rounded border border-indigo-100">
                                        Unit: {t('perMonth')} (Monthly Net Profit)
                                    </div>
                                </div>
                                <div className="card-body p-3">
                                    {/* CPM Volatility Model Selector */}
                                    <div className="mb-3 p-2 bg-indigo-50 rounded border border-indigo-100">
                                        <div className="text-[10px] font-bold text-indigo-700 mb-1.5">{t('cpmVolatilityTitle')}</div>
                                        <div className="flex gap-2 text-[9px]">
                                            <button 
                                                className={`px-2 py-1 rounded border flex-1 transition-colors relative ${d.cpmVolatilityModel === 'normal' ? 'bg-indigo-600 text-white border-indigo-600' : 'bg-white text-indigo-700 border-indigo-200 hover:bg-indigo-100'}`}
                                                onClick={() => upStr('cpmVolatilityModel', 'normal')}
                                                onMouseEnter={(e) => {
                                                    const rect = e.target.getBoundingClientRect();
                                                    setTooltip({
                                                        content: t('cpmVolatilityNormalTooltip'),
                                                        x: rect.left + rect.width / 2,
                                                        y: rect.top - 10,
                                                        isCustom: true
                                                    });
                                                }}
                                                onMouseLeave={() => setTooltip(null)}
                                            >
                                                {t('cpmVolatilityNormal')}
                                            </button>
                                            <button 
                                                className={`px-2 py-1 rounded border flex-1 transition-colors relative ${d.cpmVolatilityModel === 'high' ? 'bg-orange-600 text-white border-orange-600' : 'bg-white text-orange-700 border-orange-200 hover:bg-orange-100'}`}
                                                onClick={() => upStr('cpmVolatilityModel', 'high')}
                                                onMouseEnter={(e) => {
                                                    const rect = e.target.getBoundingClientRect();
                                                    setTooltip({
                                                        content: t('cpmVolatilityHighTooltip'),
                                                        x: rect.left + rect.width / 2,
                                                        y: rect.top - 10,
                                                        isCustom: true
                                                    });
                                                }}
                                                onMouseLeave={() => setTooltip(null)}
                                            >
                                                {t('cpmVolatilityHigh')}
                                            </button>
                                            <button 
                                                className={`px-2 py-1 rounded border flex-1 transition-colors relative ${d.cpmVolatilityModel === 'extreme' ? 'bg-red-600 text-white border-red-600' : 'bg-white text-red-700 border-red-200 hover:bg-red-100'}`}
                                                onClick={() => upStr('cpmVolatilityModel', 'extreme')}
                                                onMouseEnter={(e) => {
                                                    const rect = e.target.getBoundingClientRect();
                                                    setTooltip({
                                                        content: t('cpmVolatilityExtremeTooltip'),
                                                        x: rect.left + rect.width / 2,
                                                        y: rect.top - 10,
                                                        isCustom: true
                                                    });
                                                }}
                                                onMouseLeave={() => setTooltip(null)}
                                            >
                                                {t('cpmVolatilityExtreme')}
                                            </button>
                                        </div>
                                        <div className="text-[8px] text-indigo-600 mt-1.5">
                                            {d.cpmVolatilityModel === 'normal' && t('cpmVolatilityNormalDesc')}
                                            {d.cpmVolatilityModel === 'high' && t('cpmVolatilityHighDesc')}
                                            {d.cpmVolatilityModel === 'extreme' && t('cpmVolatilityExtremeDesc')}
                                        </div>
                                    </div>
                                    
                                    <div className="text-[10px] text-slate-500 mb-3">{t('mcDesc')}</div>
                                    
                                    <div className="grid grid-cols-5 gap-2 text-center mb-4">
                                        <div className="p-2 bg-red-50 rounded border border-red-100">
                                            <div className="text-[9px] text-red-500 font-bold">{t('mcP5')}</div>
                                            <div className="text-xs font-bold text-red-700">{fmt(monteCarloResults.p5)}</div>
                                        </div>
                                        <div className="p-2 bg-orange-50 rounded border border-orange-100">
                                            <div className="text-[9px] text-orange-500 font-bold">{t('mcP10')}</div>
                                            <div className="text-xs font-bold text-orange-700">{fmt(monteCarloResults.p10)}</div>
                                        </div>
                                        <div className="p-2 bg-blue-50 rounded border border-blue-100">
                                            <div className="text-[9px] text-blue-500 font-bold">{t('mcP50')}</div>
                                            <div className="text-xs font-bold text-blue-700">{fmt(monteCarloResults.p50)}</div>
                                        </div>
                                        <div className="p-2 bg-green-50 rounded border border-green-100">
                                            <div className="text-[9px] text-green-500 font-bold">{t('mcP90')}</div>
                                            <div className="text-xs font-bold text-green-700">{fmt(monteCarloResults.p90)}</div>
                                        </div>
                                        <div className="p-2 bg-emerald-50 rounded border border-emerald-100">
                                            <div className="text-[9px] text-emerald-500 font-bold">{t('mcP95')}</div>
                                            <div className="text-xs font-bold text-emerald-700">{fmt(monteCarloResults.p95)}</div>
                                        </div>
                                    </div>

                                    {/* Histogram Chart - Moved below percentiles for better readability */}
                                    <div className="h-[200px] mb-4">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <BarChart data={monteCarloResults.histogram}>
                                                <CartesianGrid strokeDasharray="3 3" vertical={false} />
                                                <XAxis dataKey="range" tick={{fontSize: 9}} angle={-45} textAnchor="end" height={50} />
                                                <YAxis tick={{fontSize: 10}} hide />
                                                <Tooltip 
                                                    labelStyle={{color: '#475569'}}
                                                    itemStyle={{color: '#4f46e5'}}
                                                    formatter={(val) => [`${val} runs`, t('mcProb')]}
                                                    labelFormatter={(l) => `Profit ~ ${l}`}
                                                />
                                                <Bar dataKey="count" fill="#6366f1" radius={[4, 4, 0, 0]} />
                                                <ReferenceLine x={monteCarloResults.histogram.find(h => h.val >= monteCarloResults.p50)?.range} stroke="red" strokeDasharray="3 3" label={{ value: 'Median', fontSize: 9, position: 'top', fill: 'red' }} />
                                            </BarChart>
                                        </ResponsiveContainer>
                                    </div>
                                    <div className="text-center text-[10px] text-slate-400 mb-4">X-Axis: Net Profit (THB/Month) | Y-Axis: Probability</div>
                                    
                                    {/* Risk Metrics - Compact Grid */}
                                    {monteCarloResults.riskMetrics && (
                                        <div className="mb-2 p-2 bg-slate-50 rounded border border-slate-200">
                                            <div className="text-[10px] font-bold text-slate-700 mb-1">{t('mcRiskTitle')}</div>
                                            <div className="grid grid-cols-2 md:grid-cols-4 gap-2 text-[9px]">
                                                <div className="p-1.5 bg-white rounded border border-slate-100">
                                                    <div className="text-slate-500 mb-0.5">{t('mcProbLoss')}</div>
                                                    <div className={`font-bold text-sm ${monteCarloResults.riskMetrics.probabilityOfLoss > 30 ? 'text-red-600' : monteCarloResults.riskMetrics.probabilityOfLoss > 10 ? 'text-yellow-600' : 'text-green-600'}`}>
                                                        {monteCarloResults.riskMetrics.probabilityOfLoss.toFixed(1)}%
                                                    </div>
                                                    <div className="text-[8px] text-slate-400 mt-0.5">{t('mcProbLossDesc')}</div>
                                                </div>
                                                <div className="p-1.5 bg-white rounded border border-slate-100">
                                                    <div className="text-slate-500 mb-0.5">{t('mcProbTarget')}</div>
                                                    <div className="font-bold text-sm text-blue-600">
                                                        {monteCarloResults.riskMetrics.probabilityOfTargetProfit.toFixed(1)}%
                                                    </div>
                                                    <div className="text-[8px] text-slate-400 mt-0.5">{t('mcProbTargetDesc')}</div>
                                                </div>
                                                <div className="p-1.5 bg-white rounded border border-slate-100">
                                                    <div className="text-slate-500 mb-0.5">{t('mcProbRoasBelow')}</div>
                                                    <div className="font-bold text-sm text-orange-600">
                                                        {monteCarloResults.riskMetrics.probabilityRoasBelowBreakeven.toFixed(1)}%
                                                    </div>
                                                    <div className="text-[8px] text-slate-400 mt-0.5">{t('mcProbRoasBelowDesc')}</div>
                                                </div>
                                                <div className="p-1.5 bg-white rounded border border-slate-100">
                                                    <div className="text-slate-500 mb-0.5">{t('mcWorstCase')}</div>
                                                    <div className="font-bold text-sm text-red-600">
                                                        {fmt(monteCarloResults.riskMetrics.worstCase)}
                                                    </div>
                                                    <div className="text-[8px] text-slate-400 mt-0.5">{t('mcWorstCaseDesc')}</div>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                    
                                    {/* Sensitivity Analysis - Compact Grid */}
                                    {monteCarloResults.sensitivityAnalysis && monteCarloResults.sensitivityAnalysis.rankedImpacts && (
                                        <div className="mb-2 p-2 bg-purple-50 rounded border border-purple-200">
                                            <div className="text-[10px] font-bold text-purple-700 mb-1">{t('mcSensitivityTitle')}</div>
                                            <div className="text-[9px] text-slate-500 mb-1.5">{t('mcTopDrivers')}</div>
                                            <div className="grid grid-cols-1 md:grid-cols-3 gap-2">
                                                {monteCarloResults.sensitivityAnalysis.rankedImpacts.slice(0, 3).map((item, idx) => (
                                                    <div key={idx} className="p-1.5 bg-white rounded border border-purple-100">
                                                        <div className="text-slate-600 mb-0.5 text-[9px]">{idx + 1}. {item.variable.toUpperCase()}</div>
                                                        <div className="font-bold text-sm text-purple-700 mb-0.5">
                                                            {item.impact.toFixed(1)}%
                                                        </div>
                                                        <div className="text-[8px] text-slate-400">{t('mcElasticityDesc')}</div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    
                                    {/* Growth/Scale Analysis - Compact Grid */}
                                    {monteCarloResults.scaleAnalysis && monteCarloResults.scaleAnalysis.length > 0 && (
                                        <div className="mb-2 p-2 bg-green-50 rounded border border-green-200">
                                            <div className="text-[10px] font-bold text-green-700 mb-1">{t('mcScaleTitle')}</div>
                                            <div className="text-[9px] text-slate-500 mb-1.5">{t('mcScaleDesc')}</div>
                                            <div className="grid grid-cols-1 md:grid-cols-3 gap-2">
                                                {monteCarloResults.scaleAnalysis.map((scenario, idx) => (
                                                    <div key={idx} className="p-1.5 bg-white rounded border border-green-100">
                                                        <div className="font-bold text-green-700 mb-1 text-sm">+{scenario.scalePercent}% {t('traffic')}</div>
                                                        <div className="text-slate-600 space-y-0.5 text-[9px]">
                                                            <div>{t('revenue')}: <span className="font-bold text-green-600">{fmt(scenario.newRevenue)}</span></div>
                                                            <div>{t('profit')}: <span className="font-bold text-green-600">{fmt(scenario.newProfit)}</span></div>
                                                            <div className="flex justify-between">
                                                                <span>ROAS: <span className="font-bold">{scenario.newRoas.toFixed(2)}</span></span>
                                                                <span>{t('risk')}: <span className={`font-bold ${scenario.risk > 20 ? 'text-red-600' : 'text-green-600'}`}>{scenario.risk.toFixed(1)}%</span></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                            )}

                            {/* --- Detailed Monthly Cashflow (Year 1) --- */}
                             <div className="card">
                                <div className="card-header"><div className="card-title text-slate-700">{t('detailedCashflow')} <span className="text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded ml-2">‚ö†Ô∏è Ramp-up 50% (M1-M2)</span></div><div className="flex items-center gap-2 text-xs"><span className="text-slate-500">{t('monthlyGrowth')}</span><input type="number" className="border border-slate-300 rounded px-2 py-1 w-16 text-right" value={d.monthlyGrowth} onChange={e=>up('monthlyGrowth', null, e.target.value)} /><span className="text-slate-500">%</span><span className="ml-2 text-slate-400 font-bold bg-slate-100 px-2 py-1 rounded">Credit: {d.creditTerm} {t('day')}</span></div></div>
                                <div className="overflow-x-auto custom-scroll">
                                    <table className="w-full text-xs text-right border-collapse min-w-[900px]">
                                        <thead className="bg-slate-100 text-slate-600">
                                            <tr>
                                                <th className="p-3 text-center">{t('month')}</th>
                                                <th className="p-3 text-slate-400">{t('cfSales')}</th>
                                                <th className="p-3 text-blue-700 font-bold">{t('cfInflow')}</th>
                                                <th className="p-3 text-red-600 bg-red-50">{t('cfStock')}</th>
                                                <th className="p-3 text-orange-600">{t('cfOpEx')}</th>
                                                <th className="p-3 text-slate-500">{t('cfVat')}</th>
                                                <th className="p-3 text-blue-600">{t('cfOpCash')}</th>
                                                <th className="p-3 font-bold text-green-700 bg-green-50">{t('cfBalance')}</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr className="bg-slate-50 border-b border-slate-200"><td className="p-3 text-center font-bold text-slate-500">{t('start0')}</td><td className="p-3" colSpan="6"></td><td className="p-3 font-bold text-slate-700 bg-green-50/50">{fmt(c.workingCap)}</td></tr>
                                            {c.cf.map((row) => (
                                                <tr key={row.m} className={`border-b hover:bg-slate-50 ${row.cashFinal < 0 ? 'bg-red-50':''}`}>
                                                    <td className="p-3 text-center font-bold text-slate-400">{row.m}</td>
                                                    <td className="p-3 text-slate-400">{fmt(row.rev)}</td>
                                                    <td className="p-3 font-bold text-blue-700">{fmt(row.revCashIn)}</td>
                                                    <td className="p-3 text-red-600 bg-red-50/50 font-medium">{row.stockAdvance > 0 ? fmt(row.stockAdvance) : "-"}</td>
                                                    <td className="p-3 text-orange-600">{fmt(row.opEx)}</td>
                                                    <td className={`p-3 font-bold ${row.vatPaid > 0 ? 'text-orange-500' : 'text-green-500'}`}>{fmt(row.vatPaid)}</td>
                                                    <td className="p-3 font-bold text-blue-600">{fmt(row.netCashFlow)}</td>
                                                    <td className={`p-3 font-bold ${row.cashFinal < 0 ? 'text-red-600':'text-green-700 bg-green-50/30'}`}>{fmt(row.cashFinal)}</td>
                                                </tr>
                                            ))}
                                            <tr className="bg-slate-200 font-bold border-t-2 border-slate-400 text-slate-800">
                                                <td className="p-3 text-center">{t('total')}</td>
                                                <td className="p-3 text-slate-600">{fmt(c.cfTotal.rev)}</td>
                                                <td className="p-3 text-blue-800">{fmt(c.cfTotal.revCashIn)}</td>
                                                <td className="p-3 text-red-700">{fmt(c.cfTotal.stockAdvance)}</td>
                                                <td className="p-3 text-orange-700">{fmt(c.cfTotal.opEx)}</td>
                                                <td className="p-3 text-slate-600">{fmt(c.cfTotal.vatPaid)}</td>
                                                <td className="p-3 text-blue-800">{fmt(c.cfTotal.netCashFlow)}</td>
                                                <td className="p-3 bg-green-100 text-green-900">{fmt(c.cfTotal.cashFinal)}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    {/* Added Note Here */}
                                    <div className="p-2 bg-yellow-50 text-[10px] text-yellow-800 border-t border-yellow-100">
                                        {t('cfNote')}
                                    </div>
                                    <div className="mt-4 grid grid-cols-1 md:grid-cols-4 gap-4 text-center">
                                            <div className="p-3 bg-slate-100 rounded border"><div className="text-xs text-slate-500">{t('wcStart')}</div><div className="font-bold text-slate-700">{fmt(c.workingCap)}</div></div>
                                            <div className={`p-3 rounded border ${c.lowestCashBalance < 0 ? 'bg-red-100 border-red-300' : 'bg-green-50 border-green-200'}`}><div className={`text-xs font-bold ${c.lowestCashBalance < 0 ? 'text-red-600' : 'text-green-600'}`}>{t('lowestCash')}</div><div className={`font-bold ${c.lowestCashBalance < 0 ? 'text-red-700' : 'text-green-700'}`}>{fmt(c.lowestCashBalance)}</div></div>
                                            <div className="p-3 bg-blue-50 rounded border border-blue-100 text-red-500"><div className="text-xs text-red-500">{t('debtService')}</div><div className="font-bold">-{fmt(c.annualPrincipalPaid + c.annualFinanceCost)}</div></div>
                                            <div className="p-3 bg-red-50 rounded border border-red-100"><div className="text-xs text-red-500">{t('taxPaidCash')}</div><div className="font-bold text-red-700">-{fmt(c.cfTotal.tax)}</div></div>
                                            <div className="col-span-1 md:col-span-2 p-3 bg-indigo-50 rounded border border-indigo-200 mt-2 md:mt-0"><div className="text-xs text-indigo-600">{t('netProfitAcc')}</div><div className="font-bold text-xl text-indigo-800">{fmt(c.netProfit)}</div><div className="text-[10px] text-indigo-400">{t('netProfitDesc')}</div></div>
                                            <div className="col-span-1 md:col-span-2 p-3 bg-green-50 rounded border border-green-200 mt-2 md:mt-0"><div className="text-xs text-green-600">{t('cashEndYear')}</div><div className={`font-bold text-xl ${c.cfTotal.cashFinal < 0 ? 'text-red-600':'text-green-800'}`}>{fmt(c.cfTotal.cashFinal)}</div><div className="text-[10px] text-green-500">{t('cashEndDesc')}</div></div>
                                    </div>
                                </div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('taxDepTitle')}</div><div className="flex bg-slate-100 rounded text-[10px] overflow-hidden toggle-switch-container"><button className={`px-2 py-1 ${d.taxPaymentMode==='monthly'?'bg-blue-600 text-white':''}`} onClick={()=>up('taxPaymentMode',null,'monthly')}>{t('monthly')}</button><button className={`px-2 py-1 ${d.taxPaymentMode==='annual'?'bg-blue-600 text-white':''}`} onClick={()=>up('taxPaymentMode',null,'annual')}>{t('annual')}</button><button className={`px-2 py-1 ${d.taxPaymentMode==='deferred'?'bg-blue-600 text-white':''}`} onClick={()=>up('taxPaymentMode',null,'deferred')}>{t('deferred')}</button></div></div>
                                <div className="card-body"><div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                    <div><h4 className="font-bold text-slate-700 mb-3 border-b pb-2">{t('depSchedule')}</h4><table className="w-full text-sm text-right"><thead className="bg-slate-50 text-slate-500"><tr><th className="text-left p-2">{t('asset')}</th><th className="p-2">{t('value')}</th><th className="p-2">{t('lifeYear')}</th><th className="p-2">{t('depPerYear')}</th></tr></thead><tbody><tr><td className="text-left p-2">{t('factory')}</td><td className="p-2">{fmt(d.capex.factory)}</td><td className="p-2"><input type="number" className="input-field text-center w-16" value={d.depreciation.factoryYears} onChange={e=>up('depreciation','factoryYears',e.target.value)}/></td><td className="p-2">{fmt(c.depFactory)}</td></tr><tr><td className="text-left p-2">{t('machine')}</td><td className="p-2">{fmt(d.capex.machine)}</td><td className="p-2"><input type="number" className="input-field text-center w-16" value={d.depreciation.machineYears} onChange={e=>up('depreciation','machineYears',e.target.value)}/></td><td className="p-2">{fmt(c.depMachine)}</td></tr><tr className="font-bold border-t"><td className="text-left p-2">{t('total')}</td><td></td><td></td><td className="p-2 text-red-500">{fmt(c.annualDepreciation)}</td></tr></tbody></table></div>
                                    <div><h4 className="font-bold text-slate-700 mb-3 border-b pb-2">{t('corpTax')}</h4><div className="space-y-2 text-sm"><div className="flex justify-between"><span>{t('pyEbitda')}</span><span>{fmt(c.ebitda)}</span></div><div className="flex justify-between text-red-500"><span>- {t('depreciation')}</span><span>-{fmt(c.annualDepreciation)}</span></div><div className="flex justify-between text-red-500"><span>- {t('interest')}</span><span>-{fmt(c.annualFinanceCost)}</span></div><div className="flex justify-between font-bold text-blue-700 border-t pt-2"><span>{t('taxableIncome')}</span><span>{fmt(c.annualProfitEst)}</span></div></div><div className="bg-slate-50 p-2 rounded text-xs mt-3"><table className="w-full text-right"><thead><tr className="text-slate-400"><th>{t('tier')}</th><th>{t('rate')}</th><th>{t('taxLabel')}</th></tr></thead><tbody>{c.taxDetails.map((t,i)=>(<tr key={i}><td className="text-slate-600">{t.tier}</td><td>{t.rate}%</td><td className="font-medium">{fmt(t.amount)}</td></tr>))}<tr className="border-t font-bold text-red-600"><td colSpan="2" className="pt-1">{t('totalTax')}</td><td className="pt-1">{fmt(c.annualTax)}</td></tr></tbody></table></div></div></div></div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('dividendTitle')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                        <div className="space-y-3"><h4 className="font-bold text-slate-700 text-sm border-b pb-1">{t('policyInput')}</h4><div className="input-group"><label className="input-label">{t('payoutRatio')}</label><input className="input-field" value={d.dividend.payout} onChange={e=>up('dividend','payout',e.target.value)}/></div><div className="input-group"><label className="input-label">{t('shareholders')}</label><input className="input-field" value={d.dividend.founders} onChange={e=>up('dividend','founders',e.target.value)}/></div></div>
                                        <div className="space-y-3"><h4 className="font-bold text-slate-700 text-sm border-b pb-1">{t('netProfitBreakdown')}</h4><div className="flex justify-between text-xs text-slate-500"><span>{t('ebitdaYear')}</span><span>{fmt(c.ebitda)}</span></div><div className="flex justify-between text-xs text-red-400"><span>- {t('depreciation')}</span><span>-{fmt(c.annualDepreciation)}</span></div><div className="flex justify-between text-xs text-red-400"><span>- {t('interest')}</span><span>-{fmt(c.annualFinanceCost)}</span></div><div className="flex justify-between text-xs text-red-400 border-b border-slate-200 pb-1"><span>- {t('taxLiability')}</span><span>-{fmt(c.annualTax)}</span></div><div className="flex justify-between text-sm pt-1"><span className="font-bold text-slate-700">{t('netProfit')}</span><span className="font-bold text-blue-600">{fmt(c.netProfit)}</span></div></div>
                                        <div className="bg-yellow-50 p-4 rounded border border-yellow-200 text-center flex flex-col justify-center"><h4 className="font-bold text-yellow-800 text-sm mb-2">{t('shareholderReturn')}</h4><div className="text-xs text-slate-500 mb-1">{t('totalPool')}</div><div className="text-lg font-bold text-yellow-700 mb-2">{fmt(c.dividendTotal)} ‡∏ø</div><div className="border-t border-yellow-200 my-2"></div><div className="text-2xl font-bold text-yellow-700">{fmt(c.dividendPerPersonYear)} <span className="text-sm font-normal text-yellow-600">{t('perYear')}</span></div><div className="text-sm text-yellow-600 mt-1">{t('avgPerMonth')} {fmt(c.dividendPerPersonMonth)} {t('perMonth')}</div></div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Financial Health Check */}
                            <div className="card border-emerald-200">
                                <div className="card-header bg-emerald-50"><div className="card-title text-emerald-800">{t('financialHealth')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('debtToEquity')}</div>
                                            <div className={`text-lg font-bold ${d.loan.amount/d.regCapital > 2 ? 'text-red-500' : 'text-emerald-600'}`}>{(d.loan.amount/d.regCapital).toFixed(2)}x</div>
                                            <div className="text-[9px] text-slate-400">{t('debtToEquityDesc')}</div>
                                        </div>
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('returnOnAsset')}</div>
                                            <div className="text-lg font-bold text-blue-600">{c.totalSources > 0 ? ((c.netProfit / c.totalSources)*100).toFixed(1) : 0}%</div>
                                            <div className="text-[9px] text-slate-400">{t('roa')}</div>
                                        </div>
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('returnOnEquity')}</div>
                                            <div className="text-lg font-bold text-blue-600">{d.regCapital > 0 ? ((c.netProfit / d.regCapital)*100).toFixed(1) : 0}%</div>
                                            <div className="text-[9px] text-slate-400">{t('roe')}</div>
                                        </div>
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('assetTurnover')}</div>
                                            <div className="text-lg font-bold text-slate-600">{c.totalSources > 0 ? (c.grossRev / c.totalSources).toFixed(2) : 0}x</div>
                                            <div className="text-[9px] text-slate-400">{t('assetTurnoverDesc')}</div>
                                        </div>
                                    </div>

                                    {/* --- NEW MODULE: Cash Runway Display --- */}
                                    <div className="mt-4 pt-4 border-t border-emerald-200 grid grid-cols-1 md:grid-cols-2 gap-4">
                                        {/* Burn Rate Card */}
                                        <div className="p-3 bg-red-50 rounded border border-red-100 flex items-center justify-between">
                                            <div>
                                                <div className="text-xs font-bold text-red-800">{t('burnRateTitle')}</div>
                                                <div className="text-[9px] text-red-500">{t('fixedCostDebtService')}</div>
                                            </div>
                                            <div className="text-lg font-bold text-red-700">
                                                -{fmt(c.monthlyBurnRate)}
                                            </div>
                                        </div>

                                        {/* Runway Card */}
                                        <div className={`p-3 rounded border flex flex-col justify-center ${c.cashRunwayMonths < 3 ? 'bg-red-100 border-red-300' : (c.cashRunwayMonths < 6 ? 'bg-orange-100 border-orange-300' : 'bg-green-100 border-green-300')}`}>
                                            <div className="flex justify-between items-center mb-1">
                                                <div className="text-xs font-bold text-slate-700">{t('runwayTitle')}</div>
                                                <div className={`text-xl font-bold ${c.cashRunwayMonths < 3 ? 'text-red-700' : (c.cashRunwayMonths < 6 ? 'text-orange-700' : 'text-green-700')}`}>
                                                    {c.cashRunwayMonths.toFixed(1)} {t('month')}
                                                </div>
                                            </div>
                                            <div className="w-full bg-white/50 rounded-full h-1.5 mb-1">
                                                <div className={`h-1.5 rounded-full ${c.cashRunwayMonths < 3 ? 'bg-red-600' : (c.cashRunwayMonths < 6 ? 'bg-orange-500' : 'bg-green-600')}`} style={{width: `${Math.min(c.cashRunwayMonths*8, 100)}%`}}></div>
                                            </div>
                                            <div className="text-[9px] text-slate-500 flex justify-between">
                                                <span>{t('runwayMeaning')}</span>
                                                <span className="font-bold">
                                                    {c.cashRunwayMonths < 3 ? t('runwayDanger') : (c.cashRunwayMonths < 6 ? t('runwayWarn') : t('runwaySafe'))}
                                                </span>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            {/* VAT Impact Analysis */}
                            {/* VAT Impact Analysis */}
                            {vatImpactAnalysis && (
                                <div className="card border-purple-200">
                                    <div className="card-header bg-purple-50">
                                        <div className="card-title text-purple-800">{t('vatImpactTitle')}</div>
                                        <div className="flex gap-4 text-xs items-center mt-2">
                                            <div className="flex items-center gap-1">
                                                <span className="text-slate-600">{t('vatRateLabel')}:</span>
                                                <input 
                                                    className="w-16 border rounded text-center px-2 py-1" 
                                                    type="number"
                                                    min="0"
                                                    max="20"
                                                    step="0.1"
                                                    value={d.vatRate !== undefined ? d.vatRate : 7} 
                                                    onChange={e=>{
                                                        const newVatRate = parseFloat(e.target.value) || 7;
                                                        setD(prev => ({ ...prev, vatRate: newVatRate }));
                                                    }}
                                                />
                                                <span className="text-slate-500">%</span>
                                            </div>
                                            <div className="text-xs text-slate-500 italic">{t('vatRateDesc')}</div>
                                        </div>
                                    </div>
                                    <div className="card-body">
                                        <div className="text-xs text-slate-600 mb-4 p-2 bg-purple-50 rounded border border-purple-100">
                                            {t('vatImpactNote')}
                                        </div>
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            {/* Current Scenario */}
                                            <div className="border rounded p-3 bg-blue-50">
                                                <div className="font-bold text-blue-800 text-sm mb-3">{t('vatImpactCurrent')} ({vatImpactAnalysis.currentVatRate}% VAT)</div>
                                                <div className="space-y-2 text-xs">
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-600">{t('vatImpactRevenue')}:</span>
                                                        <span className="font-bold text-blue-700">{fmt(vatImpactAnalysis.currentRevExVat)}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-600">{t('vatImpactCosts')}:</span>
                                                        <span className="font-bold text-red-600">-{fmt(vatImpactAnalysis.currentCostsExVat)}</span>
                                                    </div>
                                                    <div className="flex justify-between border-t border-blue-200 pt-2">
                                                        <span className="text-slate-700 font-semibold">{t('vatImpactProfit')}:</span>
                                                        <span className={`font-bold ${vatImpactAnalysis.currentProfit >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {fmt(vatImpactAnalysis.currentProfit)}
                                                        </span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-600">{t('vatImpactCashFlow')}:</span>
                                                        <span className={`font-bold ${vatImpactAnalysis.currentCashFlow >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {fmt(vatImpactAnalysis.currentCashFlow)}
                                                        </span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-600">{t('vatImpactMargin')}:</span>
                                                        <span className={`font-bold ${vatImpactAnalysis.currentMargin >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {vatImpactAnalysis.currentMargin.toFixed(2)}%
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            {/* Scenario Comparison */}
                                            <div className="border rounded p-3 bg-orange-50">
                                                <div className="font-bold text-orange-800 text-sm mb-3">{t('vatImpactScenario')} ({vatImpactAnalysis.scenarioVatRate}% VAT)</div>
                                                <div className="space-y-2 text-xs">
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-600">{t('vatImpactRevenue')}:</span>
                                                        <span className="font-bold text-orange-700">{fmt(vatImpactAnalysis.scenarioRevExVat)}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-600">{t('vatImpactCosts')}:</span>
                                                        <span className="font-bold text-red-600">-{fmt(vatImpactAnalysis.scenarioCostsExVat)}</span>
                                                    </div>
                                                    <div className="flex justify-between border-t border-orange-200 pt-2">
                                                        <span className="text-slate-700 font-semibold">{t('vatImpactProfit')}:</span>
                                                        <span className={`font-bold ${vatImpactAnalysis.scenarioProfit >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {fmt(vatImpactAnalysis.scenarioProfit)}
                                                        </span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-600">{t('vatImpactCashFlow')}:</span>
                                                        <span className={`font-bold ${vatImpactAnalysis.scenarioCashFlow >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {fmt(vatImpactAnalysis.scenarioCashFlow)}
                                                        </span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-600">{t('vatImpactMargin')}:</span>
                                                        <span className={`font-bold ${vatImpactAnalysis.scenarioMargin >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {vatImpactAnalysis.scenarioMargin.toFixed(2)}%
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        {/* Impact Summary */}
                                        <div className="border-t border-purple-200 pt-4">
                                            <div className="font-bold text-purple-800 text-sm mb-3">{t('vatImpactChange')} ({vatImpactAnalysis.currentVatRate}% ‚Üí {vatImpactAnalysis.scenarioVatRate}%)</div>
                                            <div className="grid grid-cols-2 md:grid-cols-5 gap-3 text-xs">
                                                <div className="p-2 bg-slate-50 rounded border">
                                                    <div className="text-slate-500 mb-1">{t('vatImpactRevenue')}</div>
                                                    <div className={`font-bold ${vatImpactAnalysis.revChange >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                        {vatImpactAnalysis.revChange >= 0 ? '+' : ''}{fmt(vatImpactAnalysis.revChange)}
                                                    </div>
                                                    <div className="text-[10px] text-slate-400">
                                                        ({vatImpactAnalysis.currentRevExVat > 0 ? (vatImpactAnalysis.revChange / vatImpactAnalysis.currentRevExVat * 100).toFixed(2) : '0.00'}%)
                                                    </div>
                                                </div>
                                                <div className="p-2 bg-slate-50 rounded border">
                                                    <div className="text-slate-500 mb-1">{t('vatImpactCosts')}</div>
                                                    <div className={`font-bold ${vatImpactAnalysis.costsChange >= 0 ? 'text-red-600' : 'text-green-600'}`}>
                                                        {vatImpactAnalysis.costsChange >= 0 ? '+' : ''}{fmt(vatImpactAnalysis.costsChange)}
                                                    </div>
                                                    <div className="text-[10px] text-slate-400">
                                                        ({vatImpactAnalysis.currentCostsExVat > 0 ? (vatImpactAnalysis.costsChange / vatImpactAnalysis.currentCostsExVat * 100).toFixed(2) : '0.00'}%)
                                                    </div>
                                                </div>
                                                <div className="p-2 bg-slate-50 rounded border">
                                                    <div className="text-slate-500 mb-1">{t('vatImpactProfit')}</div>
                                                    <div className={`font-bold ${vatImpactAnalysis.profitChange >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                        {vatImpactAnalysis.profitChange >= 0 ? '+' : ''}{fmt(vatImpactAnalysis.profitChange)}
                                                    </div>
                                                    <div className="text-[10px] text-slate-400">
                                                        ({Math.abs(vatImpactAnalysis.currentProfit) > 0 ? (vatImpactAnalysis.profitChange / Math.abs(vatImpactAnalysis.currentProfit) * 100).toFixed(2) : 'N/A'}%)
                                                    </div>
                                                </div>
                                                <div className="p-2 bg-slate-50 rounded border">
                                                    <div className="text-slate-500 mb-1">{t('vatImpactCashFlow')}</div>
                                                    <div className={`font-bold ${vatImpactAnalysis.cashFlowChange >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                        {vatImpactAnalysis.cashFlowChange >= 0 ? '+' : ''}{fmt(vatImpactAnalysis.cashFlowChange)}
                                                    </div>
                                                    <div className="text-[10px] text-slate-400">
                                                        ({Math.abs(vatImpactAnalysis.currentCashFlow) > 0 ? (vatImpactAnalysis.cashFlowChange / Math.abs(vatImpactAnalysis.currentCashFlow) * 100).toFixed(2) : 'N/A'}%)
                                                    </div>
                                                </div>
                                                <div className="p-2 bg-slate-50 rounded border">
                                                    <div className="text-slate-500 mb-1">{t('vatImpactMargin')}</div>
                                                    <div className={`font-bold ${vatImpactAnalysis.marginChange >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                        {vatImpactAnalysis.marginChange >= 0 ? '+' : ''}{vatImpactAnalysis.marginChange.toFixed(2)}%
                                                    </div>
                                                    <div className="text-[10px] text-slate-400">
                                                        ({vatImpactAnalysis.currentMargin.toFixed(2)}% ‚Üí {vatImpactAnalysis.scenarioMargin.toFixed(2)}%)
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('projectionTitle')}</div><div className="flex gap-4 text-xs items-center"><div className="flex items-center gap-1"><span>{t('growthLabel')}</span><input className="w-12 border rounded text-center" value={d.growth} onChange={e=>up('growth',null,e.target.value)}/>%</div><div className="flex items-center gap-1"><span>{t('inflationLabel')}</span><input className="w-12 border rounded text-center" value={d.inflation} onChange={e=>up('inflation',null,e.target.value)}/>%</div><div className="flex items-center gap-1 font-bold text-blue-600"><span>{t('discountRateLabel')}</span><input className="w-12 border rounded text-center" value={d.discountRate} onChange={e=>up('discountRate',null,e.target.value)}/>%</div></div></div>
                                <div className="overflow-x-auto custom-scroll mb-2">
                                    <table className="w-full text-xs text-right border-collapse min-w-[800px]"><thead className="bg-indigo-900 text-white"><tr><th className="p-3 text-center">{t('pyYear')}</th><th className="p-3">{t('pyRev')}</th><th className="p-3 text-red-300">{t('pyExp')}</th><th className="p-3 font-bold text-yellow-300">{t('pyEbitda')}</th><th className="p-3 text-slate-300">{t('pyDep')}</th><th className="p-3 text-orange-300">{t('pyTax')}</th><th className="p-3 font-bold text-blue-300 bg-indigo-800">{t('pyNet')}</th><th className="p-3 text-green-300">{t('pyDiv')}</th><th className="p-3 font-bold text-green-400 bg-indigo-950">{t('pyCashEnd')}</th></tr></thead>
                                    <tbody>{projection.data.map((y,i) => (<tr key={i} className="border-b last:border-0 hover:bg-indigo-50"><td className="p-3 text-center font-bold text-indigo-900 bg-gray-50">{y.y}</td><td className="p-3 font-medium">{fmt(y.rev)}</td><td className="p-3 text-red-600">{fmt(y.exp)}</td><td className="p-3 font-bold text-yellow-700 bg-yellow-50">{fmt(y.ebitda)}</td><td className="p-3 text-slate-500">{fmt(y.dep)}</td><td className="p-3 text-orange-600">{fmt(y.tax)}{y.taxSaving > 0 && <div className="text-[9px] text-green-500">({t('taxSave')} {fmt(y.taxSaving)})</div>}</td><td className="p-3 font-bold text-blue-700 bg-blue-50">{fmt(y.net)}</td><td className="p-3 text-green-700">{fmt(y.div)}</td><td className="p-3 font-bold text-green-800 bg-green-100">{fmt(y.cash)}</td></tr>))}</tbody></table>
                                </div>
                                <div className="p-3 bg-blue-50 border-t flex justify-between items-center">
                                    <div className="text-xs text-slate-500">{t('npvDesc')}</div>
                                    <div className={`text-xl font-bold ${projection.npv > 0 ? 'text-green-600' : 'text-red-600'}`}>NPV: {fmt(projection.npv)}</div>
                                </div>
                            </div>

                            {/* Professional Business Analysis - Detailed Version */}
                            <div className="card mt-6 border-purple-300 shadow-lg bg-gradient-to-br from-purple-50 to-blue-50">
                                <div className="card-header bg-gradient-to-r from-purple-600 to-blue-600 text-white">
                                    <div className="card-title text-white flex items-center gap-2">
                                        <span className="text-2xl">üìã</span>
                                        <span>{t('businessAnalysis')}</span>
                                    </div>
                                </div>
                                <div className="card-body p-4 space-y-4">
                                    {(() => {
                                        // Calculate Business Viability Score (0-100)
                                        let viabilityScore = 0;
                                        let scoreFactors = [];
                                        
                                        // 1. Profitability (30 points)
                                        if (c.netProfit > 0) {
                                            const profitScore = Math.min(30, (c.netProfit / 1000000) * 30);
                                            viabilityScore += profitScore;
                                            scoreFactors.push({ name: 'Profitability', score: profitScore, max: 30 });
                                        }
                                        
                                        // 2. Margins (20 points)
                                        const marginScore = Math.min(20, (c.netMargin / 20) * 20);
                                        viabilityScore += marginScore;
                                        scoreFactors.push({ name: 'Margins', score: marginScore, max: 20 });
                                        
                                        // 3. Cash Flow (20 points)
                                        const cashScore = c.lowestCashBalance >= 0 ? 20 : Math.max(0, 20 + (c.lowestCashBalance / 100000));
                                        viabilityScore += cashScore;
                                        scoreFactors.push({ name: 'Cash Flow', score: cashScore, max: 20 });
                                        
                                        // 4. DSCR (15 points)
                                        const dscrScore = c.dscr >= 1.25 ? 15 : (c.dscr >= 1 ? 10 : Math.max(0, c.dscr * 10));
                                        viabilityScore += dscrScore;
                                        scoreFactors.push({ name: 'Debt Service', score: dscrScore, max: 15 });
                                        
                                        // 5. ROAS/Marketing Efficiency (15 points)
                                        const roasScore = Math.min(15, (c.funnelMetrics.roas / 5) * 15);
                                        viabilityScore += roasScore;
                                        scoreFactors.push({ name: 'Marketing Efficiency', score: roasScore, max: 15 });
                                        
                                        viabilityScore = Math.max(0, Math.min(100, viabilityScore));
                                        
                                        // Determine viability level
                                        let viabilityLevel = '';
                                        let viabilityColor = '';
                                        if (viabilityScore >= 80) {
                                            viabilityLevel = t('excellent');
                                            viabilityColor = 'text-green-600';
                                        } else if (viabilityScore >= 60) {
                                            viabilityLevel = t('good');
                                            viabilityColor = 'text-blue-600';
                                        } else if (viabilityScore >= 40) {
                                            viabilityLevel = t('fair');
                                            viabilityColor = 'text-yellow-600';
                                        } else if (viabilityScore >= 20) {
                                            viabilityLevel = t('poor');
                                            viabilityColor = 'text-orange-600';
                                        } else {
                                            viabilityLevel = t('critical');
                                            viabilityColor = 'text-red-600';
                                        }
                                        
                                        // Analyze Strengths
                                        const strengths = [];
                                        if (c.netProfit > 0) strengths.push(lang === 'th' ? `‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ ${fmt(c.netProfit)} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£` : `ÂáÄÂà©Ê∂¶ ${fmt(c.netProfit)} Ê≥∞Èì¢ÔºåÊòæÁ§∫ÁõàÂà©ËÉΩÂäõ`);
                                        if (c.netMargin > 15) strengths.push(lang === 'th' ? `Net Margin ${(c.netMargin || 0).toFixed(1)}% ‡∏™‡∏π‡∏á ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏î‡∏µ` : `Net Margin ${(c.netMargin || 0).toFixed(1)}% È´òÔºåÊòæÁ§∫ÊàêÊú¨ÁÆ°ÁêÜÊïàÁéá`);
                                        if (c.grossMargin > 30) strengths.push(lang === 'th' ? `Gross Margin ${(c.grossMargin || 0).toFixed(1)}% ‡∏™‡∏π‡∏á ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô` : `Gross Margin ${(c.grossMargin || 0).toFixed(1)}% È´òÔºåÊòæÁ§∫Á´û‰∫âÂäõ`);
                                        if (c.funnelMetrics.roas >= 5) strengths.push(lang === 'th' ? `ROAS ${(c.funnelMetrics.roas || 0).toFixed(2)}x ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏î‡∏µ` : `ROAS ${(c.funnelMetrics.roas || 0).toFixed(2)}x ‰ºòÁßÄÔºåÊòæÁ§∫Ëê•ÈîÄÊïàÁéá`);
                                        if (c.dscr >= 1.25) strengths.push(lang === 'th' ? `DSCR ${(c.dscr || 0).toFixed(2)} ‡∏™‡∏π‡∏á ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏î‡∏µ` : `DSCR ${(c.dscr || 0).toFixed(2)} È´òÔºåÊòæÁ§∫ÂÅøÂÄ∫ËÉΩÂäõÂº∫`);
                                        if (c.lowestCashBalance >= 0) strengths.push(lang === 'th' ? `‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å‡∏ï‡∏•‡∏≠‡∏î ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏î‡∏µ` : `Áé∞ÈáëÊµÅÂßãÁªà‰∏∫Ê≠£ÔºåÊòæÁ§∫ÊµÅÂä®ÊÄßËâØÂ•Ω`);
                                        if (projection && projection.npv > 0) strengths.push(lang === 'th' ? `NPV ${fmt(projection.npv)} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏™‡∏î‡∏á‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ó‡∏≤‡∏á‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡∏î‡∏µ` : `NPV ${fmt(projection.npv)} Ê≥∞Èì¢ÔºåÊòæÁ§∫ÁªèÊµé‰ª∑ÂÄºËâØÂ•Ω`);
                                        
                                        // Analyze Weaknesses
                                        const weaknesses = [];
                                        if (c.netProfit <= 0) weaknesses.push(lang === 'th' ? `‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô ${fmt(Math.abs(c.netProfit))} ‡∏ö‡∏≤‡∏ó ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á` : `‰ªç‰∫èÊçü ${fmt(Math.abs(c.netProfit))} Ê≥∞Èì¢ÔºåÈúÄË¶ÅÊîπËøõ`);
                                        if (c.netMargin < 5) weaknesses.push(lang === 'th' ? `Net Margin ${(c.netMargin || 0).toFixed(1)}% ‡∏ï‡πà‡∏≥ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û` : `Net Margin ${(c.netMargin || 0).toFixed(1)}% ‰ΩéÔºåÈúÄË¶ÅÊèêÈ´òÊïàÁéá`);
                                        if (c.grossMargin < 20) weaknesses.push(lang === 'th' ? `Gross Margin ${(c.grossMargin || 0).toFixed(1)}% ‡∏ï‡πà‡∏≥ ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ` : `Gross Margin ${(c.grossMargin || 0).toFixed(1)}% ‰ΩéÔºåÊàêÊú¨ËøáÈ´ò`);
                                        if (c.funnelMetrics.roas < 3) weaknesses.push(lang === 'th' ? `ROAS ${(c.funnelMetrics.roas || 0).toFixed(2)}x ‡∏ï‡πà‡∏≥ ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á` : `ROAS ${(c.funnelMetrics.roas || 0).toFixed(2)}x ‰ΩéÔºåËê•ÈîÄÊïàÁéáÈúÄË¶ÅÊîπËøõ`);
                                        if (c.dscr < 1) weaknesses.push(lang === 'th' ? `DSCR ${(c.dscr || 0).toFixed(2)} ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 1 ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ` : `DSCR ${(c.dscr || 0).toFixed(2)} ‰Ωé‰∫é 1ÔºåÊó†Ê≥ïÂÅøËøòÂÄ∫Âä°`);
                                        if (c.lowestCashBalance < 0) weaknesses.push(lang === 'th' ? `‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ï‡∏¥‡∏î‡∏•‡∏ö ${fmt(Math.abs(c.lowestCashBalance))} ‡∏ö‡∏≤‡∏ó ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á` : `Áé∞ÈáëÊµÅ‰∏∫Ë¥ü ${fmt(Math.abs(c.lowestCashBalance))} Ê≥∞Èì¢ÔºåÂ≠òÂú®È£éÈô©`);
                                        if (projection && projection.npv < 0) weaknesses.push(lang === 'th' ? `NPV ‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡πÅ‡∏™‡∏î‡∏á‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ó‡∏≤‡∏á‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÑ‡∏°‡πà‡∏î‡∏µ` : `NPV ‰∏∫Ë¥üÔºåÊòæÁ§∫ÁªèÊµé‰ª∑ÂÄº‰∏ç‰Ω≥`);
                                        
                                        // Risk Assessment
                                        const risks = [];
                                        if (c.netProfit <= 0) risks.push({ level: 'high', text: lang === 'th' ? '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏™‡∏π‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ' : '‰∫èÊçüÈ£éÈô©È´òÔºåÈúÄË¶ÅÁ´ãÂç≥ÊîπËøõ' });
                                        if (c.lowestCashBalance < 0) risks.push({ level: 'high', text: lang === 'th' ? '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô' : 'ÊµÅÂä®ÊÄßÈ£éÈô©ÔºåÈúÄË¶ÅË∞®ÊÖéË¥¢Âä°' });
                                        if (c.dscr < 1) risks.push({ level: 'critical', text: lang === 'th' ? '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô' : 'ÂÅøÂÄ∫È£éÈô©ÔºåÈúÄË¶ÅÁ¥ßÊÄ•Ëß£ÂÜ≥' });
                                        if (c.netMargin < 5) risks.push({ level: 'medium', text: lang === 'th' ? '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≥ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û' : 'Âà©Ê∂¶‰ΩéÈ£éÈô©ÔºåÈúÄË¶ÅÊèêÈ´òÊïàÁéá' });
                                        if (c.funnelMetrics.roas < 3) risks.push({ level: 'medium', text: lang === 'th' ? '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏ï‡πà‡∏≥' : 'Ëê•ÈîÄÊïàÁéá‰ΩéÈ£éÈô©' });
                                        if (d.targetBags < c.bepUnits) risks.push({ level: 'medium', text: lang === 'th' ? `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ ${fmt(d.targetBags)} ‡∏ñ‡∏∏‡∏á ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ BEP ${fmt(c.bepUnits)} ‡∏ñ‡∏∏‡∏á` : `ÈîÄÂîÆÈ¢ù ${fmt(d.targetBags)} Ë¢ã‰Ωé‰∫é BEP ${fmt(c.bepUnits)} Ë¢ã` });
                                        
                                        // Strategic Recommendations
                                        const recommendations = [];
                                        if (c.netProfit <= 0) {
                                            recommendations.push(lang === 'th' ? 'üî¥ ‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£' : 'üî¥ Á¥ßÊÄ•ÔºöÂ¢ûÂä†ÈîÄÂîÆÈ¢ùÊàñÈôç‰ΩéÊàêÊú¨‰ª•ÂÆûÁé∞ÁõàÂà©');
                                        }
                                        if (c.netMargin < 10) {
                                            recommendations.push(lang === 'th' ? 'üìà ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏° Net Margin' : 'üìà ÊèêÈ´òÂîÆ‰ª∑ÊàñÈôç‰ΩéÊàêÊú¨‰ª•Â¢ûÂä† Net Margin');
                                        }
                                        if (c.funnelMetrics.roas < 4) {
                                            recommendations.push(lang === 'th' ? 'üì¢ ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î ‡πÄ‡∏û‡∏¥‡πà‡∏° CTR/CVR ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î CPM' : 'üì¢ ÊîπËøõËê•ÈîÄÊïàÁéáÔºåÊèêÈ´ò CTR/CVR ÊàñÈôç‰Ωé CPM');
                                        }
                                        if (c.lowestCashBalance < 0) {
                                            recommendations.push(lang === 'th' ? 'üí∞ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô' : 'üí∞ ÁÆ°ÁêÜÁé∞ÈáëÊµÅÔºåÊ≥®ÊÑèËê•ËøêËµÑÈáë');
                                        }
                                        if (c.dscr < 1.25) {
                                            recommendations.push(lang === 'th' ? 'üí≥ ‡πÄ‡∏û‡∏¥‡πà‡∏° EBITDA ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á DSCR' : 'üí≥ Â¢ûÂä† EBITDA ÊàñÂáèÂ∞ëÂÄ∫Âä°‰ª•ÊîπÂñÑ DSCR');
                                        }
                                        if (d.targetBags < c.bepUnits) {
                                            recommendations.push(lang === 'th' ? `üéØ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ñ‡∏∂‡∏á ${fmt(c.bepUnits)} ‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Break-even` : `üéØ Â¢ûÂä†ÈîÄÂîÆÈ¢ùËá≥ ${fmt(c.bepUnits)} Ë¢ã/Êúà‰ª•ËææÂà∞Áõà‰∫èÂπ≥Ë°°`);
                                        }
                                        if (viabilityScore >= 80) {
                                            recommendations.push(lang === 'th' ? '‚úÖ ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à' : '‚úÖ ÂïÜ‰∏öÊ®°ÂºèÂº∫Âä≤ÔºåÂáÜÂ§áÊâ©Â±ï‰∏öÂä°');
                                        }
                                        
                                        return (
                                            <>
                                                {/* Viability Score */}
                                                <div className="bg-white rounded-lg p-4 border-2 border-purple-200 shadow-md">
                                                    <div className="flex items-center justify-between mb-3">
                                                        <h4 className="font-bold text-lg text-purple-700">{t('viabilityScore')}</h4>
                                                        <div className={`text-3xl font-bold ${viabilityColor}`}>{viabilityScore.toFixed(0)}/100</div>
                                                    </div>
                                                    <div className="w-full bg-gray-200 rounded-full h-4 mb-2">
                                                        <div 
                                                            className={`h-4 rounded-full transition-all ${
                                                                viabilityScore >= 80 ? 'bg-green-500' : 
                                                                viabilityScore >= 60 ? 'bg-blue-500' : 
                                                                viabilityScore >= 40 ? 'bg-yellow-500' : 
                                                                viabilityScore >= 20 ? 'bg-orange-500' : 'bg-red-500'
                                                            }`}
                                                            style={{ width: `${viabilityScore}%` }}
                                                        ></div>
                                                    </div>
                                                    <div className={`text-sm font-semibold ${viabilityColor}`}>{viabilityLevel}</div>
                                                    <div className="text-xs text-slate-500 mt-2">
                                                        {scoreFactors.map((f, i) => (
                                                            <div key={i} className="flex justify-between">
                                                                <span>{f.name}:</span>
                                                                <span className="font-semibold">{f.score.toFixed(1)}/{f.max}</span>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                                
                                                {/* Key Metrics Grid */}
                                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3">
                                                    {/* NPV */}
                                                    <div className={`p-3 rounded border-l-4 ${projection && projection.npv > 0 ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'}`}>
                                                        <div className="text-xs text-slate-600 mb-1">{lang === 'th' ? 'NPV (‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥)' : 'NPV (Net Present Value)'}</div>
                                                        <div className={`text-xl font-bold ${projection && projection.npv > 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {projection ? fmt(projection.npv) : 'N/A'}
                                                        </div>
                                                        <div className="text-[10px] text-slate-500 mt-1">
                                                            {projection && projection.npv > 0 ? (lang === 'th' ? '‚úÖ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤' : '‚úÖ È°πÁõÆÊúâ‰ª∑ÂÄº') : (lang === 'th' ? '‚ùå ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤' : '‚ùå È°πÁõÆÊó†‰ª∑ÂÄº')}
                                                        </div>
                                                    </div>
                                                    
                                                    {/* ROAS */}
                                                    <div className={`p-3 rounded border-l-4 ${c.funnelMetrics.roas >= 5 ? 'bg-blue-50 border-blue-500' : (c.funnelMetrics.roas >= 3 ? 'bg-yellow-50 border-yellow-500' : 'bg-orange-50 border-orange-500')}`}>
                                                        <div className="text-xs text-slate-600 mb-1">{lang === 'th' ? 'ROAS (‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤)' : 'ROAS (Return on Ad Spend)'}</div>
                                                        <div className="text-xl font-bold text-blue-600">{(c.funnelMetrics.roas || 0).toFixed(2)}x</div>
                                                        <div className="text-[10px] text-slate-500 mt-1">
                                                            {c.funnelMetrics.roas >= 5 ? (lang === 'th' ? 'üöÄ ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°' : 'üöÄ ‰ºòÁßÄ') : c.funnelMetrics.roas >= 3 ? (lang === 'th' ? '‚ö†Ô∏è ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á' : '‚ö†Ô∏è ‰∏≠Á≠â') : (lang === 'th' ? 'üî• ‡∏ï‡πà‡∏≥' : 'üî• ‰Ωé')}
                                                        </div>
                                                    </div>
                                                    
                                                    {/* Cash Flow */}
                                                    <div className={`p-3 rounded border-l-4 ${c.lowestCashBalance >= 0 ? 'bg-emerald-50 border-emerald-500' : 'bg-red-50 border-red-500'}`}>
                                                        <div className="text-xs text-slate-600 mb-1">{lang === 'th' ? '‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î' : 'ÊúÄ‰ΩéÁé∞ÈáëÊµÅ'}</div>
                                                        <div className={`text-xl font-bold ${c.lowestCashBalance >= 0 ? 'text-emerald-600' : 'text-red-600'}`}>
                                                            {fmt(c.lowestCashBalance)}
                                                        </div>
                                                        <div className="text-[10px] text-slate-500 mt-1">
                                                            {c.lowestCashBalance >= 0 ? (lang === 'th' ? 'üí∞ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢' : 'üí∞ ÂÆâÂÖ®') : (lang === 'th' ? 'üí∏ ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á' : 'üí∏ È£éÈô©')}
                                                        </div>
                                                    </div>
                                                    
                                                    {/* EBITDA */}
                                                    <div className={`p-3 rounded border-l-4 ${c.ebitda > 0 ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'}`}>
                                                        <div className="text-xs text-slate-600 mb-1">{lang === 'th' ? 'EBITDA (‡∏Å‡∏≥‡πÑ‡∏£‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢)' : 'EBITDA (Earnings Before Interest)'}</div>
                                                        <div className={`text-xl font-bold ${c.ebitda > 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {fmt(c.ebitda)}
                                                        </div>
                                                        <div className="text-[10px] text-slate-500 mt-1">
                                                            {c.ebitda > 0 ? (lang === 'th' ? '‚úÖ ‡∏î‡∏µ' : '‚úÖ Â•Ω') : (lang === 'th' ? '‚ùå ‡∏ï‡∏¥‡∏î‡∏•‡∏ö' : '‚ùå Ë¥ü')}
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                {/* Strengths & Weaknesses */}
                                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    {/* Strengths */}
                                                    {strengths.length > 0 && (
                                                        <div className="bg-green-50 rounded-lg p-4 border-l-4 border-green-500">
                                                            <h4 className="font-bold text-green-700 mb-2 flex items-center gap-2">
                                                                <span>‚úÖ</span> {t('businessStrengths')}
                                                            </h4>
                                                            <ul className="space-y-1 text-sm text-green-800">
                                                                {strengths.map((s, i) => (
                                                                    <li key={i} className="flex items-start gap-2">
                                                                        <span>‚Ä¢</span>
                                                                        <span>{s}</span>
                                                                    </li>
                                                                ))}
                                                            </ul>
                                                        </div>
                                                    )}
                                                    
                                                    {/* Weaknesses */}
                                                    {weaknesses.length > 0 && (
                                                        <div className="bg-orange-50 rounded-lg p-4 border-l-4 border-orange-500">
                                                            <h4 className="font-bold text-orange-700 mb-2 flex items-center gap-2">
                                                                <span>‚ö†Ô∏è</span> {t('businessWeaknesses')}
                                                            </h4>
                                                            <ul className="space-y-1 text-sm text-orange-800">
                                                                {weaknesses.map((w, i) => (
                                                                    <li key={i} className="flex items-start gap-2">
                                                                        <span>‚Ä¢</span>
                                                                        <span>{w}</span>
                                                                    </li>
                                                                ))}
                                                            </ul>
                                                        </div>
                                                    )}
                                                </div>
                                                
                                                {/* Risk Assessment & Recommendations */}
                                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    {/* Risk Assessment */}
                                                    {risks.length > 0 && (
                                                        <div className="bg-red-50 rounded-lg p-4 border-l-4 border-red-500">
                                                            <h4 className="font-bold text-red-700 mb-2 flex items-center gap-2">
                                                                <span>üö®</span> {t('riskAssessment')}
                                                            </h4>
                                                            <ul className="space-y-2 text-sm text-red-800">
                                                                {risks.map((r, i) => (
                                                                    <li key={i} className={`flex items-start gap-2 p-2 rounded ${
                                                                        r.level === 'critical' ? 'bg-red-100 font-bold' : 
                                                                        r.level === 'high' ? 'bg-red-50' : 'bg-yellow-50'
                                                                    }`}>
                                                                        <span>{r.level === 'critical' ? 'üî¥' : r.level === 'high' ? 'üü†' : 'üü°'}</span>
                                                                        <span>{r.text}</span>
                                                                    </li>
                                                                ))}
                                                            </ul>
                                                        </div>
                                                    )}
                                                    
                                                    {/* Strategic Recommendations */}
                                                    {recommendations.length > 0 && (
                                                        <div className="bg-blue-50 rounded-lg p-4 border-l-4 border-blue-500">
                                                            <h4 className="font-bold text-blue-700 mb-2 flex items-center gap-2">
                                                                <span>üí°</span> {t('strategicRecommendations')}
                                                            </h4>
                                                            <ul className="space-y-2 text-sm text-blue-800">
                                                                {recommendations.map((r, i) => (
                                                                    <li key={i} className="flex items-start gap-2">
                                                                        <span>‚Üí</span>
                                                                        <span>{r}</span>
                                                                    </li>
                                                                ))}
                                                            </ul>
                                                        </div>
                                                    )}
                                                </div>
                                                
                                                {/* Financial Metrics Grid */}
                                                <div className="bg-slate-50 rounded-lg p-4 border border-slate-200">
                                                    <h4 className="font-bold text-slate-700 mb-3">{t('financialDeepDive')}</h4>
                                                    <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                                                        <div className="p-2 border rounded bg-white">
                                                            <div className="text-xs text-slate-500 mb-1">DSCR</div>
                                                            <div className={`font-bold ${c.dscr >= 1.25 ? 'text-green-600' : 'text-orange-600'}`}>{(c.dscr || 0).toFixed(2)}x</div>
                                                        </div>
                                                        <div className="p-2 border rounded bg-white">
                                                            <div className="text-xs text-slate-500 mb-1">D/E Ratio</div>
                                                            <div className={`font-bold ${(d.loan.amount/d.regCapital) <= 2 ? 'text-green-600' : 'text-red-600'}`}>{(d.loan.amount/d.regCapital).toFixed(2)}x</div>
                                                        </div>
                                                        <div className="p-2 border rounded bg-white">
                                                            <div className="text-xs text-slate-500 mb-1">BEP</div>
                                                            <div className={`font-bold ${d.targetBags >= c.bepUnits ? 'text-green-600' : 'text-red-600'}`}>{fmt(c.bepUnits)}</div>
                                                        </div>
                                                        <div className="p-2 border rounded bg-white">
                                                            <div className="text-xs text-slate-500 mb-1">ROE</div>
                                                            <div className="font-bold text-blue-600">{fmtDec(c.roi)}%</div>
                                                        </div>
                                                        <div className="p-2 border rounded bg-white">
                                                            <div className="text-xs text-slate-500 mb-1">Net Margin</div>
                                                            <div className={`font-bold ${c.netMargin > 10 ? 'text-green-600' : 'text-orange-600'}`}>{(c.netMargin || 0).toFixed(1)}%</div>
                                                        </div>
                                                        <div className="p-2 border rounded bg-white">
                                                            <div className="text-xs text-slate-500 mb-1">Cost Structure</div>
                                                            <div className="text-xs font-bold text-slate-700">Fix {((c.revBreakdown.opFixed/c.revBreakdown.opCost)*100).toFixed(0)}% : Var {((c.revBreakdown.opVar/c.revBreakdown.opCost)*100).toFixed(0)}%</div>
                                                        </div>
                                                        <div className="p-2 border rounded bg-white">
                                                            <div className="text-xs text-slate-500 mb-1">Working Cap</div>
                                                            <div className={`font-bold ${c.workingCap > 0 ? 'text-blue-600' : 'text-red-600'}`}>{fmt(c.workingCap)}</div>
                                                        </div>
                                                        <div className="p-2 border rounded bg-white">
                                                            <div className="text-xs text-slate-500 mb-1">Payback</div>
                                                            <div className="font-bold text-slate-700">{c.paybackMonth}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                {/* Marketing & Unit Economics */}
                                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    {/* Marketing Metrics */}
                                                    <div className="bg-indigo-50 rounded-lg p-4 border border-indigo-200">
                                                        <h4 className="font-bold text-indigo-700 mb-3">{t('adsPerformance')}</h4>
                                                        <div className="grid grid-cols-2 gap-3 text-xs">
                                                            <div>
                                                                <div className="text-slate-600">ACOS</div>
                                                                <div className={`font-bold ${c.funnelMetrics.acos < 20 ? 'text-green-600' : 'text-red-600'}`}>{(c.funnelMetrics.acos || 0).toFixed(1)}%</div>
                                                            </div>
                                                            <div>
                                                                <div className="text-slate-600">CPA</div>
                                                                <div className="font-bold text-indigo-700">{fmt(c.funnelMetrics.cpa)}</div>
                                                            </div>
                                                            <div>
                                                                <div className="text-slate-600">Max CPC</div>
                                                                <div className="font-bold text-blue-600">{(c.funnelMetrics.cpc || 0).toFixed(2)}</div>
                                                            </div>
                                                            <div>
                                                                <div className="text-slate-600">CTR / CVR</div>
                                                                <div className="font-bold text-slate-700">{d.mktFunnel.ctr}% / {d.mktFunnel.cvr}%</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    {/* Unit Economics */}
                                                    <div className="bg-indigo-50 rounded-lg p-4 border border-indigo-200">
                                                        <h4 className="font-bold text-indigo-700 mb-3">{t('unitEconomicsAnalysis')}</h4>
                                                        <div className="grid grid-cols-2 gap-3 text-xs">
                                                            <div>
                                                                <div className="text-slate-600">{t('priceExVat')}</div>
                                                                <div className="font-bold text-indigo-700">{fmtDec(c.unitEco?.revUnitExVat || 0)}</div>
                                                            </div>
                                                            <div>
                                                                <div className="text-slate-600">{t('varCostBag')}</div>
                                                                <div className="font-bold text-indigo-700">{fmtDec(c.unitEco?.varCostNoAdsUnitExVat || 0)}</div>
                                                            </div>
                                                            <div>
                                                                <div className="text-slate-600">{t('grossCmBag')}</div>
                                                                <div className={`font-bold ${(c.unitEco?.grossCmUnitExVat || 0) > 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                                    {fmtDec(c.unitEco?.grossCmUnitExVat || 0)}
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <div className="text-slate-600">{t('adsBag')}</div>
                                                                <div className="font-bold text-indigo-700">{fmtDec(c.unitEco?.adsUnitExVat || 0)}</div>
                                                            </div>
                                                            <div>
                                                                <div className="text-slate-600">CAC/Order</div>
                                                                <div className={`font-bold ${(c.unitEco?.cpaExVat || 0) < (c.unitEco?.revUnitExVat || 0) * 0.3 ? 'text-green-600' : 'text-red-600'}`}>
                                                                    {fmtDec(c.unitEco?.cpaExVat || 0)}
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <div className="text-slate-600">LTV/CAC</div>
                                                                <div className={`font-bold ${(c.clvTotal || 0) / (c.unitEco?.cpaExVat || 1) >= 3 ? 'text-green-600' : 'text-orange-600'}`}>
                                                                    {((c.clvTotal || 0) / (c.unitEco?.cpaExVat || 1)).toFixed(1)}x
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </>
                                        );
                                    })()}
                                </div>
                            </div>

                            {/* NEW: Financial Glossary Section */}
                            <div className="card mt-6 border-slate-200 shadow-sm">
                                <div className="card-header bg-slate-100"><div className="card-title text-slate-600 text-sm">{t('financialGlossary')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-xs text-slate-600">
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-indigo-700 mb-1">EBITDA</div>
                                            <div className="text-slate-500 italic mb-1">Earnings Before Interest, Tax, Depreciation</div>
                                            <div className="whitespace-pre-line">{t('gEbitda')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-green-700 mb-1">NPV</div>
                                            <div className="text-slate-500 italic mb-1">Net Present Value</div>
                                            <div className="whitespace-pre-line">{t('gNpv')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-blue-700 mb-1">DSCR</div>
                                            <div className="text-slate-500 italic mb-1">Debt Service Coverage Ratio</div>
                                            <div className="whitespace-pre-line">{t('gDscr')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-orange-700 mb-1">D/E Ratio</div>
                                            <div className="text-slate-500 italic mb-1">Debt to Equity Ratio</div>
                                            <div className="whitespace-pre-line">{t('gDe')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-teal-700 mb-1">{t('roe')}</div>
                                            <div className="text-slate-500 italic mb-1">{t('returnOnEquity')}</div>
                                            <div className="whitespace-pre-line">{t('gRoe')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-pink-700 mb-1">Break-even Point</div>
                                            <div className="text-slate-500 italic mb-1">BEP (Units)</div>
                                            <div className="whitespace-pre-line">{t('gBep')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-teal-700 mb-1">{t('roa')}</div>
                                            <div className="text-slate-500 italic mb-1">{t('returnOnAsset')}</div>
                                            <div className="whitespace-pre-line">{t('gRoa')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-slate-700 mb-1">{t('assetTurnover')}</div>
                                            <div className="text-slate-500 italic mb-1">{t('assetTurnoverDesc')}</div>
                                            <div className="whitespace-pre-line">{t('gAssetTurn')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-blue-600 mb-1">Gross Margin</div>
                                            <div className="text-slate-500 italic mb-1">Gross Profit Margin</div>
                                            <div className="whitespace-pre-line">{t('gGross')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-green-600 mb-1">Net Margin</div>
                                            <div className="text-slate-500 italic mb-1">Net Profit Margin</div>
                                            <div className="whitespace-pre-line">{t('gNet')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-indigo-600 mb-1">Working Capital</div>
                                            <div className="text-slate-500 italic mb-1">Current Assets - Current Liabilities</div>
                                            <div className="whitespace-pre-line">{t('gWc')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-purple-600 mb-1">Tax Shield</div>
                                            <div className="text-slate-500 italic mb-1">Loss Carry Forward</div>
                                            <div className="whitespace-pre-line">{t('gTaxShield')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-slate-700 mb-1">CAPEX</div>
                                            <div className="text-slate-500 italic mb-1">Capital Expenditure</div>
                                            <div className="whitespace-pre-line">{t('gCapex')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-slate-700 mb-1">OPEX</div>
                                            <div className="text-slate-500 italic mb-1">Operating Expenditure</div>
                                            <div className="whitespace-pre-line">{t('gOpex')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-emerald-700 mb-1">Cash Flow</div>
                                            <div className="text-slate-500 italic mb-1">Liquidity</div>
                                            <div className="whitespace-pre-line">{t('gCf')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-red-600 mb-1">Fixed Cost</div>
                                            <div className="text-slate-500 italic mb-1">Fixed Expenses</div>
                                            <div className="whitespace-pre-line">{t('gFix')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-orange-600 mb-1">Variable Cost</div>
                                            <div className="text-slate-500 italic mb-1">Variable Expenses</div>
                                            <div className="whitespace-pre-line">{t('gVar')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-cyan-700 mb-1">Contribution Margin</div>
                                            <div className="text-slate-500 italic mb-1">Gross Margin - Marketing</div>
                                            <div className="whitespace-pre-line">{t('gContributionMargin')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-purple-700 mb-1">Channel Mix</div>
                                            <div className="text-slate-500 italic mb-1">Multi-Channel Revenue Split</div>
                                            <div className="whitespace-pre-line">{t('gChannelMix')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-blue-700 mb-1">Working Capital Cycle</div>
                                            <div className="text-slate-500 italic mb-1">AR/AP/Inventory Days</div>
                                            <div className="whitespace-pre-line">{t('gWorkingCapitalCycle')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-indigo-600 mb-1">AR Days</div>
                                            <div className="text-slate-500 italic mb-1">Accounts Receivable Days</div>
                                            <div className="whitespace-pre-line">{t('gArDays')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-green-600 mb-1">AP Days</div>
                                            <div className="text-slate-500 italic mb-1">Accounts Payable Days</div>
                                            <div className="whitespace-pre-line">{t('gApDays')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-yellow-600 mb-1">Inventory Days</div>
                                            <div className="text-slate-500 italic mb-1">Stock Holding Period</div>
                                            <div className="whitespace-pre-line">{t('gInventoryDays')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-red-700 mb-1">CAPEX Step-up</div>
                                            <div className="text-slate-500 italic mb-1">Scaling Investment</div>
                                            <div className="whitespace-pre-line">{t('gCapexStepUp')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-teal-700 mb-1">Unit Economics</div>
                                            <div className="text-slate-500 italic mb-1">Per-Unit Analysis</div>
                                            <div className="whitespace-pre-line">{t('gUnitEconomics')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-pink-600 mb-1">Input VAT</div>
                                            <div className="text-slate-500 italic mb-1">VAT on Purchases</div>
                                            <div className="whitespace-pre-line">{t('gVatInput')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-red-600 mb-1">Output VAT</div>
                                            <div className="text-slate-500 italic mb-1">VAT on Sales</div>
                                            <div className="whitespace-pre-line">{t('gVatOutput')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-orange-700 mb-1">Net VAT</div>
                                            <div className="text-slate-500 italic mb-1">VAT Settlement</div>
                                            <div className="whitespace-pre-line">{t('gVatNet')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-purple-600 mb-1">Multi-Channel P&L</div>
                                            <div className="text-slate-500 italic mb-1">Channel Breakdown</div>
                                            <div className="whitespace-pre-line">{t('gMultiChannelPl')}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Marketing & Ads Glossary Section */}
                            <div className="card mt-6 border-indigo-200 shadow-sm">
                                <div className="card-header bg-indigo-50"><div className="card-title text-indigo-800 text-sm">{t('marketingGlossary')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-xs text-slate-600">
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-indigo-700 mb-1">ROAS</div>
                                            <div className="text-slate-500 italic mb-1">Return on Ad Spend</div>
                                            <div className="whitespace-pre-line">{t('gRoas')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-pink-700 mb-1">ACOS</div>
                                            <div className="text-slate-500 italic mb-1">Advertising Cost of Sales</div>
                                            <div className="whitespace-pre-line">{t('gAcos')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-blue-700 mb-1">CPA</div>
                                            <div className="text-slate-500 italic mb-1">Cost Per Acquisition / Action</div>
                                            <div className="whitespace-pre-line">{t('gCpa')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-orange-700 mb-1">CPC</div>
                                            <div className="text-slate-500 italic mb-1">Cost Per Click</div>
                                            <div className="whitespace-pre-line">{t('gCpc')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-teal-700 mb-1">CTR</div>
                                            <div className="text-slate-500 italic mb-1">Click-Through Rate</div>
                                            <div className="whitespace-pre-line">{t('gCtr')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-purple-700 mb-1">CVR</div>
                                            <div className="text-slate-500 italic mb-1">Conversion Rate</div>
                                            <div className="whitespace-pre-line">{t('gCvr')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-sky-700 mb-1">CPM</div>
                                            <div className="text-slate-500 italic mb-1">Cost Per Mille (1,000 Impressions)</div>
                                            <div className="whitespace-pre-line">{t('gCpm')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-green-700 mb-1">GMV</div>
                                            <div className="text-slate-500 italic mb-1">Gross Merchandise Value</div>
                                            <div className="whitespace-pre-line">{t('gGmv')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-red-700 mb-1">Impression</div>
                                            <div className="text-slate-500 italic mb-1">Ad Views</div>
                                            <div className="whitespace-pre-line">{t('gImp')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-indigo-600 mb-1">Basket Size / AOV</div>
                                            <div className="text-slate-500 italic mb-1">Average Order Value</div>
                                            <div className="whitespace-pre-line">{t('gAov')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-slate-700 mb-1">Affiliate</div>
                                            <div className="text-slate-500 italic mb-1">Commission Base</div>
                                            <div className="whitespace-pre-line">{t('gAff')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-slate-700 mb-1">Reach</div>
                                            <div className="text-slate-500 italic mb-1">Unique Users</div>
                                            <div className="whitespace-pre-line">{t('gReach')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-green-700 mb-1">LTV</div>
                                            <div className="text-slate-500 italic mb-1">Lifetime Value</div>
                                            <div className="whitespace-pre-line">{t('gLtv')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-red-700 mb-1">CAC</div>
                                            <div className="text-slate-500 italic mb-1">Customer Acquisition Cost</div>
                                            <div className="whitespace-pre-line">{t('gCac')}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>